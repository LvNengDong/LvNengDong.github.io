<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="文件上传 参考：HTTP协议  HTTP 请求头中的 content-type 属性什么是 Content-Type ？HTTP 消息的请求头&#x2F;响应头数据是以键值对&lt;K, V&gt;形式存储的。 Content-Type 就是 HTTP 请求头消息中的一个键值对的 key ，用来描述客户端浏览器向服务器发送的请求时请求数据的数据类型，其对应的 Value 是 MIME 类型的数据。  Tip">
<meta property="og:type" content="article">
<meta property="og:title" content="文件的上传与下载">
<meta property="og:url" content="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="文件上传 参考：HTTP协议  HTTP 请求头中的 content-type 属性什么是 Content-Type ？HTTP 消息的请求头&#x2F;响应头数据是以键值对&lt;K, V&gt;形式存储的。 Content-Type 就是 HTTP 请求头消息中的一个键值对的 key ，用来描述客户端浏览器向服务器发送的请求时请求数据的数据类型，其对应的 Value 是 MIME 类型的数据。  Tip">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/image-20210414233936188.png">
<meta property="og:image" content="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/SpringMVC%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90.png">
<meta property="og:image" content="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/03-%E5%8E%9F%E7%90%86.bmp">
<meta property="og:image" content="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/SpringMVC%E8%B7%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.png">
<meta property="og:image" content="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/image-20210414233855135.png">
<meta property="article:published_time" content="2021-04-13T14:08:33.000Z">
<meta property="article:modified_time" content="2021-04-15T15:52:00.963Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/image-20210414233936188.png">


<link rel="canonical" href="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/","path":"2021/04/13/文件的上传与下载/","title":"文件的上传与下载"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>文件的上传与下载 | Hexo</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Hexo</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">1.</span> <span class="nav-text">文件上传</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP-%E8%AF%B7%E6%B1%82%E5%A4%B4%E4%B8%AD%E7%9A%84-content-type-%E5%B1%9E%E6%80%A7"><span class="nav-number">2.</span> <span class="nav-text">HTTP 请求头中的 content-type 属性</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Content-Type-%EF%BC%9F"><span class="nav-number">2.1.</span> <span class="nav-text">什么是 Content-Type ？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Content-Type-%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="nav-number">2.2.</span> <span class="nav-text">Content-Type 的格式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Content-Type%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E5%AA%92%E4%BD%93%E6%A0%BC%E5%BC%8F%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.3.</span> <span class="nav-text">Content-Type中常见的媒体格式类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5-text-%E5%BC%80%E5%A4%B4%E7%9A%84%E5%AA%92%E4%BD%93%E6%A0%BC%E5%BC%8F%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.3.1.</span> <span class="nav-text">以 text 开头的媒体格式类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5-image-%E5%BC%80%E5%A4%B4%E7%9A%84%E5%AA%92%E4%BD%93%E6%A0%BC%E5%BC%8F%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.3.2.</span> <span class="nav-text">以 image 开头的媒体格式类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A5application%E5%BC%80%E5%A4%B4%E7%9A%84%E5%AA%92%E4%BD%93%E6%A0%BC%E5%BC%8F%E7%B1%BB%E5%9E%8B"><span class="nav-number">2.3.3.</span> <span class="nav-text">以application开头的媒体格式类型</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="nav-number">3.</span> <span class="nav-text">文件上传前置知识</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8HTTP%E5%8D%8F%E8%AE%AE%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E6%97%B6%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.1.</span> <span class="nav-text">使用HTTP协议上传文件时数据传输的类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E5%BF%85%E8%A6%81%E5%89%8D%E6%8F%90%EF%BC%88%E5%89%8D%E7%AB%AF%EF%BC%89"><span class="nav-number">3.2.</span> <span class="nav-text">文件上传的必要前提（前端）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTML-lt-form-gt-%E6%A0%87%E7%AD%BE%E7%9A%84-enctype-%E5%B1%9E%E6%80%A7"><span class="nav-number">3.3.</span> <span class="nav-text">HTML &lt;form&gt; 标签的 enctype 属性</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90"><span class="nav-number">4.</span> <span class="nav-text">文件上传的原理分析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8E%9F%E7%94%9F-Servlet-%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">5.</span> <span class="nav-text">原生 Servlet 实现文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA-Maven-%E5%B7%A5%E7%A8%8B%E5%B9%B6%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="nav-number">5.1.</span> <span class="nav-text">1、创建 Maven 工程并导入依赖</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84-jsp-%E9%A1%B5%E9%9D%A2"><span class="nav-number">5.2.</span> <span class="nav-text">2、编写一个文件上传的 jsp 页面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E7%BC%96%E5%86%99%E6%8E%A7%E5%88%B6%E5%99%A8Controller"><span class="nav-number">5.3.</span> <span class="nav-text">3、编写控制器Controller</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%88%90%E5%8A%9F%E9%A1%B5%E9%9D%A2"><span class="nav-number">5.4.</span> <span class="nav-text">4、跳转到成功页面</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringMVC-%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">6.</span> <span class="nav-text">SpringMVC 实现文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81SpringMVC%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90"><span class="nav-number">6.1.</span> <span class="nav-text">1、SpringMVC文件上传原理分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4"><span class="nav-number">6.2.</span> <span class="nav-text">2、实现步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96-Maven-%E5%B7%A5%E7%A8%8B%E5%B9%B6%E5%AF%BC%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="nav-number">6.2.1.</span> <span class="nav-text">1、初始化 Maven 工程并导入依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E5%99%A8-SpringMVC-xml"><span class="nav-number">6.2.2.</span> <span class="nav-text">2、配置文件解析器[SpringMVC.xml]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84jsp%E9%A1%B5%E9%9D%A2"><span class="nav-number">6.2.3.</span> <span class="nav-text">2、编写一个文件上传的jsp页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%E3%80%81%E7%BC%96%E5%86%99%E6%8E%A7%E5%88%B6%E5%99%A8Controller-1"><span class="nav-number">6.2.4.</span> <span class="nav-text">3、编写控制器Controller</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%E3%80%81%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%88%90%E5%8A%9F%E9%A1%B5%E9%9D%A2-1"><span class="nav-number">6.2.5.</span> <span class="nav-text">4、跳转到成功页面</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SpringMVC-%E5%AE%9E%E7%8E%B0%E8%B7%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">7.</span> <span class="nav-text">SpringMVC 实现跨服务器文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%88%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E7%9B%AE%E7%9A%84"><span class="nav-number">7.1.</span> <span class="nav-text">1、分服务器的目的</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%AE%9E%E7%8E%B0%E6%AD%A5%E9%AA%A4-1"><span class="nav-number">7.2.</span> <span class="nav-text">2、实现步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81%E5%87%86%E5%A4%872%E4%B8%AAMaven%E5%B7%A5%E7%A8%8B"><span class="nav-number">7.2.1.</span> <span class="nav-text">1、准备2个Maven工程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%9A%84jsp%E9%A1%B5%E9%9D%A2-1"><span class="nav-number">7.2.2.</span> <span class="nav-text">2、编写一个文件上传的jsp页面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%E3%80%81%E7%BC%96%E5%86%99%E6%8E%A7%E5%88%B6%E5%99%A8Controller-2"><span class="nav-number">7.2.3.</span> <span class="nav-text">3、编写控制器Controller</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%E3%80%81%E8%B7%B3%E8%BD%AC%E5%88%B0%E6%88%90%E5%8A%9F%E9%A1%B5%E9%9D%A2-2"><span class="nav-number">7.2.4.</span> <span class="nav-text">4、跳转到成功页面</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%97%B6%E5%8F%91%E9%80%81%E7%9A%84HTTP%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%86%85%E5%AE%B9"><span class="nav-number">8.</span> <span class="nav-text">文件上传时发送的HTTP协议的内容</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">232</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">65</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="文件的上传与下载 | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          文件的上传与下载
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-04-13 22:08:33" itemprop="dateCreated datePublished" datetime="2021-04-13T22:08:33+08:00">2021-04-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-04-15 23:52:00" itemprop="dateModified" datetime="2021-04-15T23:52:00+08:00">2021-04-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">开发日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><blockquote>
<p>参考：<a target="_blank" rel="noopener" href="https://lvnengdong.github.io/2020/11/03/HTTP%E5%8D%8F%E8%AE%AE/">HTTP协议</a></p>
</blockquote>
<h1 id="HTTP-请求头中的-content-type-属性"><a href="#HTTP-请求头中的-content-type-属性" class="headerlink" title="HTTP 请求头中的 content-type 属性"></a>HTTP 请求头中的 content-type 属性</h1><h2 id="什么是-Content-Type-？"><a href="#什么是-Content-Type-？" class="headerlink" title="什么是 Content-Type ？"></a>什么是 Content-Type ？</h2><p>HTTP 消息的请求头/响应头数据是以键值对<code>&lt;K, V&gt;</code>形式存储的。 <strong>Content-Type</strong> 就是 HTTP 请求头消息中的一个键值对的 key ，用来描述客户端浏览器向服务器发送的请求时请求数据的数据类型，其对应的 Value 是 MIME 类型的数据。</p>
<blockquote>
<p><strong>Tip：</strong></p>
<p>HTTP 协议不仅是一个数据传输的工具，还能改变数据在网络中传输的类型。</p>
<p>具体想要数据以什么样的类型在网络中传输传递则是由前端人员提前规定好的。！！！</p>
</blockquote>
<h2 id="Content-Type-的格式"><a href="#Content-Type-的格式" class="headerlink" title="Content-Type 的格式"></a>Content-Type 的格式</h2><blockquote>
<p>Content-Type 中 Value 的格式：</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type: subtype[;parameter:type]</span><br><span class="line">-- 主类型: 子类型[;参数: 参数类型]</span><br></pre></td></tr></table></figure>

<ul>
<li>Content-Type 对应的 Value 值的数据类型与 MIME 类似。但是在 Content-Type 中还可以额外添加一些参数。常见的有设置请求消息的编码方式，如<code>charset:utf-8</code>。</li>
</ul>
<blockquote>
<p>Demo</p>
</blockquote>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html;charset:utf-8;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>描述</p>
</blockquote>
<p><code>Content-Type</code> 键对应的值 Value 语法的格式，可分为三个部分，分别是：1、主类型（type）    2、子类型（subtype）    3、参数（parameter）[可选]</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1、主类型（type）</span><br><span class="line">-- 主类型与MIME类型一致，比如 text。如果是 * 号则代表所有类型。</span><br><span class="line"></span><br><span class="line">2、子类型（subtype）</span><br><span class="line">-- 子类型也与MIME类型一致，比如html。如果是 * 号则代表所有类型。</span><br><span class="line"></span><br><span class="line">3、参数（parameter）</span><br><span class="line">-- 参数是可选的，可以在 Content-Type 的 Value 中加入一些特殊的参数，比如 Accept 请求头的参数，常见的有用于设置字符编码的 charset 参数。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>props</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Content-Type：&quot;表示发送的数据类型（MIME类型）&quot;</span><br><span class="line">   -- 常见的属性： </span><br><span class="line">    	application/x-www-form-urlencoded</span><br><span class="line">			# 表示以键值对的格式发送请求数据（数据封装在请求体中）。如：name1=value1&amp;name2=value2，然后对其进行url编码</span><br><span class="line">	    	# url编码是把非英文的内容转换为：%xx%xxx 的格式</span><br><span class="line">	    multipart/form-data</span><br><span class="line">			# 表示以多段的形式提交数据给服务器（以流的形式提交，用于上传）</span><br></pre></td></tr></table></figure>





<h2 id="Content-Type中常见的媒体格式类型"><a href="#Content-Type中常见的媒体格式类型" class="headerlink" title="Content-Type中常见的媒体格式类型"></a>Content-Type中常见的媒体格式类型</h2><blockquote>
<p>参考 MIME 类型：</p>
</blockquote>
<h3 id="以-text-开头的媒体格式类型"><a href="#以-text-开头的媒体格式类型" class="headerlink" title="以 text 开头的媒体格式类型"></a>以 text 开头的媒体格式类型</h3><table>
<thead>
<tr>
<th align="center">文件</th>
<th align="center">文件后缀名</th>
<th align="center">MIME类型</th>
</tr>
</thead>
<tbody><tr>
<td align="center">超文本标记语言</td>
<td align="center">.html 或 .htm</td>
<td align="center">text/html</td>
</tr>
<tr>
<td align="center">普通文本</td>
<td align="center">.txt</td>
<td align="center">text/plain</td>
</tr>
<tr>
<td align="center">XML文本</td>
<td align="center">.xml</td>
<td align="center">text/xml</td>
</tr>
</tbody></table>
<h3 id="以-image-开头的媒体格式类型"><a href="#以-image-开头的媒体格式类型" class="headerlink" title="以 image 开头的媒体格式类型"></a>以 image 开头的媒体格式类型</h3><table>
<thead>
<tr>
<th align="center">文件</th>
<th align="center">文件后缀名</th>
<th align="center">MIME类型</th>
</tr>
</thead>
<tbody><tr>
<td align="center">GIF图片格式</td>
<td align="center">.gif</td>
<td align="center">image/img</td>
</tr>
<tr>
<td align="center">JPEG图片格式</td>
<td align="center">.jpeg 或 .jpg</td>
<td align="center">image/jpeg</td>
</tr>
<tr>
<td align="center">png图片格式</td>
<td align="center">.png</td>
<td align="center">image/png</td>
</tr>
</tbody></table>
<h3 id="以application开头的媒体格式类型"><a href="#以application开头的媒体格式类型" class="headerlink" title="以application开头的媒体格式类型"></a>以application开头的媒体格式类型</h3><table>
<thead>
<tr>
<th align="left">文件</th>
<th align="left">MIME类型</th>
</tr>
</thead>
<tbody><tr>
<td align="left">XHTML格式</td>
<td align="left">application/xhtml+xml</td>
</tr>
<tr>
<td align="left">XML数据格式</td>
<td align="left">application/xml</td>
</tr>
<tr>
<td align="left">Atom XML聚合格式</td>
<td align="left">application/atom+xml</td>
</tr>
<tr>
<td align="left">JSON数据格式</td>
<td align="left">application/json</td>
</tr>
<tr>
<td align="left">pdf格式</td>
<td align="left">application/pdf</td>
</tr>
<tr>
<td align="left">Word文档格式</td>
<td align="left">application/msword</td>
</tr>
<tr>
<td align="left">二进制流数据（如常见的文件下载）</td>
<td align="left">application/octet-stream</td>
</tr>
</tbody></table>
<hr>
<h1 id="文件上传前置知识"><a href="#文件上传前置知识" class="headerlink" title="文件上传前置知识"></a>文件上传前置知识</h1><h2 id="使用HTTP协议上传文件时数据传输的类型"><a href="#使用HTTP协议上传文件时数据传输的类型" class="headerlink" title="使用HTTP协议上传文件时数据传输的类型"></a>使用HTTP协议上传文件时数据传输的类型</h2><blockquote>
<p><strong><code>Content-Type: multipart/form-data</code> ： 使用HTTP协议进行文件传输时数据的格式</strong></p>
<p><em>表示将客户端提交的数据，以<strong>多段</strong>的形式进行拼接，然后以二进制流的形式发送给服务器。</em></p>
<ul>
<li><strong>多段</strong>：一次可上传多条数据，每条数据之间以分隔符分开。每条属性都是二进制的字符流。</li>
</ul>
</blockquote>
<p>在通过HTTP协议（一般是浏览器）上传文件（如图片）时，显然简单的<code>&lt;K, V&gt;</code>值是不能描述图片对象的，所以我们在上传文件的同时要指定<code>Content-Type: multipart/form-data</code>属性值，这样 HTTP 协议在接收到这两个条件后，就会将客户端的上传的图片文件转化成（多段）二进制字节流数据，封装到请求体中，最后将这个HTTP请求中包含的所有信息交给到服务器处理。</p>
<p><img src="/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/image-20210414233936188.png" alt="image-20210414233936188"></p>
<h2 id="文件上传的必要前提（前端）"><a href="#文件上传的必要前提（前端）" class="headerlink" title="文件上传的必要前提（前端）"></a>文件上传的必要前提（前端）</h2><blockquote>
<ol>
<li>设置表单属性：<code>&lt;from enctype = &quot;multipart/form-data&quot;&gt;</code></li>
</ol>
</blockquote>
<ul>
<li>如果想要 HTTP 协议能够将表单中的数据转化成多段二进制流数据的话，在上传文件的同时我们就要声明上传的文件在HTTP中的数据类型是<code>Content-Type: multipart/form-data</code>，在前端中的做法就是设置表单属性为：<code>&lt;from enctype = &quot;multipart/form-data&quot;&gt;</code></li>
<li>在前端的表单中，<code>&lt;form encType=&quot;&quot;&gt;</code> 中默认的 encType 是 <strong>application/x-www-form-urlencoded</strong>，这表示 <code>&lt;form/&gt;</code> 表单中的数据将被HTTP协议编码为 <code>&lt;K, V&gt;</code> 格式发送到服务器。而如果我们想通过表单进行文件上传的话，需要修改表单的属性为：<code>&lt;from encType=multipart/form-data&gt;</code></li>
<li>不管我们通过前端页面还是通过 Postman 等工具进行文件上传时都必须设置请求头中 <code>Content-Type</code> 的值为 <strong>multipart/form-data</strong> 。</li>
</ul>
<blockquote>
<ol start="2">
<li>请求方式必须是<strong>POST</strong></li>
</ol>
</blockquote>
<p>原因：GET 请求有长度的限制，使用 GET 请求上传图片的话往往会超出请求URL 的长度限制，导致上传图片不能正常显示！！！</p>
<blockquote>
<ol start="3">
<li>提供一个文件选择域<code>&lt;input type=&quot;file&quot;/&gt;</code></li>
</ol>
</blockquote>
<h2 id="HTML-lt-form-gt-标签的-enctype-属性"><a href="#HTML-lt-form-gt-标签的-enctype-属性" class="headerlink" title="HTML &lt;form&gt; 标签的 enctype 属性"></a>HTML <code>&lt;form&gt;</code> 标签的 enctype 属性</h2><blockquote>
<p>说明：</p>
</blockquote>
<p>enctype 属性规定在发送到服务器之前HTTP协议应该如何对<code>&lt;form&gt;</code>表单中的数据进行编码。</p>
<p>默认地，表单数据会编码为 “application/x-www-form-urlencoded”。也就是说，在发送到服务器之前，所有字符都会进行 url 编码（空格转换为 “+” 加号，特殊符号转换为 ASCII HEX 值）。</p>
<blockquote>
<p>语法：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">enctype</span>=<span class="string">&quot;value&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>属性值：</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">值</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">application/x-www-form-urlencoded</td>
<td align="left">在发送前编码所有字符（默认）</td>
</tr>
<tr>
<td align="left">multipart/form-data</td>
<td align="left">不对字符编码。在使用包含文件上传控件的表单时，必须使用该值。</td>
</tr>
<tr>
<td align="left">text/plain</td>
<td align="left">空格转换为 “+” 加号，但不对特殊字符编码。</td>
</tr>
</tbody></table>
<hr>
<h1 id="文件上传的原理分析"><a href="#文件上传的原理分析" class="headerlink" title="文件上传的原理分析"></a>文件上传的原理分析</h1><blockquote>
<p>当<code>&lt;form enctype=&quot;application/x-www-form-urlencoded/&gt;</code> 时（即使用默认值），form表单的正文内容是键值对的形式，如：key=value&amp;key=value&amp;……</p>
</blockquote>
<blockquote>
<ul>
<li>当 <code>&lt;form enctype=&quot;multipart/form-data&quot;/&gt;</code> 时（不使用默认值），请求正文内容如下，这时 <strong>request.getParameter()</strong> 方法就会失效。</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 每一部分都是MIME类型描述的正文</span></span><br><span class="line"></span><br><span class="line">-----------------------------7de1a433602ac 				<span class="comment">// 分界符</span></span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;userName&quot;</span> 		<span class="comment">// 协议头</span></span><br><span class="line">aaa	 												<span class="comment">// 协议的正文 </span></span><br><span class="line">-----------------------------7de1a433602ac </span><br><span class="line">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;C:\Users\zhy\Desktop\fileupload_demofile\b.txt&quot;</span> </span><br><span class="line">Content-Type: text/plain 							  <span class="comment">// 协议的类型（MIME类型） ;</span></span><br><span class="line">bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb </span><br><span class="line">-----------------------------7de1a433602ac--</span><br></pre></td></tr></table></figure>







<hr>
<h1 id="原生-Servlet-实现文件上传"><a href="#原生-Servlet-实现文件上传" class="headerlink" title="原生 Servlet 实现文件上传"></a>原生 Servlet 实现文件上传</h1><h2 id="1、创建-Maven-工程并导入依赖"><a href="#1、创建-Maven-工程并导入依赖" class="headerlink" title="1、创建 Maven 工程并导入依赖"></a>1、创建 Maven 工程并导入依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文件上传相关的jar包依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="2、编写一个文件上传的-jsp-页面"><a href="#2、编写一个文件上传的-jsp-页面" class="headerlink" title="2、编写一个文件上传的 jsp 页面"></a>2、编写一个文件上传的 jsp 页面</h2><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3&gt;文件上传&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">    &lt;form method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span> action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/user/fileUpload&quot;</span>&gt;</span><br><span class="line">        选择文件&lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;upload&quot;</span>&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;上传文件&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>



<h2 id="3、编写控制器Controller"><a href="#3、编写控制器Controller" class="headerlink" title="3、编写控制器Controller"></a>3、编写控制器Controller</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理文件上传的业务逻辑</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 跳转到成功页面</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping(value = &quot;fileUpload&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testFileUpload</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.设置文件上传后保存的目录</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> request.getSession().getServletContext().getRealPath(<span class="string">&quot;uploads&quot;</span>);</span><br><span class="line">    <span class="comment">// 判断该路径是否存在，如果不存在，则创建该文件夹</span></span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(path);</span><br><span class="line">    <span class="keyword">if</span> (!file.exists())&#123;</span><br><span class="line">        file.mkdirs();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.解析Request请求，获取上传的文件</span></span><br><span class="line">    <span class="type">DiskFileItemFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DiskFileItemFactory</span>();</span><br><span class="line">    <span class="comment">// 创建一个上传工具，指定使用缓存区与临时文件存储位置.</span></span><br><span class="line">    <span class="type">ServletFileUpload</span> <span class="variable">upload</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServletFileUpload</span>(factory);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解析Request请求</span></span><br><span class="line">    <span class="comment">// 解析上传文件的multipart/form-data流，返回按照传输顺序解析出的FileItem实例列表</span></span><br><span class="line">    List&lt;FileItem&gt; items = upload.parseRequest(request);</span><br><span class="line">    <span class="keyword">for</span> (FileItem item : items) &#123;</span><br><span class="line">        <span class="comment">// 判断当前item对象是否是待上传的文件项</span></span><br><span class="line">        <span class="keyword">if</span> (item.isFormField())&#123;</span><br><span class="line">            <span class="comment">// 说明是普通表单项</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 说明是上传文件项</span></span><br><span class="line">            <span class="comment">// 设置文件名称</span></span><br><span class="line">            <span class="comment">// 获取上传的文件名称</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> item.getName();</span><br><span class="line">            <span class="comment">// 将文件名设置为唯一值</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">            filename = uuid+<span class="string">&quot;-&quot;</span>+filename;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 完成文件上传</span></span><br><span class="line">            item.write(<span class="keyword">new</span> <span class="title class_">File</span>(path,filename));</span><br><span class="line">            <span class="comment">// 删除临时文件</span></span><br><span class="line">            item.delete();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;文件上传成功&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4、跳转到成功页面"><a href="#4、跳转到成功页面" class="headerlink" title="4、跳转到成功页面"></a>4、跳转到成功页面</h2><hr>
<h1 id="SpringMVC-实现文件上传"><a href="#SpringMVC-实现文件上传" class="headerlink" title="SpringMVC 实现文件上传"></a>SpringMVC 实现文件上传</h1><ul>
<li>SpringMVC 的传统方式上传，指的是我们上传的文件和访问的应用在同一台服务器上。</li>
<li>并且上传完成之后，浏览器可以跳转。</li>
</ul>
<h2 id="1、SpringMVC文件上传原理分析"><a href="#1、SpringMVC文件上传原理分析" class="headerlink" title="1、SpringMVC文件上传原理分析"></a>1、SpringMVC文件上传原理分析</h2><p><img src="/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/SpringMVC%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90.png"></p>
<ol>
<li><p>SpringMVC 框架文件上传的优势就在于可以手动配置一个<strong>文件解析器</strong>，这个文件解析器可以自动帮助我们把文件项从Request 请求中把文件项分离出来。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 即在文件上传中，Request请求中包含的数据也不仅仅是文件本身，还有其它很多附带的数据。</span><br><span class="line">2. 在 JavaWeb 文件上传的案例中，我们必须从 Request 请求中将待上传的文件项手动分离出来，这非常麻烦。</span><br><span class="line">3. 而 SpringMVC 只需要配置一个`文件解析器`，就可以让框架自动完成对文件项的提取。对于开发人员来说，只需要直接处	理文件项即可。</span><br></pre></td></tr></table></figure></li>
</ol>
<p><img src="/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/03-%E5%8E%9F%E7%90%86.bmp"></p>
<h2 id="2、实现步骤"><a href="#2、实现步骤" class="headerlink" title="2、实现步骤"></a>2、实现步骤</h2><h3 id="1、初始化-Maven-工程并导入依赖"><a href="#1、初始化-Maven-工程并导入依赖" class="headerlink" title="1、初始化 Maven 工程并导入依赖"></a>1、初始化 Maven 工程并导入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文件上传相关的jar包依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="2、配置文件解析器-SpringMVC-xml"><a href="#2、配置文件解析器-SpringMVC-xml" class="headerlink" title="2、配置文件解析器[SpringMVC.xml]"></a>2、配置文件解析器[<code>SpringMVC.xml</code>]</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置文件上传解析器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span>      <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--设置上传文件的最大尺寸为5MB--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxUploadSize&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>5242880<span class="tag">&lt;/<span class="name">value</span>&gt;</span>  <span class="comment">&lt;!--1024*1024*5--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>注意：<strong>文件上传解析器中的<code>id</code>属性是固定的</strong>，不能起别的名称，否则无法实现请求参数的绑定。</li>
</ul>
<h3 id="2、编写一个文件上传的jsp页面"><a href="#2、编写一个文件上传的jsp页面" class="headerlink" title="2、编写一个文件上传的jsp页面"></a>2、编写一个文件上传的jsp页面</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span></span><br><span class="line">      action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/user/fileUpload2&quot;</span>&gt;</span><br><span class="line">    选择文件&lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;img3&quot;</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;上传文件&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：</p>
<ul>
<li>选择文件<code>&lt;input type=type=&quot;file&quot; name=&quot;img3&quot;&gt;</code>中的<code>name</code>属性的值必须和<code>Controller控制器</code>中具体方法中的参数<code>MultipartFile img3</code> 的名称一致，否则就会接收不到数据。</li>
</ul>
</blockquote>
<h3 id="3、编写控制器Controller-1"><a href="#3、编写控制器Controller-1" class="headerlink" title="3、编写控制器Controller"></a>3、编写控制器Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(path = &quot;fileUpload2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testFileUpload2</span><span class="params">(MultipartFile img3, HttpServletRequest request)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">// 1.设置文件上传后的保存位置</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">filepath</span> <span class="operator">=</span> request.getSession().getServletContext().getRealPath(<span class="string">&quot;/uploads/&quot;</span>);</span><br><span class="line">    <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filepath);</span><br><span class="line">    <span class="keyword">if</span> (!file.exists())&#123;</span><br><span class="line">        file.mkdirs();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2.设置文件上传后的文件名</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> img3.getOriginalFilename();</span><br><span class="line">    filename = filename+uuid;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.上传文件</span></span><br><span class="line">    img3.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(filepath, filename));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4、跳转到成功页面-1"><a href="#4、跳转到成功页面-1" class="headerlink" title="4、跳转到成功页面"></a>4、跳转到成功页面</h3><h1 id="SpringMVC-实现跨服务器文件上传"><a href="#SpringMVC-实现跨服务器文件上传" class="headerlink" title="SpringMVC 实现跨服务器文件上传"></a>SpringMVC 实现跨服务器文件上传</h1><h2 id="1、分服务器的目的"><a href="#1、分服务器的目的" class="headerlink" title="1、分服务器的目的"></a>1、分服务器的目的</h2><ol>
<li>在实际开发中，我们会有很多处理不同功能的服务器。如：<ul>
<li>应用服务器：负责部署我们的应用</li>
<li>数据库服务器：运行我们的数据库</li>
<li>缓存和消息队列服务器：负责处理大并发访问的缓存和消息</li>
<li>文件服务器：负责存储用户上传文件的服务器</li>
</ul>
</li>
<li>分服务器处理的目的是为了让服务器各司其职，从而提高我们项目的运行效率。</li>
</ol>
<p><img src="/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/SpringMVC%E8%B7%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.png"></p>
<h2 id="2、实现步骤-1"><a href="#2、实现步骤-1" class="headerlink" title="2、实现步骤"></a>2、实现步骤</h2><h3 id="1、准备2个Maven工程"><a href="#1、准备2个Maven工程" class="headerlink" title="1、准备2个Maven工程"></a>1、准备2个Maven工程</h3><ol>
<li><p>创建2个Maven工程</p>
<ul>
<li>准备2个TomCat服务器，并且创建一个用于存放图片的web工程</li>
</ul>
</li>
<li><p>导入依赖的坐标</p>
<ul>
<li>跨服务器文件上传需要额外导入的依赖坐标</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--跨服务器文件上传的依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.jersey<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jersey-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.jersey<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jersey-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="2、编写一个文件上传的jsp页面-1"><a href="#2、编写一个文件上传的jsp页面-1" class="headerlink" title="2、编写一个文件上传的jsp页面"></a>2、编写一个文件上传的jsp页面</h3><h3 id="3、编写控制器Controller-2"><a href="#3、编写控制器Controller-2" class="headerlink" title="3、编写控制器Controller"></a>3、编写控制器Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 跨服务器文件上传</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequestMapping(path = &quot;fileUpload3&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">testFileUpload3</span><span class="params">(MultipartFile img3)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">// 1.设置文件上传后保存的路径</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">filepath</span> <span class="operator">=</span> <span class="string">&quot;http://localhost:9090/uploads/&quot;</span>;</span><br><span class="line">    <span class="comment">// 2.设置文件上传后的文件名</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID().toString().replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> img3.getOriginalFilename();</span><br><span class="line">    filename = filename+uuid;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3.跨服务器上传文件</span></span><br><span class="line">    <span class="comment">// 3.1 创建客户端对象[jersey提供的]</span></span><br><span class="line">    <span class="type">Client</span> <span class="variable">client</span> <span class="operator">=</span> Client.create();</span><br><span class="line">    <span class="comment">// 3.2 和图片服务器建立连接</span></span><br><span class="line">    <span class="type">WebResource</span> <span class="variable">resource</span> <span class="operator">=</span> client.resource(filepath+filename);</span><br><span class="line">    <span class="comment">// 3.3 上传文件</span></span><br><span class="line">    resource.put(img3.getBytes());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4、跳转到成功页面-2"><a href="#4、跳转到成功页面-2" class="headerlink" title="4、跳转到成功页面"></a>4、跳转到成功页面</h3><hr>
<p><strong>Spring MVC中关于Content-Type类型信息的使用</strong></p>
<p>在Spring MVC中，主要就是使用@RequestMapping注解来处理请求，因此首先我们来看看@RequestMapping注解的Class定义。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.TYPE&#125;)</span> </span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Mapping</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RequestMapping &#123;</span><br><span class="line">    String[] value() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    RequestMethod[] method() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    String[] params() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    String[] headers() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    String[] consumes() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">    String[] produces() <span class="keyword">default</span> &#123;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>下面对注解提供的参数进行简单解析。</p>
<p>value：指定请求的 URL</p>
<p>method： 指定请求的method类型， 比如GET、POST、PUT、DELETE等。</p>
<p><strong>consumes：指定处理请求的提交内容类型（Content-Type），例如application/json、text/html;等。</strong></p>
<p>produces：指定返回的内容类型，仅当request请求头中的(Accept)类型中包含该指定类型才返回。</p>
<p>params：指定request中必须包含某些参数值，才让该方法处理。</p>
<p>headers：指定request中必须包含某些指定的header值，才能让该方法处理请求。</p>
<p>其中，consumes、produces可以使用Content-type中的信息对不需要的信息进行过滤，仅接受需要的数据；headers则可以使用Content-Type中的信息对请求进行过滤和判断。</p>
<p><strong>Request Headers和Response Headers中的候选属性</strong></p>
<p>这里列举出 Request Headers（请求头）和Response Headers（响应头）中的候选属性。</p>
<p>Request Headers的候选属性</p>
<table>
<thead>
<tr>
<th>候选属性</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>Accept</td>
<td>指定客户端能够接收的内容类型</td>
<td>Accept: text/plain, text/html</td>
</tr>
<tr>
<td>Accept-Charset</td>
<td>浏览器可以接受的字符编码集</td>
<td>Accept-Charset: iso-8859-5</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>指定浏览器可以支持的web服务器返回内容压缩编码类型</td>
<td>Accept-Encoding: compress, gzip</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>浏览器可接受的语言</td>
<td>Accept-Language: en,zh</td>
</tr>
<tr>
<td>Accept-Ranges</td>
<td>可以请求网页实体的一个或者多个子范围字段</td>
<td>Accept-Ranges: bytes</td>
</tr>
<tr>
<td>Authorization</td>
<td>HTTP授权的授权证书</td>
<td>Authorization: Basic QWxhZLRpbjpvcGVuIHNoc2FtZQ==</td>
</tr>
<tr>
<td>Cache-Control</td>
<td>指定请求和响应遵循的缓存机制</td>
<td>Cache-Control: no-cache</td>
</tr>
<tr>
<td>Connection</td>
<td>表示是否需要持久连接。（HTTP 1.1默认进行持久连接）</td>
<td>Connection: close</td>
</tr>
<tr>
<td>Cookie</td>
<td>HTTP请求发送时，会把保存在该请求域名下的所有cookie值一起发送给web服务器</td>
<td>Cookie: $Version=1; Skin=new;</td>
</tr>
<tr>
<td>Content-Length</td>
<td>请求的内容长度</td>
<td>Content-Length: 348</td>
</tr>
<tr>
<td>Content-Type</td>
<td>请求的与实体对应的MIME信息</td>
<td>Content-Type: application/x-www-form-urlencoded</td>
</tr>
<tr>
<td>Date</td>
<td>请求发送的日期和时间</td>
<td>Date: Tue, 15 Nov 2018 08:22:31 GMT</td>
</tr>
<tr>
<td>Expect</td>
<td>请求的特定的服务器行为</td>
<td>Expect: 100-continue</td>
</tr>
<tr>
<td>From</td>
<td>发出请求的用户的Email</td>
<td>From: <a href="mailto:&#117;&#115;&#x65;&#x72;&#x40;&#x65;&#109;&#97;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#109;">&#117;&#115;&#x65;&#x72;&#x40;&#x65;&#109;&#97;&#x69;&#x6c;&#x2e;&#x63;&#x6f;&#109;</a></td>
</tr>
<tr>
<td>Host</td>
<td>指定请求的服务器的域名和端口号</td>
<td>Host: <a target="_blank" rel="noopener" href="http://www.yanggb.com/">www.yanggb.com</a></td>
</tr>
<tr>
<td>If-Match</td>
<td>只有请求内容与实体相匹配才有效</td>
<td>If-Match: “737060ff8c284d8af7ad2082f209582d”</td>
</tr>
<tr>
<td>If-Modified-Since</td>
<td>如果请求的部分在指定时间之后被修改则请求成功，未被修改则返回304代码</td>
<td>If-Modified-Since: Sat, 29 Oct 2018 19:43:31 GMT</td>
</tr>
<tr>
<td>If-None-Match</td>
<td>如果内容未改变返回304代码，参数为服务器先前发送的Etag，与服务器回应的Etag比较判断是否改变</td>
<td>If-None-Match: “737060cd8c284d8af7ad3082f209582d”</td>
</tr>
<tr>
<td>If-Range</td>
<td>如果实体未改变，服务器发送客户端丢失的部分，否则发送整个实体。参数也为Etag</td>
<td>If-Range: “737060cd8c284d8af7ad3082f209582d”</td>
</tr>
<tr>
<td>If-Unmodified-Since</td>
<td>只在实体在指定时间之后未被修改才请求成功</td>
<td>If-Unmodified-Since: Sat, 29 Oct 2018 19:23:11 GMT</td>
</tr>
<tr>
<td>Max-Forwards</td>
<td>限制信息通过代理和网关传送的时间</td>
<td>Max-Forwards: 10</td>
</tr>
<tr>
<td>Pragma</td>
<td>用来包含实现特定的指令</td>
<td>Pragma: no-cache</td>
</tr>
<tr>
<td>Proxy-Authorization</td>
<td>连接到代理的授权证书</td>
<td>Proxy-Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</td>
</tr>
<tr>
<td>Range</td>
<td>只请求实体的一部分，指定范围</td>
<td>Range: bytes=500-999</td>
</tr>
<tr>
<td>Referer</td>
<td>先前网页的地址，当前请求网页紧随其后，即来路</td>
<td>Referer: <a target="_blank" rel="noopener" href="http://www.yanggb.com/yanggb1.html">http://www.yanggb.com/yanggb1.html</a></td>
</tr>
<tr>
<td>TE</td>
<td>客户端愿意接受的传输编码，并通知服务器接受接受尾加头信息</td>
<td>TE: trailers,deflate;q=0.5</td>
</tr>
<tr>
<td>Upgrade</td>
<td>向服务器指定某种传输协议以便服务器进行转换（如果支持）</td>
<td>Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11</td>
</tr>
<tr>
<td>User-Agent</td>
<td>User-Agent的内容包含发出请求的用户信息</td>
<td>User-Agent: Mozilla/5.0 (Linux; X11)</td>
</tr>
<tr>
<td>Via</td>
<td>通知中间网关或代理服务器地址，通信协议</td>
<td>Via: 1.0 fred, 1.1 nowhere.com (Apache/1.1)</td>
</tr>
<tr>
<td>Warning</td>
<td>关于消息实体的警告信息</td>
<td>Warn: 199 Miscellaneous warning</td>
</tr>
</tbody></table>
<p>可以看到，Content-Type是Request Headers中的一个候选属性。</p>
<p>Response Headers的候选属性</p>
<table>
<thead>
<tr>
<th>候选属性</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>Accept-Ranges</td>
<td>表明服务器是否支持指定范围请求及哪种类型的分段请求</td>
<td>Accept-Ranges: bytes</td>
</tr>
<tr>
<td>Age</td>
<td>从原始服务器到代理缓存形成的估算时间（以秒计，非负）</td>
<td>Age: 12</td>
</tr>
<tr>
<td>Allow</td>
<td>对某网络资源的有效的请求行为，不允许则返回405</td>
<td>Allow: GET, HEAD</td>
</tr>
<tr>
<td>Cache-Control</td>
<td>告诉所有的缓存机制是否可以缓存及哪种类型</td>
<td>Cache-Control: no-cache</td>
</tr>
<tr>
<td>Content-Encoding</td>
<td>web服务器支持的返回内容压缩编码类型</td>
<td>Content-Encoding: gzip</td>
</tr>
<tr>
<td>Content-Language</td>
<td>响应体的语言</td>
<td>Content-Language: en,zh</td>
</tr>
<tr>
<td>Content-Length</td>
<td>响应体的长度</td>
<td>Content-Length: 348</td>
</tr>
<tr>
<td>Content-Location</td>
<td>请求资源可替代的备用的另一地址</td>
<td>Content-Location: /index.htm</td>
</tr>
<tr>
<td>Content-MD5</td>
<td>返回资源的MD5校验值</td>
<td>Content-MD5: Q2hlY2sgSW50ZWdyaXR5IQ==</td>
</tr>
<tr>
<td>Content-Range</td>
<td>在整个返回体中本部分的字节位置</td>
<td>Content-Range: bytes 21010-47021/47022</td>
</tr>
<tr>
<td>Content-Type</td>
<td>返回内容的MIME类型</td>
<td>Content-Type: text/html; charset=utf-8</td>
</tr>
<tr>
<td>Date</td>
<td>原始服务器消息发出的时间</td>
<td>Date: Tue, 15 Nov 2018 08:22:22 GMT</td>
</tr>
<tr>
<td>ETag</td>
<td>请求变量的实体标签的当前值</td>
<td>ETag: “737060cd8c284d8af7ad3082f209582d”</td>
</tr>
<tr>
<td>Expires</td>
<td>响应过期的日期和时间</td>
<td>Expires: Thu, 01 Dec 2018 16:00:00 GMT</td>
</tr>
<tr>
<td>Last-Modified</td>
<td>请求资源的最后修改时间</td>
<td>Last-Modified: Tue, 15 Nov 2018 12:25:26 GMT</td>
</tr>
<tr>
<td>Location</td>
<td>用来重定向接收方到非请求URL的位置来完成请求或标识新的资源</td>
<td>Location: <a target="_blank" rel="noopener" href="http://www.yanggb.com/yanggb2.html">http://www.yanggb.com/yanggb2.html</a></td>
</tr>
<tr>
<td>Pragma</td>
<td>包括实现特定的指令，它可应用到响应链上的任何接收方</td>
<td>Pragma: no-cache</td>
</tr>
<tr>
<td>Proxy-Authenticate</td>
<td>它指出认证方案和可应用到代理的该URL上的参数</td>
<td>Proxy-Authenticate: Basic</td>
</tr>
<tr>
<td>refresh</td>
<td>应用于重定向或一个新的资源被创造，在5秒之后重定向（由网景提出，被大部分浏览器支持）</td>
<td>Refresh: 5; url=<a target="_blank" rel="noopener" href="http://www.yanggb.com/yanggb9.html">http://www.yanggb.com/yanggb9.html</a></td>
</tr>
<tr>
<td>Retry-After</td>
<td>如果实体暂时不可取，通知客户端在指定时间之后再次尝试</td>
<td>Retry-After: 120</td>
</tr>
<tr>
<td>Server</td>
<td>web服务器软件名称</td>
<td>Server: Apache/1.3.27 (Unix) (Red-Hat/Linux)</td>
</tr>
<tr>
<td>Set-Cookie</td>
<td>设置Http Cookie</td>
<td>Set-Cookie: UserID=JohnDoe; Max-Age=3600; Version=1</td>
</tr>
<tr>
<td>Trailer</td>
<td>指出头域在分块传输编码的尾部存在</td>
<td>Trailer: Max-Forwards</td>
</tr>
<tr>
<td>Transfer-Encoding</td>
<td>文件传输编码</td>
<td>Transfer-Encoding:chunked</td>
</tr>
<tr>
<td>Vary</td>
<td>告诉下游代理是使用缓存响应还是从原始服务器请求</td>
<td>Vary: *</td>
</tr>
<tr>
<td>Via</td>
<td>告知代理客户端响应是通过哪里发送的</td>
<td>Via: 1.0 fred, 1.1 nowhere.com (Apache/1.1)</td>
</tr>
<tr>
<td>Warning</td>
<td>警告实体可能存在的问题</td>
<td>Warning: 199 Miscellaneous warning</td>
</tr>
<tr>
<td>WWW-Authenticate</td>
<td>表明客户端请求实体应该使用的授权方案</td>
<td>WWW-Authenticate: Basic</td>
</tr>
</tbody></table>
<p><strong>具体使用示例</strong></p>
<p>这里通过几个具体的实例来了解怎么在Spring MVC中使用两个Headers中的信息。</p>
<p>示例1：headers属性取Request Headers中的Referer属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value = &quot;/yanggb2&quot;, method = RequestMethod.GET, headers=&quot;Referer=http://www.yanggb.com/yanggb1&quot;)</span><br><span class="line">public void yanggb2() &#123;   </span><br><span class="line">    // 如果上一个页面的地址不是上面headers属性中Referer指定的地址，不会执行此方法</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>这里的headers里面可以匹配所有Headers里面可以出现的信息，不局限于Referer信息。</p>
<p>示例2：headers属性取Request Headers中的Accept属性。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value = &quot;/yanggb2&quot;, headers = &quot;Accept=application/json&quot;) </span><br><span class="line">public void yanggb3(HttpServletResponse response) throws IOException &#123; </span><br><span class="line">    // 表示响应的内容区数据的媒体类型为json格式，且编码为utf-8（客户端应该以utf-8解码）</span><br><span class="line">    response.setContentType(&quot;application/json;charset=utf-8&quot;); </span><br><span class="line">    // 写出响应体内容</span><br><span class="line">    String jsonData = &quot;&#123;\&quot;username\&quot;:\&quot;yanggb\&quot;,\&quot;password\&quot;:\&quot;123\&quot;&#125;&quot;; </span><br><span class="line">    response.getWriter().write(jsonData);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>这样，服务器就会根据请求头【Accept=application/json】生产json数据。</p>
<p>当你有如下Accept头，将遵守如下规则进行应用：</p>
<p>①Accept：text/html,application/xml,application/json</p>
<p>将按照如下顺序进行produces的匹配 ①text/html ②application/xml ③application/json。</p>
<p>②Accept：application/xml;q=0.5,application/json;q=0.9,text/html。</p>
<p>将按照如下顺序进行produces的匹配 ①text/html ②application/json ③application/xml。</p>
<p>参数为媒体类型的质量因子，越大则优先权越高(从0到1)。</p>
<p>③Accept：*/<em>,text/</em>,text/html</p>
<p>将按照如下顺序进行produces的匹配 ①text/html ②text/* ③*/*。</p>
<p>即匹配规则为：最明确的优先匹配。</p>
<p>示例3：params属性取参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@RequestMapping(value = &quot;/yanggb/&#123;userId&#125;&quot;, method = RequestMethod.GET, params = &quot;yanggb1=yanggb2&quot;) </span><br><span class="line">public void findUser(@PathVariable String userId) &#123;</span><br><span class="line">    // 当请求中包含参数yanggb1时才会执行此方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在上面的代码中，就起到了一个过滤的作用。</p>
<p>实例4：consumes/produces属性过滤请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@Controller </span><br><span class="line">@RequestMapping(value = &quot;/users&quot;, method = RequestMethod.POST, consumes=&quot;application/json&quot;, produces = &quot;application/json&quot;) </span><br><span class="line">@ResponseBody</span><br><span class="line">public List&lt;User&gt; addUser(@RequestBody User userl) &#123;   </span><br><span class="line">    return List&lt;User&gt; users;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>上面这个方法仅处理请求Content-Type为【application/json】类型的请求，produces标识处理请求中Accept头中包含了【application/json】的请求，同时暗示了返回的内容类型为【application/json】。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;title&gt;测试文件上传&lt;/title&gt;</span><br><span class="line">    &lt;div id=&quot;app&quot;&gt;</span><br><span class="line">        &lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">            用户名：&lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;&lt;br&gt;</span><br><span class="line">            头像：&lt;input type=&quot;file&quot; name=&quot;photo&quot;&gt;&lt;br&gt;</span><br><span class="line">            &lt;input type=submit value=&quot;上传&quot; @click=&quot;upload&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &lt;button  @click=&quot;upload&quot;&gt;点我&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;./node_modules/axios/dist/axios.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=&quot;./node_modules/vue/dist/vue.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    const vm = new Vue(&#123;</span><br><span class="line">        el: &quot;#app&quot;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            upload()&#123;</span><br><span class="line">                alert(&quot;哈哈&quot;)</span><br><span class="line">                axios.post(&quot;localhost:8080/user/2&quot;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="文件上传时发送的HTTP协议的内容"><a href="#文件上传时发送的HTTP协议的内容" class="headerlink" title="文件上传时发送的HTTP协议的内容"></a>文件上传时发送的HTTP协议的内容</h1><p><img src="/2021/04/13/%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8E%E4%B8%8B%E8%BD%BD/image-20210414233855135.png" alt="image-20210414233855135"></p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/04/11/Vue%E8%B7%AF%E7%94%B1/" rel="prev" title="Vue路由">
                  <i class="fa fa-chevron-left"></i> Vue路由
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/04/15/SpringMVC%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E5%A4%84%E7%90%86HTTP%E8%AF%B7%E6%B1%82%E7%9A%84%E6%96%B9%E6%B3%95/" rel="next" title="SpringMVC中常见的处理HTTP请求的方法">
                  SpringMVC中常见的处理HTTP请求的方法 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
