<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/20/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/20/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/20/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hexo</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">235</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">69</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/12/07/VO%E3%80%81DTO%E3%80%81DO%E3%80%81PO%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E8%81%94%E7%B3%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/12/07/VO%E3%80%81DTO%E3%80%81DO%E3%80%81PO%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E8%81%94%E7%B3%BB/" class="post-title-link" itemprop="url">VO、DTO、DO、PO的区别与联系</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-12-07 21:52:18" itemprop="dateCreated datePublished" datetime="2020-12-07T21:52:18+08:00">2020-12-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-04-11 23:28:41" itemprop="dateModified" datetime="2021-04-11T23:28:41+08:00">2021-04-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">开发日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="应用分层"><a href="#应用分层" class="headerlink" title="应用分层"></a>应用分层</h1><p>推荐分层结构如下图所示，默认上层依赖于下层，箭头关系表示<strong>可</strong>直接依赖。如：开放API层可以依赖于Web层（Controller层），也可以直接依赖于Service层。</p>
<p><img src="/2020/12/07/VO%E3%80%81DTO%E3%80%81DO%E3%80%81PO%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E8%81%94%E7%B3%BB/%E3%80%8AJava%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C%EF%BC%88%E5%B5%A9%E5%B1%B1%E7%89%88%EF%BC%89%E3%80%8B.jpg"></p>
<blockquote>
<p>开放API层</p>
</blockquote>
<ul>
<li>可通过Web层封装成HTTP接口；</li>
<li>可直接封装Service层接口暴露成RPC接口；</li>
</ul>
<blockquote>
<p>终端显示层</p>
</blockquote>
<ul>
<li>各个端的模板渲染并执行显示的层。如JS渲染，JSP渲染，移动端展示等。</li>
</ul>
<blockquote>
<p>Web层</p>
</blockquote>
<ul>
<li>主要是对访问控制进行转发，各类基本参数校验，或者不复用的业务简单处理等。</li>
</ul>
<blockquote>
<p>Service层</p>
</blockquote>
<ul>
<li>相对具体的业务逻辑服务层</li>
</ul>
<blockquote>
<p>Manager层</p>
</blockquote>
<ul>
<li>通用业务层，它有如下特征：<ol>
<li>是对Service层通用能力的下沉，如缓存方案、中间件通用处理等；</li>
<li>与Dao层交互，对多个Dao的组合复用；</li>
<li>是对第三方平台封装的层。</li>
</ol>
</li>
</ul>
<blockquote>
<p>Dao层</p>
</blockquote>
<ul>
<li>数据访问层，与底层MySql、Hbase、OB等进行数据交互。</li>
</ul>
<blockquote>
<p>第三方服务</p>
</blockquote>
<ul>
<li>包括其他部门的RPC服务接口，其他公司的HTTP接口等。如淘宝开放平台、支付宝付款等。</li>
</ul>
<blockquote>
<p>外部数据接口</p>
</blockquote>
<ul>
<li>外部应用数据存储服务提供的接口，多用于数据迁移场景中。</li>
</ul>
<hr>
<h1 id="分层领域的模型规约"><a href="#分层领域的模型规约" class="headerlink" title="分层领域的模型规约"></a>分层领域的模型规约</h1><ul>
<li><strong>DO</strong>（Data Object）：此对象与数据库表结构一一对应，通过Dao层向上传输数据源对象。</li>
<li><strong>DTO</strong>（Data Transfer Object）：数据传输对象，Service层或Manager层向外传输的对象。</li>
<li><strong>BO</strong>（Business Object）：业务对象，可以由Service层输出的封装业务逻辑的对象。</li>
<li><strong>VO</strong>（View Object）：显示层对象，通常是Web层向模板渲染引擎层传输的对象。</li>
<li><strong>Query</strong>：数据查询对象，各层接收上层的查询请求。注意超过2个参数的查询封装，禁止使用Map类来传输。</li>
</ul>
<h2 id="VO-与-DTO-的区别"><a href="#VO-与-DTO-的区别" class="headerlink" title="VO 与 DTO 的区别"></a>VO 与 DTO 的区别</h2><blockquote>
<p>既然DTO是Service/Manager层向上层（Web层/开放API层）传递的数据对象，为什么还需要一个VO呢？</p>
</blockquote>
<p>对于绝大部分的应用场景来说，DTO和VO的属性值基本上是一致的，而且他们统称都是POJO，因此没有必要多此一举，但不要忘记这是实现层的思维，对于设计层面来说，概念上还是应该存在VO和DTO，因为两者有着本质上的区别，<strong>DTO是Service层与其直接上层（Web层和开放API层）进行数据交互的对象，而VO是Web层与其直接上层（终端显示层和开放API层）进行数据交互的对象</strong>。</p>
<blockquote>
<p>例1：</p>
</blockquote>
<p>Service层有一个<code>getUser()</code>方法返回一个用户，其中有一个属性是<code>gender</code>，对于服务层来说，只是从语义上定义：1-男性、2-女性、3-未指定，而对于Web层而言，他可能需要用“帅哥”代表男性，“美女”代表女性，“秘密”代表未指定。当然，也可以直接在service返回“帅哥美女”就可实现这一功能。对于大部分的应用来说，这是可以的，但是如果需求客户可以定制化风格，而不同风格对于“性别”的表现方式不一样，又或者这个服务同时供多个客户端使用，而不同的客户端对于表现层的要求有所不同，那么问题就来了。再者，回到设计层面上分析，<strong>从职责单一原则来看，服务层只负责业务，与业务的表现形式无关，因此，它返回的DTO，不应该表现出与表现形式的耦合。</strong></p>
<h3 id="VO与DTO的应用"><a href="#VO与DTO的应用" class="headerlink" title="VO与DTO的应用"></a>VO与DTO的应用</h3><p>上面只是用了一个简单的例子来说明VO与DTO在概念上的区别，接下来我将会告诉你如何在应用中做出正确的选择。</p>
<blockquote>
<p>在以下场景中，我们可以考虑把VO与DTO二合为一（注意：是实现层面）：</p>
</blockquote>
<ul>
<li>当需求非常清晰稳定，而且客户端很明确只有一个的时候，没有必要把VO和DTO区分开来，这时候VO可以退隐，只使用DTO即可。</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/30/Thymeleaf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/30/Thymeleaf/" class="post-title-link" itemprop="url">Thymeleaf</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-11-30 11:27:05 / Modified: 11:29:30" itemprop="dateCreated datePublished" datetime="2020-11-30T11:27:05+08:00">2020-11-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="1-Thymeleaf简介"><a href="#1-Thymeleaf简介" class="headerlink" title="1.Thymeleaf简介"></a>1.Thymeleaf简介</h1><p>官网：<a target="_blank" rel="noopener" href="https://www.thymeleaf.org/index.html">https://www.thymeleaf.org/index.html</a></p>
<p><strong>Thymeleaf</strong>是用来开发Web和独立环境项目的现代服务器端Java模板引擎。</p>
<p>Thymeleaf的主要目标是为您的开发工作流程带来优雅的<em>自然模板</em> - HTML。可以在直接浏览器中正确显示，并且可以作为静态原型，从而在开发团队中实现更强大的协作。</p>
<p>借助Spring Framework的模块，可以根据自己的喜好进行自由选择，可插拔功能组件，Thymeleaf是现代HTML5 JVM Web开发的理想选择 - 尽管它可以做的更多。</p>
<p>Spring官方支持的服务的渲染模板中，并不包含jsp。而是Thymeleaf和Freemarker等，而Thymeleaf与SpringMVC的视图技术，及SpringBoot的自动化配置集成非常完美，几乎没有任何成本，你只用关注Thymeleaf的语法即可。</p>
<h1 id="2-特点"><a href="#2-特点" class="headerlink" title="2.特点"></a>2.特点</h1><p>特点：</p>
<ul>
<li>动静结合：Thymeleaf 在有网络和无网络的环境下皆可运行，即它可以让美工在浏览器查看页面的静态效果，也可以让程序员在服务器查看带数据的动态页面效果。这是由于它支持 html 原型，然后在 html 标签里增加额外的属性来达到模板+数据的展示方式。浏览器解释 html 时会忽略未定义的标签属性，所以 thymeleaf 的模板可以静态地运行；当有数据返回到页面时，Thymeleaf 标签会动态地替换掉静态内容，使页面动态显示。</li>
<li>开箱即用：它提供标准和spring标准两种方言，可以直接套用模板实现JSTL、 OGNL表达式效果，避免每天套模板、改jstl、改标签的困扰。同时开发人员也可以扩展和创建自定义的方言。</li>
<li>多方言支持：Thymeleaf 提供spring标准方言和一个与 SpringMVC 完美集成的可选模块，可以快速的实现表单绑定、属性编辑器、国际化等功能。</li>
<li>与SpringBoot完美整合，SpringBoot提供了Thymeleaf的默认配置，并且为Thymeleaf设置了视图解析器，我们可以像以前操作jsp一样来操作Thymeleaf。代码几乎没有任何区别，就是在模板语法上有区别。</li>
</ul>
<h1 id="3-环境准备"><a href="#3-环境准备" class="headerlink" title="3.环境准备"></a>3.环境准备</h1><p>我们来创建一个module，为学习Thymeleaf做准备：</p>
<h2 id="3-1-创建module"><a href="#3-1-创建module" class="headerlink" title="3.1.创建module"></a>3.1.创建module</h2><p>使用脚手架创建一个SpringBoot工程，勾选web和Thymeleaf的依赖：</p>
<p><img src="/2020/11/30/Thymeleaf/1526435317440.png" alt="1526435317440"></p>
<p>项目结构：</p>
<p><img src="/2020/11/30/Thymeleaf/image-20201129222142265.png" alt="image-20201129222142265"></p>
<h2 id="3-2-默认配置"><a href="#3-2-默认配置" class="headerlink" title="3.2.默认配置"></a>3.2.默认配置</h2><p>不需要做任何配置，启动器已经帮我们把Thymeleaf的视图器配置完成：</p>
<p> <img src="/2020/11/30/Thymeleaf/1526435647041.png" alt="1526435647041"></p>
<p>而且，还配置了模板文件（html）的位置，与jsp类似的前缀+ 视图名 + 后缀风格：</p>
<p> <img src="/2020/11/30/Thymeleaf/1526435706301.png" alt="1526435706301"></p>
<ul>
<li>默认前缀：<code>classpath:/templates/</code></li>
<li>默认后缀：<code>.html</code></li>
</ul>
<p>所以如果我们返回视图：<code>users</code>，会指向到 <code>classpath:/templates/users.html</code></p>
<p>Thymeleaf默认会开启页面缓存，提高页面并发能力。但会导致我们修改页面不会立即被展现，因此我们一般会关闭缓存：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭Thymeleaf的缓存</span></span><br><span class="line"><span class="attr">spring.thymeleaf.cache</span>=<span class="string">false</span></span><br></pre></td></tr></table></figure>

<p>另外，修改完毕页面，需要使用快捷键：<code>Ctrl + Shift + F9</code>来刷新工程。</p>
<h2 id="3-3-快速开始"><a href="#3-3-快速开始" class="headerlink" title="3.3.快速开始"></a>3.3.快速开始</h2><p>我们准备一个controller，控制视图跳转：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;show1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">show1</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;Hello, Thymeleaf!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>新建一个html模板：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span> <span class="attr">xmlns:th</span>=<span class="string">&quot;http://www.thymeleaf.org&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>hello<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;msg&#125;&quot;</span>&gt;</span>大家好<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong>，把html 的名称空间，改成：<code>xmlns:th=&quot;http://www.thymeleaf.org&quot;</code> 会有语法提示</p>
<p>启动项目，访问页面：</p>
<p> <img src="/2020/11/30/Thymeleaf/1526436248528.png" alt="1526436248528"></p>
<h1 id="4-语法"><a href="#4-语法" class="headerlink" title="4.语法"></a>4.语法</h1><p>Thymeleaf的主要作用是把model中的数据渲染到html中，因此其语法主要是如何解析model中的数据。从以下方面来学习：</p>
<ul>
<li>变量</li>
<li>方法</li>
<li>条件判断</li>
<li>循环</li>
<li>运算<ul>
<li>逻辑运算</li>
<li>布尔运算</li>
<li>比较运算</li>
<li>条件运算</li>
</ul>
</li>
<li>其它</li>
</ul>
<h2 id="4-1-变量"><a href="#4-1-变量" class="headerlink" title="4.1.变量"></a>4.1.变量</h2><h3 id="变量案例"><a href="#变量案例" class="headerlink" title="变量案例"></a>变量案例</h3><p>我们先新建一个实体类：User</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    User friend;<span class="comment">// 对象类型属性</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后在模型中添加数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;show2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show2</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">    user.setAge(<span class="number">21</span>);</span><br><span class="line">    user.setName(<span class="string">&quot;Jack Chen&quot;</span>);</span><br><span class="line">    user.setFriend(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;李小龙&quot;</span>, <span class="number">30</span>));</span><br><span class="line"></span><br><span class="line">    model.addAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;show2&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>语法说明：</p>
</blockquote>
<p>Thymeleaf通过<code>$&#123;&#125;</code>来获取model中的变量，注意这不是el表达式，而是ognl表达式，但是语法非常像。</p>
<blockquote>
<p>示例：</p>
</blockquote>
<p>我们在页面获取user数据：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">    欢迎您：<span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.name&#125;&quot;</span>&gt;</span>请登录<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果：</p>
<p> <img src="/2020/11/30/Thymeleaf/1526438010948.png" alt="1526438010948"></p>
<p>感觉跟el表达式几乎是一样的。不过区别在于，我们的表达式写在一个名为：<code>th:text</code>的标签属性中，这个叫做<code>指令</code></p>
<h3 id="动静结合"><a href="#动静结合" class="headerlink" title="动静结合"></a>动静结合</h3><blockquote>
<p>指令：</p>
</blockquote>
<p>Thymeleaf崇尚<code>自然模板</code>，意思就是模板是纯正的html代码，脱离模板引擎，在纯静态环境也可以直接运行。现在如果我们直接在html中编写 <code>$&#123;&#125;</code>这样的表达式，显然在静态环境下就会出错，这不符合Thymeleaf的理念。</p>
<p>Thymeleaf中所有的表达式都需要写在<code>指令</code>中，指令是HTML5中的自定义属性，在<strong>Thymeleaf中所有指令都是以<code>th:</code>开头</strong>。因为表达式<code>$&#123;user.name&#125;</code>是写在自定义属性中，因此在静态环境下，表达式的内容会被当做是普通字符串，浏览器会自动忽略这些指令，这样就不会报错了！</p>
<p>现在，我们不经过SpringMVC，而是直接用浏览器打开页面看看：</p>
<p> <img src="/2020/11/30/Thymeleaf/1526438337869.png" alt="1526438337869"></p>
<ul>
<li>静态页面中，<code>th</code>指令不被识别，但是浏览器也不会报错，把它当做一个普通属性处理。这样<code>span</code>的默认值<code>请登录</code>就会展现在页面</li>
<li>如果是在Thymeleaf环境下，<code>th</code>指令就会被识别和解析，而<code>th:text</code>的含义就是替<strong>换所在标签中的文本内容</strong>，于是<code>user.name</code>的值就替代了 <code>span</code>中默认的请登录</li>
</ul>
<p>指令的设计，正是Thymeleaf的高明之处，也是它优于其它模板引擎的原因。动静结合的设计，使得无论是前端开发人员还是后端开发人员可以完美契合。</p>
<blockquote>
<p>向下兼容</p>
</blockquote>
<p>但是要注意，如果浏览器不支持Html5怎么办？</p>
<p>如果不支持这种<code>th:</code>的命名空间写法，那么可以把<code>th:text</code>换成 <code>data-th-text</code>，Thymeleaf也可以兼容。</p>
<blockquote>
<p>escape</p>
</blockquote>
<p>另外，<code>th:text</code>指令出于安全考虑，会把表达式读取到的值进行处理，防止html的注入。</p>
<p>例如，<code>&lt;p&gt;你好&lt;/p&gt;</code>将会被格式化输出为<code>$lt;p$gt;你好$lt;/p$lt;</code>。</p>
<p>如果想要不进行格式化输出，而是要输出原始内容，则使用<code>th:utext</code>来代替.</p>
<h3 id="ognl表达式的语法糖"><a href="#ognl表达式的语法糖" class="headerlink" title="ognl表达式的语法糖"></a>ognl表达式的语法糖</h3><p>刚才获取变量值，我们使用的是经典的<code>对象.属性名</code>方式。但有些情况下，我们的属性名可能本身也是变量，怎么办？</p>
<p>ognl提供了类似js的语法方式：</p>
<p>例如：<code>$&#123;user.name&#125;</code> 可以写作<code>$&#123;user[&#39;name&#39;]&#125;</code></p>
<h2 id="4-2-自定义变量"><a href="#4-2-自定义变量" class="headerlink" title="4.2.自定义变量"></a>4.2.自定义变量</h2><blockquote>
<p>场景</p>
</blockquote>
<p>看下面的案例：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Name: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.name&#125;&quot;</span>&gt;</span>Jack<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Age: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.age&#125;&quot;</span>&gt;</span>21<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>friend: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.friend.name&#125;&quot;</span>&gt;</span>Rose<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们获取用户的所有信息，分别展示。</p>
<p>当数据量比较多的时候，频繁的写<code>user.</code>就会非常麻烦。</p>
<p>因此，Thymeleaf提供了自定义变量来解决：</p>
<blockquote>
<p>示例：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;user&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Name: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;name&#125;&quot;</span>&gt;</span>Jack<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Age: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;age&#125;&quot;</span>&gt;</span>21<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>friend: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;friend.name&#125;&quot;</span>&gt;</span>Rose<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>首先在 <code>h2</code>上 用 <code>th:object=&quot;$&#123;user&#125;&quot;</code>获取user的值，并且保存</li>
<li>然后，在<code>h2</code>内部的任意元素上，可以通过 <code>*&#123;属性名&#125;</code>的方式，来获取user中的属性，这样就省去了大量的<code>user.</code>前缀了</li>
</ul>
<h2 id="4-3-方法"><a href="#4-3-方法" class="headerlink" title="4.3.方法"></a>4.3.方法</h2><blockquote>
<p>ognl表达式中的方法调用</p>
</blockquote>
<p>ognl表达式本身就支持方法调用，例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span> <span class="attr">th:object</span>=<span class="string">&quot;$&#123;user&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>FirstName: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;name.split(&#x27; &#x27;)[0]&#125;&quot;</span>&gt;</span>Jack<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>LastName: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;*&#123;name.split(&#x27; &#x27;)[1]&#125;&quot;</span>&gt;</span>Li<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>这里我们调用了name（是一个字符串）的split方法。</li>
</ul>
<blockquote>
<p>Thymeleaf内置对象</p>
</blockquote>
<p>Thymeleaf中提供了一些<strong>内置对象</strong>，并且在这些对象中提供了一些方法，方便我们来调用。获取这些对象，需要<strong>使用<code>#对象名</code>来引用</strong>。</p>
<ul>
<li>一些环境相关对象</li>
</ul>
<table>
<thead>
<tr>
<th align="center">对象</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>#ctx</code></td>
<td align="left">获取Thymeleaf自己的Context对象</td>
</tr>
<tr>
<td align="center"><code>#requset</code></td>
<td align="left">如果是web程序，可以获取HttpServletRequest对象</td>
</tr>
<tr>
<td align="center"><code>#response</code></td>
<td align="left">如果是web程序，可以获取HttpServletReponse对象</td>
</tr>
<tr>
<td align="center"><code>#session</code></td>
<td align="left">如果是web程序，可以获取HttpSession对象</td>
</tr>
<tr>
<td align="center"><code>#servletContext</code></td>
<td align="left">如果是web程序，可以获取HttpServletContext对象</td>
</tr>
<tr>
<td align="center"></td>
<td align="left"></td>
</tr>
</tbody></table>
<ul>
<li>Thymeleaf提供的全局对象：</li>
</ul>
<table>
<thead>
<tr>
<th align="center">对象</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>#dates</code></td>
<td align="left">处理java.util.date的工具对象</td>
</tr>
<tr>
<td align="center"><code>#calendars</code></td>
<td align="left">处理java.util.calendar的工具对象</td>
</tr>
<tr>
<td align="center"><code>#numbers</code></td>
<td align="left">用来对数字格式化的方法</td>
</tr>
<tr>
<td align="center"><code>#strings</code></td>
<td align="left">用来处理字符串的方法</td>
</tr>
<tr>
<td align="center"><code>#bools</code></td>
<td align="left">用来判断布尔值的方法</td>
</tr>
<tr>
<td align="center"><code>#arrays</code></td>
<td align="left">用来护理数组的方法</td>
</tr>
<tr>
<td align="center"><code>#lists</code></td>
<td align="left">用来处理List集合的方法</td>
</tr>
<tr>
<td align="center"><code>#sets</code></td>
<td align="left">用来处理set集合的方法</td>
</tr>
<tr>
<td align="center"><code>#maps</code></td>
<td align="left">用来处理map集合的方法</td>
</tr>
</tbody></table>
<ul>
<li>举例</li>
</ul>
<p>我们在环境变量中添加日期类型对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;show3&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">show3</span><span class="params">(Model model)</span>&#123;</span><br><span class="line">    model.addAttribute(<span class="string">&quot;today&quot;</span>, <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;show3&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在页面中处理</p>
<ul>
<li><p>直接获取Date对象并展示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  今天是: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;today&#125;&quot;</span>&gt;</span>2020-04-25<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2020/11/30/Thymeleaf/image-20201130104040673.png" alt="image-20201130104040673"></p>
</li>
<li><p>利用全局对象<code>#dates</code>对日期进行格式化后展示</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  今天是: <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;#dates.format(today,&#x27;yyyy-MM-dd&#x27;)&#125;&quot;</span>&gt;</span>2020-04-25<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p> 效果：</p>
<p><img src="/2020/11/30/Thymeleaf/image-20201130104416364.png" alt="image-20201130104416364"></p>
<h2 id="4-4-字面值"><a href="#4-4-字面值" class="headerlink" title="4.4 字面值"></a>4.4 字面值</h2><p>有的时候，我们需要在指令中填写基本类型如：字符串、数值、布尔等，并不希望被Thymeleaf解析为变量，这个时候称为字面值。</p>
<ul>
<li><p>字符串字面值</p>
<p>使用一对单引号<code>&#39;</code>引用的内容就是字符串字面值了。</p>
<p>Tip：双引号是<code>th:text</code>指令必须有的，单引号才表示使用字符串常量的字面值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  你正在观看 <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;&#x27;thymeleaf&#x27;&quot;</span>&gt;</span>template<span class="tag">&lt;/<span class="name">span</span>&gt;</span> 的字符串常量值.</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>th:text</code>中的thymeleaf并不会被认为是变量，而是一个字符串</p>
<p> <img src="/2020/11/30/Thymeleaf/1526958538157.png" alt="1526958538157"></p>
</li>
<li><p>数字字面值</p>
<p>数字不需要任何特殊语法， 写的什么就是什么，而且可以直接进行算术运算</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>今年是 <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;2020&quot;</span>&gt;</span>1900<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>两年后将会是 <span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;2020 + 2&quot;</span>&gt;</span>1902<span class="tag">&lt;/<span class="name">span</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p> <img src="/2020/11/30/Thymeleaf/1526958856078.png" alt="1526958856078"></p>
</li>
<li><p>布尔字面值</p>
<p>布尔类型的字面值是true或false：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    展示</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">th:if</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">  隐藏</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里引用了一个<code>th:if</code>指令，跟vue中的<code>v-if</code>类似。如果<code>th:if=&quot;false&quot;</code>，则标签中的内容不会展示到页面上。</p>
</li>
</ul>
<h2 id="4-5-拼接"><a href="#4-5-拼接" class="headerlink" title="4.5 拼接"></a>4.5 拼接</h2><p>我们经常会用到普通字符串与表达式拼接的情况：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;&#x27;欢迎您:&#x27; + $&#123;user.name&#125; + &#x27;!&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>字符串字面值需要用<code>&#39;&#39;</code>，拼接起来非常麻烦，Thymeleaf对此进行了简化，使用一对<code>|</code>即可：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;|欢迎您:$&#123;user.name&#125;|&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>与上面是完全等效的，这样就省去了字符串字面值的书写。</p>
<p> <img src="/2020/11/30/Thymeleaf/1526959781368.png" alt="1526959781368"></p>
<h2 id="4-6-运算"><a href="#4-6-运算" class="headerlink" title="4.6 运算"></a>4.6 运算</h2><p>需要注意：<code>$&#123;&#125;</code>内部的是通过OGNL表达式引擎解析的，外部的才是通过Thymeleaf的引擎解析，因此运算符尽量放在<code>$&#123;&#125;</code>外进行。</p>
<ul>
<li><p>算术运算</p>
<p>支持的算术运算符：<code>+ - * / %</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.age&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.age&#125;%2 == 0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p> <img src="/2020/11/30/Thymeleaf/1526959990356.png" alt="1526959990356"></p>
</li>
<li><p>比较运算</p>
<p>支持的比较运算：<code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code> and <code>&lt;=</code>  ，但是<code>&gt;</code>, <code>&lt;</code>不能直接使用，因为xml会解析为标签，要使用别名。</p>
<p>注意 <code>==</code> and <code>!=</code>不仅可以比较数值，类似于equals的功能。</p>
<p>可以使用的别名：<code>gt (&gt;), lt (&lt;), ge (&gt;=), le (&lt;=), not (!). Also eq (==), neq/ne (!=).</code></p>
</li>
<li><p>条件运算</p>
<ul>
<li>三元运算</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.sex&#125; ? &#x27;男&#x27;:&#x27;女&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>三元运算符的三个部分：conditon ? then : else</p>
<p>​    condition：条件</p>
<p>​    then：条件成立的结果</p>
<p>​    else：不成立的结果</p>
<p>其中的每一个部分都可以是Thymeleaf中的任意表达式。</p>
<p> <img src="/2020/11/30/Thymeleaf/1526960230778.png" alt="1526960230778"></p>
<ul>
<li><p>默认值</p>
<p>有的时候，我们取一个值可能为空，这个时候需要做非空判断，可以使用 <code>表达式 ?: 默认值</code>简写：</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.name&#125; ?: &#x27;二狗&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当前面的表达式值为null时，就会使用后面的默认值。</p>
<p>注意：<code>?:</code>之间没有空格。</p>
<p> <img src="/2020/11/30/Thymeleaf/1526960384564.png" alt="1526960384564"></p>
</li>
</ul>
<h2 id="4-7-循环"><a href="#4-7-循环" class="headerlink" title="4.7 循环"></a>4.7 循环</h2><p>循环也是非常频繁使用的需求，我们使用<code>th:each</code>指令来完成：</p>
<p>假如有用户的集合：users在Context中。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;user : $&#123;users&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.name&#125;&quot;</span>&gt;</span>Onions<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.age&#125;&quot;</span>&gt;</span>2.41<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>${users} 是要遍历的集合，可以是以下类型：<ul>
<li>Iterable，实现了Iterable接口的类</li>
<li>Enumeration，枚举</li>
<li>Interator，迭代器</li>
<li>Map，遍历得到的是Map.Entry</li>
<li>Array，数组及其它一切符合数组结果的对象</li>
</ul>
</li>
</ul>
<p>在迭代的同时，我们也可以获取迭代的状态对象：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">th:each</span>=<span class="string">&quot;user,stat : $&#123;users&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.name&#125;&quot;</span>&gt;</span>Onions<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">th:text</span>=<span class="string">&quot;$&#123;user.age&#125;&quot;</span>&gt;</span>2.41<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>stat对象包含以下属性：</p>
<ul>
<li>index，从0开始的角标</li>
<li>count，元素的个数，从1开始</li>
<li>size，总元素个数</li>
<li>current，当前遍历到的元素</li>
<li>even/odd，返回是否为奇偶，boolean值</li>
<li>first/last，返回是否为第一或最后，boolean值</li>
</ul>
<h2 id="4-8-逻辑判断"><a href="#4-8-逻辑判断" class="headerlink" title="4.8 逻辑判断"></a>4.8 逻辑判断</h2><p>有了<code>if和else</code>，我们能实现一切功能。</p>
<p>Thymeleaf中使用<code>th:if</code> 或者 <code>th:unless</code> ，两者的意思恰好相反。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">th:if</span>=<span class="string">&quot;$&#123;user.age&#125; &lt; 24&quot;</span>&gt;</span>小鲜肉<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果表达式的值为true，则标签会渲染到页面，否则不进行渲染。</p>
<p>以下情况被认定为true：</p>
<ul>
<li>表达式值为true</li>
<li>表达式值为非0数值</li>
<li>表达式值为非0字符</li>
<li>表达式值为字符串，但不是<code>&quot;false&quot;</code>,<code>&quot;no&quot;</code>,<code>&quot;off&quot;</code></li>
<li>表达式不是布尔、字符串、数字、字符中的任何一种</li>
</ul>
<p>其它情况包括null都被认定为false</p>
<p> <img src="/2020/11/30/Thymeleaf/1526960499522.png" alt="1526960499522"></p>
<h2 id="4-9-分支控制switch"><a href="#4-9-分支控制switch" class="headerlink" title="4.9 分支控制switch"></a>4.9 分支控制switch</h2><p>这里要使用两个指令：<code>th:switch</code> 和 <code>th:case</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">th:switch</span>=<span class="string">&quot;$&#123;user.role&#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">&quot;&#x27;admin&#x27;&quot;</span>&gt;</span>用户是管理员<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">&quot;&#x27;manager&#x27;&quot;</span>&gt;</span>用户是经理<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">th:case</span>=<span class="string">&quot;*&quot;</span>&gt;</span>用户是别的玩意<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>需要注意的是，一旦有一个th:case成立，其它的则不再判断。与java中的switch是一样的。</p>
<p>另外<code>th:case=&quot;*&quot;</code>表示默认，放最后。</p>
<p> <img src="/2020/11/30/Thymeleaf/1526960621714.png" alt="1526960621714"></p>
<p>页面：</p>
<p> <img src="/2020/11/30/Thymeleaf/1526961251878.png" alt="1526961251878"></p>
<h2 id="4-10-JS模板"><a href="#4-10-JS模板" class="headerlink" title="4.10.JS模板"></a>4.10.JS模板</h2><p>模板引擎不仅可以渲染html，也可以对JS中的进行预处理。而且为了在纯静态环境下可以运行，其Thymeleaf代码可以被注释起来：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">th:inline</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> user = <span class="comment">/*[[$&#123;user&#125;]]*/</span> &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> age = <span class="comment">/*[[$&#123;user.age&#125;]]*/</span> <span class="number">20</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(user);</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(age)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>在script标签中通过<code>th:inline=&quot;javascript&quot;</code>来声明这是要特殊处理的js脚本</p>
</li>
<li><p>语法结构：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = <span class="comment">/*[[Thymeleaf表达式]]*/</span> <span class="string">&quot;静态环境下的默认值&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>因为Thymeleaf被注释起来，因此即便是静态环境下， js代码也不会报错，而是采用表达式后面跟着的默认值。</p>
</li>
</ul>
<p>看看页面的源码：</p>
<p><img src="/2020/11/30/Thymeleaf/1526961583904.png" alt="1526961583904"></p>
<p>我们的User对象被直接处理为json格式了，非常方便。</p>
<p>控制台：</p>
<p> <img src="/2020/11/30/Thymeleaf/1526961525185.png" alt="1526961525185"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/26/%E9%80%9A%E7%94%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/26/%E9%80%9A%E7%94%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/" class="post-title-link" itemprop="url">通用异常处理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-26 20:04:03" itemprop="dateCreated datePublished" datetime="2020-11-26T20:04:03+08:00">2020-11-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-11-04 22:20:16" itemprop="dateModified" datetime="2021-11-04T22:20:16+08:00">2021-11-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BC%80%E5%8F%91%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">开发日记</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>在项目中出现异常常用的处理方法是<code>try...catch</code>或<code>throw</code>。但是如果直接将异常信息展示给客户端浏览器显然是不合适的，下面我们将介绍比较规范的异常处理的过程。</p>
<h2 id="场景模拟"><a href="#场景模拟" class="headerlink" title="场景模拟"></a>场景模拟</h2><p>向数据库新增一件商品，需要接收以下参数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">price：商品价格</span><br><span class="line">name：商品名称</span><br></pre></td></tr></table></figure>

<p>新增完成后在回传数据给前端时进行简单的校验，要求是：</p>
<ul>
<li>价格不能为空，为空则数据不合法。</li>
<li>新增成功后，自动生成商品ID，然后随商品对象一起返回。</li>
</ul>
<h2 id="未出现异常的情况"><a href="#未出现异常的情况" class="headerlink" title="未出现异常的情况"></a>未出现异常的情况</h2><ol>
<li><p>初始化一个SpringBoot工程</p>
</li>
<li><p>实体类<code>Item</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.domian;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span>	<span class="comment">// Lombok</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Item</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Long price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Controller层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.web;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/item&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItemController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ItemService itemService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> Item <span class="title function_">saveItem</span><span class="params">(Item item)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> itemService.saveItem(item);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>Service层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.service;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItemService</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * 模拟业务逻辑：新增商品成功后，自动形成商品ID，然后随商品对象一起返回</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">    <span class="keyword">public</span> Item <span class="title function_">saveItem</span><span class="params">(Item item)</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">100</span>);</span><br><span class="line">        item.setId(id);</span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>未出现异常时，前端页面提交新增商品的信息，后端把商品信息存到数据库中，成功后返回<strong>商品信息+商品ID</strong>。</p>
</li>
</ol>
<hr>
<h2 id="出现异常"><a href="#出现异常" class="headerlink" title="出现异常"></a>出现异常</h2><p>因为在程序运行过程中难以避免异常的发生，所以要增加异常处理逻辑。此处在Web层中增加了处理异常的逻辑。</p>
<ol>
<li><p>修改Web层的代码为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.web;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/item&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItemController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ItemService itemService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="comment">// ResponseEntity&lt;T&gt;中的泛型代表响应体</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;Item&gt; <span class="title function_">saveItem</span><span class="params">(Item item)</span>&#123;</span><br><span class="line">        <span class="comment">// 校验价格</span></span><br><span class="line">        <span class="keyword">if</span> (item.getPrice() == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">// Restful风格对于响应消息的格式有严格要求：必须返回 1)状态码 2）响应体。	</span></span><br><span class="line">            <span class="comment">// @ResponseBody 只负责响应体内容，而状态码在响应行中，这时候我们可以使用 ResponseEntity 来充当返回值对象</span></span><br><span class="line">            <span class="comment">// 如果是对象创建失败，且原因是请求参数有问题，应该返回响应状态码400.响应体为NULL</span></span><br><span class="line">            <span class="keyword">return</span> ResponseEntity.status(HttpStatus.BAD_REQUEST).body(<span class="literal">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 对象创建执行成功，返回响应状态码为201，响应体为Item对象</span></span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(HttpStatus.CREATED).body(itemService.saveItem(item));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><p>如果请求参数符合规范，返回的结果为：状态码+Item对象：</p>
<p><img src="/2020/11/26/%E9%80%9A%E7%94%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/image-20201126175637689.png"></p>
</li>
<li><p>如果请求参数不符合规范，返回的结果为：状态码+NULL</p>
<p><img src="/2020/11/26/%E9%80%9A%E7%94%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/image-20201126175512201.png"></p>
<p>显然，只返回响应状态，这样的异常处理对用户而言体验极差。</p>
</li>
<li><p>如果设置响应体中的数据为“价格不能为空”，与返回值<code>ResponseEntity&lt;T&gt;</code>的泛型类型不匹配，直接编译无法通过。</p>
   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> ResponseEntity.status(HttpStatus.BAD_REQUEST).body(<span class="string">&quot;价格不能为空&quot;</span>);    <span class="comment">// error</span></span><br></pre></td></tr></table></figure>

<ul>
<li>如果将<code>ResponseEntity&lt;T&gt;</code>中的泛型类型指定为String类型可以完成该功能，但是这样一来，就不能见名知意了，也不合适。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="通用异常处理"><a href="#通用异常处理" class="headerlink" title="通用异常处理"></a>通用异常处理</h2><ol>
<li><p>既然不能通过<code>ResponseEntity&lt;T&gt;</code>完成想要的功能，我们就可以借助异常处理器。继续修改Web层的代码为：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.web;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/item&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItemController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ItemService itemService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="comment">// ResponseEntity&lt;T&gt;中的泛型代表响应体</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;Item&gt; <span class="title function_">saveItem</span><span class="params">(Item item)</span>&#123;</span><br><span class="line">        <span class="comment">// 校验价格</span></span><br><span class="line">        <span class="keyword">if</span> (item.getPrice() == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">// 抛出异常，异常类RuntimeException中的内容会被封装在响应体中</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;价格不能为空&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 对象创建执行成功，返回响应状态码为201，响应体为Item对象</span></span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(HttpStatus.CREATED).body(itemService.saveItem(item));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>此时，出现异常的响应结果是：</p>
<p><img src="/2020/11/26/%E9%80%9A%E7%94%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/image-20201126180849084.png"></p>
<p>因为我们在出现异常的地方抛出了<code>RuntimeException</code>，那么编译器就会认为是服务器内部出现了问题，返回响应状态码是500，显然这是不合适的。</p>
<p>SpringMVC配置了默认的异常处理器，现在就是默认的异常处理器在帮助我们处理异常。但是，我们想要的结果是：异常不应该由默认的异常处理器来处理，而是由我们自己处理，这就需要定义通用异常处理的逻辑。</p>
</li>
</ul>
</li>
<li><p>首先我们要拦截Web层抛出的所有异常（这是一种AOP的思想，面向切面编程）。但是不用我们自己去写拦截所有异常的方法，SpringMVC提供了 <strong>@ControllerAdvice</strong> 注解默认情况下可以自动拦截所有被<code>@Controller</code>注解修饰的类抛出的异常（即Web层的异常），被<code>@ControllerAdvice</code>修饰的类就是一个通知，可以在运行期增强被拦截到的异常。</p>
</li>
<li><p>拦截到异常之后，我们需要手动去处理异常。创建一个通用异常处理器类（本质上是一个<strong>通知</strong>）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.advice;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonExceptionHandler</span> &#123;</span><br><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该方法的返回值就是返回给浏览器的信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(RuntimeException.class)</span>	<span class="comment">// 该注解的作用是拦截指定类型的异常</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title function_">myExceptionHandler</span><span class="params">(RuntimeException e)</span>&#123;</span><br><span class="line">        <span class="comment">// 拦截所有Web层异常，并在运行期对其进行增强</span></span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(HttpStatus.BAD_REQUEST).body(e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><code>@ControllerAdvice</code>是SpringMVC中的注解，所以项目中事先需要引入SpringMVC的依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.2.6.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>再次访问，得到的结果为：</p>
</li>
</ol>
<p>  <img src="/2020/11/26/%E9%80%9A%E7%94%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/image-20201126183158148.png"></p>
<hr>
<h2 id="继续优化"><a href="#继续优化" class="headerlink" title="继续优化"></a>继续优化</h2><p>存在的问题：</p>
<ol>
<li>通用异常处理器中，状态码被写死了（硬编码）</li>
<li>响应体消息只返回字符串过于简单</li>
</ol>
<p>解决方法：</p>
<ol>
<li><p>响应状态码应该在抛出异常的地方声明。即抛出异常的地方应该声明：1、状态码  2、响应消息message。<code>--&gt;</code> 自定义异常类</p>
<blockquote>
<p>不管是<code>Exception类</code>还是<code>RuntimeException类</code>，其构造方法都不能保存响应状态码，所以我们要想在出现异常的地方声明响应状态码，就必须自定义异常类来实现！！！</p>
</blockquote>
</li>
<li><p>响应消息message直接在抛出异常的地方定义也不合适，因为不同的开发人员定义的异常说明可能不同，所以最好的方法是定义在一个枚举类型中，由开发人员去调用即可。</p>
</li>
</ol>
<ol>
<li><p>自定义异常类：MyException</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.exception;</span><br><span class="line"></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line">    <span class="comment">// 类中的属性</span></span><br><span class="line">    <span class="keyword">private</span> ExceptionEnum exceptionEnum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>定义一个枚举类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.enums;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将响应状态码和响应体消息都封装在枚举中，使用的时候直接调用即可。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Getter</span>     <span class="comment">// 提供get方法</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span>  </span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ExceptionEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    PRICE_CANNOT_BE_NULL(<span class="number">400</span>, <span class="string">&quot;价格不能为空&quot;</span>);</span><br><span class="line">    <span class="comment">// 等价于private static final ExceptionEnum name1  = new ExceptionEnum(400, &quot;价格不能为空&quot;);相当于创建了一个对象</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 类中的属性</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> statusCode;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>修改拦截器</p>
<ul>
<li>拦截自定义异常类</li>
<li>通过自定义异常类中得到枚举中定义的异常信息说明，分别作为响应状态码和响应体返回给浏览器</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.advice;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonExceptionHandler</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该方法的返回值就是返回给浏览器的信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@ExceptionHandler</span>()注解的作用是限定拦截的异常的类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(MyException.class)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title function_">myExceptionHandler</span><span class="params">(MyException e)</span>&#123;</span><br><span class="line">        <span class="type">ExceptionEnum</span> <span class="variable">exceptionEnum</span> <span class="operator">=</span> e.getExceptionEnum();</span><br><span class="line">        <span class="type">int</span> <span class="variable">statusCode</span> <span class="operator">=</span> exceptionEnum.getStatusCode();</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> exceptionEnum.getMessage();</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(statusCode).body(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>修改Web层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.web;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/item&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItemController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ItemService itemService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="comment">// ResponseEntity&lt;T&gt;中的泛型代表响应体</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;Item&gt; <span class="title function_">saveItem</span><span class="params">(Item item)</span>&#123;</span><br><span class="line">        <span class="comment">// 校验价格</span></span><br><span class="line">        <span class="keyword">if</span> (item.getPrice() == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">// 抛出自定义异常，自定义异常中接收枚举类中的信息</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">MyException</span>(ExceptionEnum.PRICE_CANNOT_BE_NULL);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 对象创建执行成功，返回响应状态码为201，响应体为Item对象</span></span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(HttpStatus.CREATED).body(itemService.saveItem(item));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在还存在的问题就是<strong>响应体</strong>过于简单，所以我们可以将响应体封装成一个复杂的对象返回。</p>
</li>
<li><p>定义一个类封装响应体信息，该类接收一个枚举类型，并会将枚举类型中的信息拿过来并加以丰富</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.vo;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 丰富响应体的内容</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExceptionResult</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> status;</span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line">    <span class="keyword">private</span> Long timestamp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建一个构造函数，构造函数中接收来自ExceptionEnum的信息，并将枚举类中的信息初始化给当前类的属性</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ExceptionResult</span><span class="params">(ExceptionEnum em)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.status = em.getStatusCode();</span><br><span class="line">        <span class="built_in">this</span>.message = em.getMessage();</span><br><span class="line">        <span class="built_in">this</span>.timestamp = System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>设置拦截器中的响应体的返回值即方法的返回类型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.test.advice;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonExceptionHandler</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 该方法的返回值就是返回给浏览器的信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@ExceptionHandler</span>()注解的作用是限定拦截的异常的类型</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExceptionHandler(MyException.class)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseEntity&lt;ExceptionResult&gt; <span class="title function_">myExceptionHandler</span><span class="params">(MyException e)</span>&#123;</span><br><span class="line">        <span class="type">ExceptionEnum</span> <span class="variable">exceptionEnum</span> <span class="operator">=</span> e.getExceptionEnum();</span><br><span class="line">        <span class="type">int</span> <span class="variable">statusCode</span> <span class="operator">=</span> exceptionEnum.getStatusCode();</span><br><span class="line">        <span class="keyword">return</span> ResponseEntity.status(statusCode).body(<span class="keyword">new</span> <span class="title class_">ExceptionResult</span>(exceptionEnum));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>最终得到的结果如下：</p>
<p><img src="/2020/11/26/%E9%80%9A%E7%94%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/image-20201126191922799.png"></p>
</li>
</ul>
</li>
</ol>
<p>整个项目的目录结构如下：</p>
<p><img src="/2020/11/26/%E9%80%9A%E7%94%A8%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8/image-20201126192009153.png"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/25/json%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8CJava%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%97%B4%E7%9A%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/25/json%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8CJava%E5%AF%B9%E8%B1%A1%E4%B9%8B%E9%97%B4%E7%9A%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2/" class="post-title-link" itemprop="url">json字符串和Java对象之间的相互转换</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-25 22:05:52" itemprop="dateCreated datePublished" datetime="2020-11-25T22:05:52+08:00">2020-11-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2020-11-26 12:17:08" itemprop="dateModified" datetime="2020-11-26T12:17:08+08:00">2020-11-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/JavaWeb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><ul>
<li>JSON：JavaScript 对象表示法（JavaScript Object Notation）。</li>
<li>JSON 是存储和交换文本信息的语法。类似 XML。</li>
<li>JSON 比 XML 更小、更快，更易解析。</li>
</ul>
<p>在开发过程中，系统和系统之间经常需要交换数据，数据交换的格式有XML、Json等。JSON 作为一种轻量级的数据交换格式，效率比XML高，更易于人阅读和编写，同时也易于机器解析和生成。这些特性使JSON 成为理想的数据交换语言。</p>
<hr>
<h1 id="序列化-反序列化"><a href="#序列化-反序列化" class="headerlink" title="序列化/反序列化"></a>序列化/反序列化</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><ul>
<li><strong>序列化</strong>：Java中序列化就是指把Java对象转换为二进制字节流的过程。（二进制的字节流可以用String保存）</li>
<li><strong>反序列化</strong>：反序列化就是指把二进制字节流恢复为Java对象的过程。</li>
</ul>
<h2 id="序列化的作用"><a href="#序列化的作用" class="headerlink" title="序列化的作用"></a>序列化的作用</h2><ul>
<li>序列化的核心功能是：在传递和保存对象时，保证对象的可传递性和完整性。对象转换为有序字节流，</li>
<li>反序列化的核心功能是：根据字节流中保存的对象状态及描述信息，通过反序列化重建对象</li>
</ul>
<h2 id="Json-XML数据的网络传输"><a href="#Json-XML数据的网络传输" class="headerlink" title="Json/XML数据的网络传输"></a>Json/XML数据的网络传输</h2><ul>
<li>在数据传输前，先通过序列化工具将Java对象序列化为Json/XML文件；</li>
<li>在数据传输后，再将Json/XML文件反序列化为对应的语言对象。</li>
</ul>
<hr>
<h1 id="Json字符串在Java中的使用"><a href="#Json字符串在Java中的使用" class="headerlink" title="Json字符串在Java中的使用"></a>Json字符串在Java中的使用</h1><blockquote>
<p>json字符串在Java中的操作，不外乎2种情况：</p>
<ul>
<li><strong>序列化</strong>：<code>Java对象--&gt;&gt;json字符串</code></li>
<li><strong>反序列化</strong>：<code>json字符串--&gt;&gt;Java对象</code></li>
</ul>
</blockquote>
<p>要想实现Json字符串和Java对象之间的相互转换，需要借助第3方jar包（或导入Maven依赖）。常见的Json解析器有：jsonlib、gson、fastjson、jackson等。我们这里采用Jackson依赖，因为SpringMVC中默认集成了Jackson依赖。</p>
<ul>
<li>使用Jackson要导入的Maven依赖。（如果已经导入<code>spring-boot-starter-web</code>依赖，则无需重复导入下面的依赖）</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><ol>
<li><p>在本地服务器上创建一个实体类Student</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(Integer id, String name, Integer age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// get方法不能省略</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>创建一个测试类，对Student对象进行序列化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JsonTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1、创建Jackson的核心对象</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="comment">// 2、创建Student实体类对象</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">3</span>, <span class="string">&quot;张飞&quot;</span>, <span class="number">34</span>);</span><br><span class="line">        <span class="comment">// 3、调用ObjectMapper对象中的方法将对象序列化</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> objectMapper.writeValueAsString(student);</span><br><span class="line">        System.out.println(json);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>输出结果是一个Json字符串。</p>
</li>
</ol>
<blockquote>
<p><strong>Tip</strong>：对象的序列化就是将对象中的数据一一拿出来转化为二进制数据，所以实体类中每个属性一定要有get方法，如果没有get方法，则Jackson的核心对象<code>ObjectMapper</code>无法获取到实体类中的属性，就无法对属性进行序列化。</p>
</blockquote>
<h2 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h2><h3 id="json字符串转普通对象"><a href="#json字符串转普通对象" class="headerlink" title="json字符串转普通对象"></a>json字符串转普通对象</h3><ul>
<li>本地服务器接收到远程服务器发来的一段二进制Json字节流，想要转换成Java对象的形式 ，步骤如下：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JsonTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1、模拟从远程服务器接收json字节流</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">3</span>, <span class="string">&quot;张飞&quot;</span>, <span class="number">34</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> objectMapper.writeValueAsString(student);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2、创建Jackson的核心对象</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="comment">// 3、反序列化（json--&gt;普通Java对象）</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">j_stu</span> <span class="operator">=</span> objectMapper.readValue(json, Student.class);</span><br><span class="line">        System.out.println(j_stu);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Json字符串转集合"><a href="#Json字符串转集合" class="headerlink" title="Json字符串转集合"></a>Json字符串转集合</h3><p>Json字符串转集合比较麻烦，因为你无法同时把集合的class和元素的class同时传递到一个参数。因此Jackson做了一个工具类，用来解决这个问题：</p>
<ul>
<li>方法1：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JsonTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">       </span><br><span class="line">        <span class="comment">// 1、模拟从远程服务器接收json字节流</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">student1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">3</span>, <span class="string">&quot;张飞&quot;</span>, <span class="number">34</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">2</span>, <span class="string">&quot;关羽&quot;</span>, <span class="number">36</span>);</span><br><span class="line">        ArrayList&lt;Student&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Student&gt;();</span><br><span class="line">        list.add(student1);</span><br><span class="line">        list.add(student2);</span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> objectMapper.writeValueAsString(list);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2、创建Jackson的核心对象</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3、反序列化</span></span><br><span class="line">        <span class="comment">// 3.1 创建一个工具类，用于接收集合类型的json字符串并指定集合中的元素类型</span></span><br><span class="line">        <span class="type">CollectionType</span> <span class="variable">factory</span> <span class="operator">=</span> objectMapper.getTypeFactory().constructCollectionType(List.class, Student.class);</span><br><span class="line">        <span class="comment">// 3.2 调用readValue()方法将json数据反序列化到内存中</span></span><br><span class="line">        List&lt;Student&gt; list_stu = objectMapper.readValue(json, factory);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>方法2：只是换了一个工具类来指定json字节流要转换的数据类型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JsonTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1、模拟从远程服务器接收json字节流</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">student1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">3</span>, <span class="string">&quot;张飞&quot;</span>, <span class="number">34</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">2</span>, <span class="string">&quot;关羽&quot;</span>, <span class="number">36</span>);</span><br><span class="line">        ArrayList&lt;Student&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Student&gt;();</span><br><span class="line">        list.add(student1);</span><br><span class="line">        list.add(student2);</span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> objectMapper.writeValueAsString(list);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2、创建Jackson的核心对象</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3、反序列化（json--&gt;List集合）</span></span><br><span class="line">        List&lt;Student&gt; value = objectMapper.readValue(json, <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;List&lt;Student&gt;&gt;() &#123;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="json字符串转任意复杂类型"><a href="#json字符串转任意复杂类型" class="headerlink" title="json字符串转任意复杂类型"></a>json字符串转任意复杂类型</h3><p>当对象泛型关系复杂时，类型工厂使用起来也会比较复杂。这时就可以采用Jackson提供的<code>TypeReference</code>来接收类型泛型，然后底层通过反射来获取泛型上的具体类型。实现json字节流与任意类型对象的转换。当然<code>TypeReference</code>也可以用于json字符串转集合。</p>
<ul>
<li>json字符串转为为List集合，List集合中的元素是Map对象。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JsonTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> JsonProcessingException &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1、模拟从远程服务器接收json字节流</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">student1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">3</span>, <span class="string">&quot;张飞&quot;</span>, <span class="number">34</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">2</span>, <span class="string">&quot;关羽&quot;</span>, <span class="number">36</span>);</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Student&gt;();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">map2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Student&gt;();</span><br><span class="line">        map1.put(<span class="string">&quot;二哥&quot;</span>, student1);</span><br><span class="line">        map2.put(<span class="string">&quot;三弟&quot;</span>, student2);</span><br><span class="line">        <span class="type">ArrayList</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">        list.add(map1);</span><br><span class="line">        list.add(map2);</span><br><span class="line">        <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> objectMapper.writeValueAsString(list);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 2、创建Jackson的核心对象</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3、反序列化（json--&gt;Map集合）</span></span><br><span class="line">        List&lt;Map&lt;String, Student&gt;&gt; list_map = objectMapper.readValue(json, <span class="keyword">new</span> <span class="title class_">TypeReference</span>&lt;List&lt;Map&lt;String, Student&gt;&gt;&gt;() &#123;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        System.out.println(list_map);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>










      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/25/SpringCloudApplication%E6%B3%A8%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/25/SpringCloudApplication%E6%B3%A8%E8%A7%A3/" class="post-title-link" itemprop="url">@SpringCloudApplication注解</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-11-25 10:39:34 / Modified: 10:48:10" itemprop="dateCreated datePublished" datetime="2020-11-25T10:39:34+08:00">2020-11-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SpringCould/" itemprop="url" rel="index"><span itemprop="name">SpringCould</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>源码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableCircuitBreaker</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SpringCloudApplication &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@SpringCouldApplication</code>注解是一个注解的集合。其中的主要功能注解有3个，分别是：</p>
<ol>
<li><code>@SpringBootApplication</code><ul>
<li>声明当前类是一个SpringBoot类</li>
</ul>
</li>
<li><code>@EnableDiscoveryClient</code><ul>
<li>声明当前类是Eureka服务注册中心的服务调用者</li>
</ul>
</li>
<li><code>@EnableCircuitBreaker</code><ul>
<li>声明当前类使用了Hystrix熔断器</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/22/Java%E4%B8%ADString%E5%92%8Cint%E4%B9%8B%E9%97%B4%E7%9A%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/22/Java%E4%B8%ADString%E5%92%8Cint%E4%B9%8B%E9%97%B4%E7%9A%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2/" class="post-title-link" itemprop="url">Java中String和int之间的相互转换</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-22 17:24:54" itemprop="dateCreated datePublished" datetime="2020-11-22T17:24:54+08:00">2020-11-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-08-02 21:14:40" itemprop="dateModified" datetime="2021-08-02T21:14:40+08:00">2021-08-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/JavaExt/" itemprop="url" rel="index"><span itemprop="name">JavaExt</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 已知：</span></span><br><span class="line"><span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">123</span>；</span><br><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h1 id="int-–-gt-String"><a href="#int-–-gt-String" class="headerlink" title="int –&gt; String"></a>int –&gt; String</h1><blockquote>
<p>方法1：<code>int</code>类型数据与<code>空字符串</code>直接用<code>+</code>相连</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = i + <span class="string">&quot;&quot;</span>;		<span class="comment">// 会产生两个String对象</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>方法2：使用String类中的静态方法：<code>valueOf()</code></strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = String.valueOf(i)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>方法3：使用<code>Integer</code>类中的静态方法：<code>toString()</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = Integer.toString(i)</span><br></pre></td></tr></table></figure>





<hr>
<h1 id="String-–-gt-int"><a href="#String-–-gt-int" class="headerlink" title="String –&gt; int"></a>String –&gt; int</h1><blockquote>
<p>使用<code>Integer</code>类中的静态方法：<code>praseInt()</code>，不会产生多余的对象，但会抛出异常</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i = Integer.parseInt(s)</span><br></pre></td></tr></table></figure>





<h1 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h1><blockquote>
<p>Double、Float、Long、Byte、Short与String之间的转换方法大同小异。</p>
</blockquote>
<h1 id="String–-gt-char-char数组"><a href="#String–-gt-char-char数组" class="headerlink" title="String–&gt;char/char数组"></a>String–&gt;char/char数组</h1><table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center">返回值</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>String.charAt(index)</code></td>
<td align="center"><code>char</code></td>
<td align="center">可以得到String中某一指定位置的char</td>
</tr>
<tr>
<td align="center"><code>String.toCharArray()</code></td>
<td align="center"><code>char[]</code></td>
<td align="center">可以得到整个String转化的char数组</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/21/Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/21/Redis/" class="post-title-link" itemprop="url">Redis</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-21 19:03:59" itemprop="dateCreated datePublished" datetime="2020-11-21T19:03:59+08:00">2020-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-02-22 16:31:36" itemprop="dateModified" datetime="2022-02-22T16:31:36+08:00">2022-02-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Redis/" itemprop="url" rel="index"><span itemprop="name">Redis</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<ul>
<li>Redis 是一款高性能的 NOSQL 非关系型数据库。</li>
<li>Redis 是用 C 语言开发的一个开源的高性能键值对 <code>&lt;K, V&gt;</code> 内存数据库！</li>
<li><strong>比 SQL 数据库具有更快的读写速度和高并发处理能力！</strong></li>
</ul>
</blockquote>
<h1 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h1><ul>
<li><a target="_blank" rel="noopener" href="https://redis.io/">官网</a></li>
<li><a target="_blank" rel="noopener" href="http://www.redis.net.cn/">官方中文网</a></li>
</ul>
<blockquote>
<p>Windows </p>
</blockquote>
<p>下载得到一个压缩文件，解压直接可以使用。文件中包含：</p>
<ul>
<li><code>redis.windows.conf</code>：配置文件</li>
<li><code>redis-cli.exe</code>：redis的客户端</li>
<li><code>redis-server.exe</code>：redis服务器端</li>
<li>……</li>
</ul>
<blockquote>
<p>Linux</p>
</blockquote>
<p>直接使用宝塔面板安装即可！</p>
<blockquote>
<p><strong>Redis服务器端的默认端口号是：6379</strong></p>
</blockquote>
<h1 id="Redis开源客户端工具"><a href="#Redis开源客户端工具" class="headerlink" title="Redis开源客户端工具"></a>Redis开源客户端工具</h1><p><strong>QuickRedis 下载地址：</strong></p>
<blockquote>
<ul>
<li>  Github：<a target="_blank" rel="noopener" href="https://github.com/quick123official/quick_redis_blog/releases">https://github.com/quick123official/quick_redis_blog/releases</a></li>
<li>  Gitee：<a target="_blank" rel="noopener" href="https://gitee.com/quick123official/quick_redis_blog/releases">https://gitee.com/quick123official/quick_redis_blog/releases</a></li>
</ul>
</blockquote>
<p><strong>Another Redis Desktop Manager 下载地址：</strong></p>
<blockquote>
<ul>
<li>  Github：<a target="_blank" rel="noopener" href="https://github.com/qishibo/AnotherRedisDesktopManager/releases">https://github.com/qishibo/AnotherRedisDesktopManager/releases</a></li>
<li>  Gitee：<a target="_blank" rel="noopener" href="https://gitee.com/qishibo/AnotherRedisDesktopManager/releases">https://gitee.com/qishibo/AnotherRedisDesktopManager/releases</a></li>
</ul>
</blockquote>
<h1 id="Redis中的数据类型"><a href="#Redis中的数据类型" class="headerlink" title="Redis中的数据类型"></a>Redis中的数据类型</h1><p>Redis在内存中以键值对的形式存储数据。其中所有<code>键（key）</code>都是String类型，而<code>值（value）</code>有 <strong>5 种不同的数据类型</strong>，我们常说的 Redis 的数据类型其实是指 Redis 键值对中<code>值（value）</code>的数据类型。</p>
<blockquote>
<ol>
<li>字符串类型 <code>String</code></li>
<li>哈希类型 <code>hash</code> ： Map格式</li>
<li>列表类型 <code>list</code> ： LinkedList格式，支持重复元素</li>
<li>集合类型 <code>set</code> ： LinkedList格式，不允许重复元素</li>
<li>有序集合类型 <code>sortedset</code> ： LinkedList格式，不允许重复元素，且元素有序。</li>
</ol>
</blockquote>
<p><img src="/2020/11/21/Redis/redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.png"></p>
<h1 id="Redis-常用命令"><a href="#Redis-常用命令" class="headerlink" title="Redis 常用命令"></a>Redis 常用命令</h1><blockquote>
<p>  <strong>备注</strong></p>
</blockquote>
<ul>
<li>  Redis 的命令是不区分大小写的，而 key 是区分大小写的。</li>
</ul>
<h3 id="3-1-字符串类型（String）"><a href="#3-1-字符串类型（String）" class="headerlink" title="3.1    字符串类型（String）"></a>3.1    字符串类型（String）</h3><ol>
<li><p>存储：<code>set key value</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set name zhangsan</span><br><span class="line"># 多次为同一个key赋值会覆盖之前的值</span><br><span class="line"></span><br><span class="line"># 一次设置多个值[m；more]</span><br><span class="line">mset k1 v1 k2 v2 k3 v3</span><br></pre></td></tr></table></figure></li>
<li><p>获取：<code>get key</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> name</span><br><span class="line"></span><br><span class="line"># 一次获取多个值</span><br><span class="line">mget k1 k2 k3</span><br></pre></td></tr></table></figure></li>
<li><p>删除：<code>del key</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">del name</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="3-2-哈希类型（Hash）"><a href="#3-2-哈希类型（Hash）" class="headerlink" title="3.2    哈希类型（Hash）"></a>3.2    哈希类型（Hash）</h3><ol>
<li><p>存储：<code>hset key field value</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hset person name zhangsan</span><br><span class="line">hset person age <span class="number">23</span></span><br><span class="line"><span class="comment">-- 等价于 </span></span><br><span class="line">hset person name zhangsan age <span class="number">23</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在添加 Hash 类型数据时，HashMap 中可以只有一个键值对，也可以包含多个键值对</span></span><br><span class="line"><span class="comment">-- 如果 HashMap 中只包含一个键值对，且多次添加 HashMap ，这时 Redis 会先判断 HashMap 中 key 的值，如果key不同，即为追加操作；如果key相同，会直接报错</span></span><br><span class="line"><span class="comment">-- 添加的 HashMap 中可以包含多个键值对，只要 key 不同，也是符合 Redis 的语法规则的！</span></span><br></pre></td></tr></table></figure></li>
<li><p>获取：</p>
<ul>
<li>获取 Hash 中指定 key 的值：<code>hget key hashKey</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hget person name</span><br><span class="line">hget person age</span><br></pre></td></tr></table></figure>

<ul>
<li>获取 Hash 中的所有键值对：<code>hgetall key</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgetall person</span><br></pre></td></tr></table></figure></li>
<li><p>删除：<code>hdel key hashKey</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdel person name</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="3-3-列表类型（List）"><a href="#3-3-列表类型（List）" class="headerlink" title="3.3    列表类型（List）"></a>3.3    列表类型（List）</h3><ol>
<li><p>添加：可以添加一个元素到列表的头部（左边）或尾部（右边）</p>
<ul>
<li><code>lpush key value</code>：将元素加入列表左边</li>
<li><code>rpush key value</code>：将元素加入列表右边</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">lpush mylist a</span><br><span class="line">lpush mylist b</span><br><span class="line">lpush mylist c</span><br><span class="line"></span><br><span class="line">rpush mylist a</span><br><span class="line">rpush mylist b</span><br><span class="line">rpush mylist c</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 最终得到的列表是： [c b a   a b c]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>List和String的区别是：当key相同时存储元素，String类型是覆盖，而List是追加</strong></p>
</blockquote>
</li>
<li><p>获取：<code>lrange key start end</code>，根据范围获取。<code>0 -1</code>表示获取全部元素。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lrange mylist <span class="number">0</span> <span class="number">-1</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><strong>下标从 0 开始取，左右都是闭区间，也就是说 <code>lrange mylist 0 0</code> 也能取到第一个元素</strong></li>
<li><strong>没有<code>rrange</code>这个命令</strong></li>
</ul>
</blockquote>
</li>
<li><p>删除：</p>
<ul>
<li><code>lpop key</code>：删除列表最左边的元素，并将元素返回</li>
<li><code>rpop key</code>：删除列表最右边的元素，并将元素返回</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lpop mylist</span><br><span class="line">rpop mylist</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="3-4-集合类型（Set）"><a href="#3-4-集合类型（Set）" class="headerlink" title="3.4    集合类型（Set）"></a>3.4    集合类型（Set）</h3><blockquote>
<p>不允许重复元素</p>
</blockquote>
<ol>
<li><p>存储：<code>sadd key value</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sadd myset a</span><br><span class="line">sadd myset a</span><br><span class="line">sadd myset b</span><br><span class="line"></span><br><span class="line"><span class="comment">-- set集合中的有效元素只有2个。[a b]</span></span><br></pre></td></tr></table></figure></li>
<li><p>获取集合中的所有元素：<code>smembers key</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smembers myset</span><br></pre></td></tr></table></figure></li>
<li><p>删除集合中的某个元素：<code>srem key value</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">srem myset b</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="3-5-有序集合类型（SortedSet）"><a href="#3-5-有序集合类型（SortedSet）" class="headerlink" title="3.5    有序集合类型（SortedSet）"></a>3.5    有序集合类型（SortedSet）</h3><blockquote>
<p>不允许重复元素，且元素有序，每个元素都会关联一个double类型的<code>分数（score）</code>，Redis 通过<code>分数（score）</code>来为集合中的成员<strong>从小到大</strong>排序。</p>
</blockquote>
<ol>
<li><p>存储：<code>zadd key score value</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zadd mysort <span class="number">60</span> english</span><br><span class="line">zadd mysort <span class="number">90</span> chinese</span><br><span class="line">zadd mysort <span class="number">80</span> math</span><br></pre></td></tr></table></figure></li>
<li><p>获取：</p>
<ul>
<li><code>zrange key start end</code>：按分数从小到大的顺序获取<code>value</code></li>
<li><code>zrange key start end withscores</code>：按分数从小到大的顺序获取<code>value</code>和<code>score</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zrange mysort <span class="number">0</span> <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">zrange mysort <span class="number">0</span> <span class="number">-1</span> withscores</span><br></pre></td></tr></table></figure></li>
<li><p>删除：<code>zrem key value</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zrem mysort english</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h3 id="3-6-通用命令"><a href="#3-6-通用命令" class="headerlink" title="3.6    通用命令"></a>3.6    通用命令</h3><blockquote>
<p>  查看 Redis 版本</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis- server -v</span><br></pre></td></tr></table></figure>

<ol>
<li>查询所有的键：<code>keys *</code></li>
<li>获取指定键<code>key</code>对应的值<code>value</code>的数据类型：<code>type key</code></li>
<li>删除指定的键值对：<code>del key</code></li>
</ol>
<hr>
<h1 id="持久化机制"><a href="#持久化机制" class="headerlink" title="持久化机制"></a>持久化机制</h1><p>Redis 是一个<strong>内存数据库</strong>，当 Redis 服务器重启后内存中的数据就会丢失。为了解决这个问题，我们可以将 Redis 内存中的数据持久化保存到磁盘中。</p>
<p><strong>Redis 的持久化机制（2种）</strong></p>
<ol>
<li>RDB（Redis DataBase）：默认方式【快照】</li>
<li>AOF（Append Only File）：【只追加文件】</li>
</ol>
<h2 id="1-RDB"><a href="#1-RDB" class="headerlink" title="1    RDB"></a>1    RDB</h2><p><strong>工作流程：</strong></p>
<ul>
<li>  在指定的时间间隔内将内存中的数据集快照（Snapshot）写到磁盘中，它恢复时是直接将快照文件读到内存中。</li>
</ul>
<p><strong>RDB 优缺点：</strong></p>
<ul>
<li>  <strong>优点</strong>：</li>
<li>  <strong>缺点</strong>：在一定时间间隔后才会进行一次备份，所以如果 Redis 服务器在两个备份的时间点之间宕机的话，就会丢失掉最后一次快照之后所有的修改。</li>
</ul>
<p><strong>RDB 原理</strong>：</p>
<ul>
<li>  Redis 存在一个后台线程，这个线程的会监控两个参数，一个是时间间隔（单位：s），一个是发生变化的 key 的个数。在一定的时间间隔后，检测 key 的变化情况，如果满足持久化条件就进行一次数据持久化到磁盘中。</li>
</ul>
<p><strong>RDB 配置</strong></p>
<ul>
<li>  在<code>redis.windows.conf</code>文件中，有如下几行数据：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60  10000</span><br><span class="line"></span><br><span class="line">其含义分别是：</span><br><span class="line">#	after 900 sec (15 min) if at least 1 key changed	900s之后至少有1个key发生变化则持久化数据</span><br><span class="line">#   after 300 sec (5 min) if at least 10 keys changed	300s之后至少有10个key发生变化则持久化数据</span><br><span class="line">#   after 60 sec if at least 10000 keys changed		60s之后至少有10000个key发生变化则持久化数据</span><br></pre></td></tr></table></figure>



<ul>
<li>  如果想要自定义间隔时间和发生变化的 key 的数量，直接修改配置文件即可。但注意修改配置文件后，需重启 Redis 服务器，并在启动时指定要加载的配置文件名称。</li>
</ul>
<blockquote>
<p>在服务器目录下进入 CMD 命令行窗口界面，输入以下命令：</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server.exe redis.windows.conf	</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动服务器 + 并加载指定配置文件</span></span><br></pre></td></tr></table></figure>







<h2 id="2-AOF"><a href="#2-AOF" class="headerlink" title="2    AOF"></a>2    AOF</h2><p><strong>工作流程：</strong></p>
<ul>
<li>  以日志的形式来记录每个写操作，将 Redis 执行过的所有写操作指令记录下来（读操作不记录），只允许追加日志文件但不允许修改日志文件。</li>
<li>  Redis 重启后就会读取该文件的内容将所有的写操作的指令从头到尾执行一遍以完成数据恢复的工作。</li>
<li>  AOF 采用文件追加的方式，日志文件只会越来越大，为了避免这种情况，新增了重写机制，当 AOF 日志文件的大小超过所设定的阈值时，Redis 就会启动 AOF 文件的内容压缩，只保留可以恢复数据的最小指令集。</li>
</ul>
<blockquote>
<p>  什么叫可以恢复数据的最小指令集？</p>
</blockquote>
<p>所谓可以恢复数据的最小指令集，就是可以恢复 Redis 中数据的最少指令集。正常情况下，所有写操作都会被保存到日志文件中，那么显然，假如有一个 val 值，先对 val 进行 +1 操作，再对 val 进行 -1 操作，那么这就是两条指令，虽然执行完这两条指令后 val 的值没有任何变换，但是日志文件的大小却增加了，而日志文件压缩就是把可以互相抵消的指令抵消掉，只留下可以保证 Redis 数据完整性的最少指令集。</p>
<p><strong>AOF原理：</strong></p>
<ul>
<li>  AOF（Append Only File），即只依赖配置文件的方式。通过配置文件设置的方式持久化 Redis 缓存中的数据。</li>
</ul>
<p><strong>AOF优缺点</strong></p>
<ul>
<li><strong>优点：</strong><ol>
<li> 每次修改同步（<code>appendfsync always</code> ），每次发生数据变化会被立即记录到磁盘，性能较差但是数据完整性较好。</li>
<li> 每秒同步（<code>appendfsync everysec</code>） ： 每秒进行一次持久化，如果一秒内宕机，会有数据丢失。</li>
<li> 从不同步（<code>appendfsync no</code>） </li>
</ol>
</li>
<li><strong>缺点：</strong><ol>
<li> AOF 日志文件往往要大于 RDB 快照文件，一方面磁盘占用较大，另一方面恢复速度要慢于 RDB。【RDB 是按照数据恢复，而 AOF 则是按照操作恢复】</li>
</ol>
</li>
</ul>
<p><strong>AOF 配置：</strong></p>
<ol>
<li><p>编辑<code>redis.windows.conf</code>文件，设置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">appendonly no	# 关闭AOF</span><br><span class="line">appendonly yes 	# 开启AOF</span><br></pre></td></tr></table></figure>

<blockquote>
<p>详细参数：</p>
<ul>
<li><code>appendfsync always</code> ： 每一次操作都进行持久化</li>
<li><code>appendfsync everysec</code> ： 每隔一秒进行一次持久化</li>
<li><code>appendfsync no</code>     ： 不进行持久化</li>
</ul>
</blockquote>
</li>
<li><p>修改配置文件后，需重启Redis服务器，启动时需要指定配置文件名称。</p>
</li>
</ol>
<h2 id="3-如何选择合适的持久化方式"><a href="#3-如何选择合适的持久化方式" class="headerlink" title="3    如何选择合适的持久化方式"></a>3    如何选择合适的持久化方式</h2><ol>
<li> <strong>如果数据不敏感，</strong>并且数据丢失后可以从其它地方找补回来，那么就可以关闭持久化。</li>
<li> <strong>如果数据比较重要，但是可以承受数分钟内的数据丢失</strong>，那么可以只使用 RDB。</li>
</ol>
<hr>
<h1 id="5-Redis-事务"><a href="#5-Redis-事务" class="headerlink" title="5    Redis 事务"></a>5    Redis 事务</h1><h2 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h2><ul>
<li>  之前我们使用的 Redis 命令都是输入一条指令，得到一个结果。</li>
<li>  而<strong>Redis 事务</strong>可以一次执行多条命令，本质上就是一组命令的集合。</li>
<li>  一个事务中的所有命令都会序列化，按顺序地串行化执行而不会被其它命令加塞。</li>
<li>  Redis 事务的主要作用就是串联多个命令防止别的命令插队。</li>
</ul>
<hr>
<h2 id="怎么用"><a href="#怎么用" class="headerlink" title="怎么用"></a>怎么用</h2><ul>
<li>  <strong>MULTI</strong> 命令用于开启一个事务，它总是返回 OK 。</li>
<li>  <strong>MULTI</strong> 执行之后， 客户端可以继续向服务器发送任意多条命令， 这些命令不会立即被执行， 而是被放到一个队列中， 当 <strong>EXEC</strong> 命令被调用时， 一次性执行队列中的所有命令。</li>
<li>  在 EXEC 命令执行之前，通过调用 <strong>DISCARD</strong>， 客户端可以清空事务队列， 并放弃执行事务。</li>
</ul>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><blockquote>
<p>  <strong>Redis 事务命令</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><strong>DISCARD</strong></td>
<td>取消事务，并清空事务块内所有命令</td>
</tr>
<tr>
<td><strong>EXEC</strong></td>
<td>执行事务块内的所有命令</td>
</tr>
<tr>
<td><strong>MULTI</strong></td>
<td>标记一个事务块的开始</td>
</tr>
<tr>
<td><strong>UNWATCH</strong></td>
<td>取消 WATCH 命令对所有 key 的监视</td>
</tr>
<tr>
<td><strong>WATCH key [key…]</strong></td>
<td>监视一个（或多个key），如果在事务执行之前这个（或这些）key 被其它命令所改动，那么事务将被打断。</td>
</tr>
</tbody></table>
<h3 id="Case1：正常执行"><a href="#Case1：正常执行" class="headerlink" title="Case1：正常执行"></a>Case1：正常执行</h3><ol>
<li> 从 <strong>MULTI 开始</strong>，标记一个事务块的开始，并创建一个命令队列用于保存命令的集合；</li>
<li> 在遇到 <strong>EXEC 之前</strong>，所有正确的命令都会被添加到命令队列中；</li>
<li> 直到遇到 <strong>EXEC 命令后</strong>，立即执行队列中的所有命令。 </li>
</ol>
<img src="/2020/11/21/Redis/image-20210809100102082.png" alt="image-20210809100102082" style="zoom:80%;">



<hr>
<h3 id="Case2：放弃事务"><a href="#Case2：放弃事务" class="headerlink" title="Case2：放弃事务"></a>Case2：放弃事务</h3><ol>
<li> 从 <strong>MULTI 开始</strong>，标记一个事务块的开始，并创建一个命令队列用于保存命令的集合；</li>
<li> 所有正确的命令都会被添加到命令队列中；</li>
<li> 但是遇到 <strong>DISCARD</strong> 命令后，会删除命令队列并放弃队列中所有命令的执行。</li>
<li> 在这之后，我们通过 <code>get k1</code> 试图查找 Redis 中是否存在键为 k1 的值，发现不存在，这就证明该事务内的所有命令都没有被执行。</li>
</ol>
<img src="/2020/11/21/Redis/image-20210809100735411.png" alt="image-20210809100735411" style="zoom:80%;">



<hr>
<h3 id="Case3：全体连坐"><a href="#Case3：全体连坐" class="headerlink" title="Case3：全体连坐"></a>Case3：全体连坐</h3><ol>
<li> 从 <strong>MULTI 开始</strong>，标记一个事务块的开始，并创建一个命令队列用于保存命令的集合；</li>
<li> 所有命令都会被添加到命令队列中；</li>
<li> 在执行 <code>gte k2</code> 命令时，由于操作人员的疏忽，命令打错了；并继续添加命令 <code>set k3 v3</code>；</li>
<li> 直到遇到 <strong>EXEC 命令后</strong>，立即执行队列中的所有命令。</li>
<li> 但是<strong>由于此时队列中存在一个错误的命令，这条命令执行失败了，并且连带着整个事务中所有的命令都执行失败了</strong>。 </li>
<li> 在这之后，执行 <code>get k1</code> 操作，发现没有对应的 value，这也从侧面验证了事务块中所有的命令都没有执行成功。</li>
<li> 这就是 Redis 的事务性。</li>
</ol>
<img src="/2020/11/21/Redis/image-20210809101749283.png" alt="image-20210809101749283" style="zoom:80%;">



<hr>
<h3 id="Case4：冤头债主"><a href="#Case4：冤头债主" class="headerlink" title="Case4：冤头债主"></a>Case4：冤头债主</h3><ol>
<li> 从 <strong>MULTI 开始</strong>，标记一个事务块的开始，并创建一个命令队列用于保存命令的集合；</li>
<li> 所有命令都会被添加到命令队列中；</li>
<li> 在执行 <code>incr k1</code> 命令时，由于 <code>k1</code> 位置上存储的值 <code>v1</code> 是一个字符串，且不能转型成为对应的 <code>Integer</code> 类型，所以这条命令在真实执行时会报错，但在编译时不会报错，因为命令是正确的。</li>
<li> 直到遇到 <strong>EXEC 命令后</strong>，立即执行队列中的所有命令。</li>
<li> <strong>由于 <code>incr k1</code> 命令在执行时会报错，所以这条命令执行失败。但是与上面不同的是，此时事务中的其它正确的命令还是可以正常被执行。</strong></li>
<li> 在这之后，执行 <code>get k2</code> 操作，发现可以找到对应的 value，这也从侧面验证了事务块中其它正确的命令都执行成功了。</li>
<li> 这就是 Redis 的非事务性。</li>
</ol>
<p><strong>Incr</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Redis Incr 命令将 key 中储存的数字值 +<span class="number">1</span>。</span><br><span class="line">如果 key 不存在，那么 key 的值会先被初始化为 <span class="number">0</span> ，然后再执行 INCR 操作。</span><br><span class="line">如果值包含错误的类型，或字符串类型的值不能表示为数字，那么返回一个错误。</span><br></pre></td></tr></table></figure>

<p><img src="/2020/11/21/Redis/image-20210809102642290.png" alt="image-20210809102642290"></p>
<blockquote>
<p>  <strong>二者的区别：</strong></p>
</blockquote>
<ul>
<li>  我们发现，在 Case3 和 Case4 中，同样都出现了某条命令执行失败，但 Case3 中整个事务都回滚了，在 Case4 中却只是对应错误命令执行失败，而事务中的其它命令依然可以正常执行成功。那么这两者有什么区别呢？</li>
<li>  这就有点类似于 Java 中的编译时异常和运行时异常了。</li>
<li>  在 Case3 中出现的错误是非常明显的语法错误，Redis 的编译器在我们敲下回车的那一刻就会直接返回 Error 错误信息提示我们该条命令是有问题的。发生这类错误时是需要回滚整个事务的。类比于 Java 中的编译时错误，当我们的代码写错的那一刹那，IDE 的编译器就会用红色的下划线提醒我们代码错了。</li>
<li>  而在 Case4 中出现的错误，它是语法正确，但在执行过程中由于类型不匹配而导致的错误，这种错误在编译时不会报错，在执行中出现错误以后也无需回滚整个事务。类比于 Java 中的运行时错误，比如我们在 Java 代码中插入一行 <code>int i = 10/2;</code>，这行代码在编译时是没有问题的，因为它符合语法规范，但在运行时由于除数不能为0而会抛出异常。</li>
<li>  简而言之就是：<strong>开启事务后，如果在添加命令的过程中，Redis 的编译器没有报错，那么即使程序在执行过程中出现了错误，也只是某条错误命令执行失败了，而不会影响到事务中的其它命令。如果在添加命令的过程中，某条命令在编译后直接报错，那么在执行过程中出错后会回滚整个事务中的所有命令。</strong></li>
</ul>
<hr>
<h3 id="Case5：watch-监控"><a href="#Case5：watch-监控" class="headerlink" title="Case5：watch 监控"></a>Case5：watch 监控</h3><ul>
<li>  <strong>watch 监控：在执行 <code>multi</code> 之前，先执行 <code>watch key1 [key2]</code>，可以监视一个或多个 key，如果在事务执行之前这个（或这些）key 被其它命令所改动，那么事务将被打断。</strong></li>
<li>  watch 监控用于多个 Session 并发操作时保证数据的一致性。在事务开始之前监控一个关键值属性，如果在事务还未执行之前该关键值被另一个 Session 改变，则当前连接的事务一定不会执行成功。</li>
</ul>
<blockquote>
<p>  先模拟一个场景，假设某用户花呗额度为 100 元，在淘宝上购买某本书需要 40 元。通过花呗买书的一个事务为：花呗余额减到 60 元，待还款金额增加到 40 元。</p>
</blockquote>
<ol>
<li><p>初始化数据：花呗余额100，欠款 0</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Connecting...</span><br><span class="line">已连接。</span><br><span class="line">Tencent_Redis:0&gt;set balance 100</span><br><span class="line">&quot;OK&quot;</span><br><span class="line">Tencent_Redis:0&gt;set debt 0</span><br><span class="line">&quot;OK&quot;</span><br></pre></td></tr></table></figure></li>
<li><p> 先监控一个属性 balance</p>
</li>
<li><p> 再开启事务</p>
</li>
<li><p>如果在事务执行之前，没有其它命令修改 balance 这个属性，正常结果为：</p>
<p> <img src="/2020/11/21/Redis/image-20210809175349825.png" alt="image-20210809175349825"></p>
</li>
<li><p>如果在事务执行之前，存在另一个线程修改了 balance 这个属性，则这个事务将被打断，所有数据会回滚到事务执行之前。</p>
<p> <img src="/2020/11/21/Redis/watch.png" alt="watch"></p>
</li>
<li><p> 最后通过 <code>get balance</code> 命令查看发现，Session1 中的事务并没有执行成功。</p>
</li>
</ol>
<h3 id="Case6：unwatch-取消监控"><a href="#Case6：unwatch-取消监控" class="headerlink" title="Case6：unwatch 取消监控"></a>Case6：unwatch 取消监控</h3><blockquote>
<p>  <strong>UNWATCH 在什么时候使用？</strong></p>
</blockquote>
<ul>
<li>  在执行 WATCH 命令监控某个字段后，如果在下一个命令还没有执行之前就知道被监控的字段被另一个 Session 修改了，那么此时可以直接 UNWATCH 取消原有的监控；重新监控该字段的最新值，重写编写命令。</li>
<li>  如果在执行了 WATCH 命令后，EXEC 或 DISCARD 命令先被执行了的话，那么就不需要再执行 UNWATCH 了。因为一旦执行了 EXEC 或 DISCARD 后，事务一定会结束（可能成功也可能失败），之前监控的关键值字段也就自然失效了。</li>
</ul>
<hr>
<h2 id="事务冲突问题"><a href="#事务冲突问题" class="headerlink" title="事务冲突问题"></a>事务冲突问题</h2><blockquote>
<ul>
<li>  乐观锁 + CAS</li>
<li>  悲观锁</li>
</ul>
</blockquote>
<h3 id="乐观锁-CAS"><a href="#乐观锁-CAS" class="headerlink" title="乐观锁 + CAS"></a>乐观锁 + CAS</h3><p><strong>乐观锁不会真正的对某一数据上锁，但是对数据进行写操作时，为了保证多个 Session 间数据的一致性要用到 CAS 机制。</strong></p>
<blockquote>
<p>  <strong>乐观锁（Optimistic Lock）</strong></p>
</blockquote>
<ul>
<li>  顾名思义，就是很乐观，想的贼好，每次在操作数据时都认为别人不会修改，所以不会上锁。</li>
<li>  但是如果不上锁的话，在线程 A 操作数据期间线程 B 也同时操作了数据，这时候就会发生数据冲突了。</li>
<li>  所以，对乐观锁而言，在更新数据的时候会判断一下在此期间别人有没有去更新这个数据，如果没有其它线程操作过这个数据则可以更新成功，如果有线程操作过这个数据则会重新读取最新的数据进行更新，直到更新成功。</li>
<li>  如果判断某一段时间内是否有其它线程更新过某个数据用到了 <strong>CAS</strong> 机制，常见的有版本号等机制。</li>
<li>  乐观锁适用于多读的应用类型，这样可以提高吞吐量，</li>
</ul>
<blockquote>
<p>  <strong>CAS（Check And Set）</strong></p>
</blockquote>
<ul>
<li>  CAS 最常见的机制就是版本号机制。</li>
<li>  所谓版本号机制，就是每个线程在得到操作共享数据的时候，同时会得到该数据的版本号，在完成数据操作想要覆盖原数据时，首先会判断线程中保存的版本号与共享数据的版本号是否一致，如果版本号一致则更新成功，并将共享数据的版本号 +1；若线程中保存的版本号与共享数据的版本号不一致的话，则不能更新成功。需要重新拉取最新的共享数据（包括最新的版本号），重新更新数据，直到更新成功为止。</li>
</ul>
<h3 id="悲观锁"><a href="#悲观锁" class="headerlink" title="悲观锁"></a>悲观锁</h3><blockquote>
<p>  <strong>悲观锁（Pessimistic Lock）</strong></p>
</blockquote>
<p>顾名思义，就是很悲观，每次去拿数据的时候都认为别人会修改，所以每次在拿数据的时候都会上锁，这样别人想拿这个数据就会被阻塞知道它拿到锁。传统的关系型数据库中很多地方都用到了这个锁机制，比如行锁、表锁、读锁、写锁等，都是在做操作之前先上锁。</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><h3 id="三阶段"><a href="#三阶段" class="headerlink" title="三阶段"></a>三阶段</h3><ol>
<li> <strong>开启</strong>：以 <strong>MULTI</strong> 开启一个事务；</li>
<li> <strong>入队</strong>：将多个命令入队到事务中，接到这些命令并不会立即执行，而是加入到待执行的事务队列中；</li>
<li> <strong>执行</strong>：由 <strong>EXEC</strong> 命令触发事务执行。</li>
</ol>
<h3 id="三特性"><a href="#三特性" class="headerlink" title="三特性"></a>三特性</h3><blockquote>
<p>  <strong>单独的隔离操作</strong></p>
</blockquote>
<ul>
<li>  事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其它客户端发送来的命令请求所打断。</li>
</ul>
<blockquote>
<p>  <strong>没有隔离级别的概念</strong></p>
</blockquote>
<ul>
<li>  与传统的 SQL 数据库不同，Redis 中没有事务的隔离级别这一概念。</li>
<li>  因为 Redis 的事务在执行 EXEC 命令前，只是把事务队列中的命令序列化，并不会真正地被执行。自然也就不存在“事务内的查询要看到事务里的更新，在事务外查询不能看到”这个让人万分头疼的问题。</li>
</ul>
<blockquote>
<p>  <strong>不保证原子性</strong></p>
</blockquote>
<ul>
<li>  Redis 中同一个事务如果有一条命令执行失败，其后的命令仍然可能会被执行，而不进行回滚。这个要分情况讨论。</li>
</ul>
<hr>
<h1 id="6-Redis-的发布订阅"><a href="#6-Redis-的发布订阅" class="headerlink" title="6    Redis 的发布订阅"></a>6    Redis 的发布订阅</h1><p>Redis 的发布订阅类似于 MQ 中的发布订阅，不过我们在企业级开发中一般不太使用 Redis 作为消息队列，而是采用更专业的消息中间件，如  ActiveMQ、RabbitMQ 或者 Kafka 等。</p>
<h2 id="是什么-1"><a href="#是什么-1" class="headerlink" title="是什么"></a>是什么</h2><p>发布订阅是进程间的一种通信模式：发送者（pub）发送消息，订阅者（sub）接收消息。</p>
<ul>
<li>  类似于微信公众号，只要你关注了某个公众号，当公众号再发布消息的时候，就会通知到你的微信上。</li>
</ul>
<h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>psubscribe pattern [pattern]</td>
<td>订阅一个或多个符合给定模式的频道</td>
</tr>
<tr>
<td>pubsub subcommand [argument [argument…]]</td>
<td>查看订阅与发布系统状态</td>
</tr>
<tr>
<td>publish channel message</td>
<td>将信息发送到指定的频道</td>
</tr>
<tr>
<td>punsubscribe [pattern [pattern …]]</td>
<td>退订所有给定模式的频道</td>
</tr>
<tr>
<td>unsubscribe [channel [channel…]]</td>
<td>退订指定的频道</td>
</tr>
</tbody></table>
<h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><p>先订阅后发布才能收到消息</p>
<ol>
<li> 可以一次性订阅多个；<code>subscribe c1 c2 c3</code></li>
<li> 消息发布；<code>publish c2 hello-redis</code></li>
<li> 一次性订阅多个（以通配符的形式）：<code>psubscribe hell*</code></li>
</ol>
<h1 id="7-Redis-主从复制（Master-Slave）"><a href="#7-Redis-主从复制（Master-Slave）" class="headerlink" title="7    Redis 主从复制（Master/Slave）"></a>7    Redis 主从复制（Master/Slave）</h1><h2 id="是什么-2"><a href="#是什么-2" class="headerlink" title="是什么"></a>是什么</h2><blockquote>
<p>  <strong>主从复制</strong></p>
</blockquote>
<p>主机数据更新后根据配置和策略，自动同步到从机的 Master/Slave 机制，<strong>Master 以写为主，Slave 以读为主</strong>。</p>
<img src="/2020/11/21/Redis/image-20210810151248584.png" alt="image-20210810151248584" style="zoom:200%;">



<h2 id="有什么用"><a href="#有什么用" class="headerlink" title="有什么用"></a>有什么用</h2><ul>
<li>  读写分离，性能扩展</li>
<li>  容灾快速恢复</li>
</ul>
<h2 id="怎么用（主从复制）"><a href="#怎么用（主从复制）" class="headerlink" title="怎么用（主从复制）"></a>怎么用（主从复制）</h2><h3 id="修改配置文件细节"><a href="#修改配置文件细节" class="headerlink" title="修改配置文件细节"></a>修改配置文件细节</h3><ol>
<li> 拷贝多个 <code>redis.conf</code> 文件，分别用作多台服务器的配置文件；</li>
<li> 开启 <code>daemonize yes</code>；</li>
<li> 修改 Pid 文件名字；</li>
<li> 为每台服务器指定端口；</li>
<li> 修改 Log 文件名字；</li>
<li> 修改 Dump.rab 名字；</li>
<li> Appendonly 关掉或者修改名字</li>
</ol>
<h3 id="实操"><a href="#实操" class="headerlink" title="实操"></a>实操</h3><h4 id="1、修改配置文件"><a href="#1、修改配置文件" class="headerlink" title="1、修改配置文件"></a>1、修改配置文件</h4><ol>
<li><p>新建 <code>redis6379.conf</code>，填写以下内容</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">include /myredis/redis.conf</span><br><span class="line">pidfile /<span class="keyword">var</span>/run/redis_6379.pid</span><br><span class="line">port <span class="number">6379</span></span><br><span class="line">dbfilename dump6379.rdb</span><br></pre></td></tr></table></figure>

 <img src="/2020/11/21/Redis/image-20210810151819939.png" alt="image-20210810151819939" style="zoom: 150%;"></li>
<li><p>新建 <code>redis6380.conf</code>，填写以下内容</p>
 <img src="/2020/11/21/Redis/image-20210810151900331.png" alt="image-20210810151900331" style="zoom:150%;"></li>
<li><p>新建 <code>redis6381.conf</code>，填写以下内容</p>
 <img src="/2020/11/21/Redis/image-20210810151913759.png" alt="image-20210810151913759" style="zoom:150%;"></li>
</ol>
<p>​                               </p>
<h4 id="2、启动三台redis服务器"><a href="#2、启动三台redis服务器" class="headerlink" title="2、启动三台redis服务器"></a>2、启动三台redis服务器</h4><img src="/2020/11/21/Redis/image-20210810152048413.png" alt="image-20210810152048413" style="zoom:150%;">





<blockquote>
<p>  <strong>查看系统进程，看看三台服务器是否启动</strong></p>
</blockquote>
<img src="/2020/11/21/Redis/image-20210810152122261.png" alt="image-20210810152122261" style="zoom:150%;">





<h4 id="3、查看三台主机运行情况"><a href="#3、查看三台主机运行情况" class="headerlink" title="3、查看三台主机运行情况"></a>3、查看三台主机运行情况</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">打印主从复制的相关信息</span></span><br><span class="line">info replication	</span><br></pre></td></tr></table></figure>

<img src="/2020/11/21/Redis/image-20210810152243500.png" alt="image-20210810152243500" style="zoom:150%;">

 



<h4 id="4、配从-库-不配主-库"><a href="#4、配从-库-不配主-库" class="headerlink" title="4、配从(库)不配主(库)"></a>4、配从(库)不配主(库)</h4><ul>
<li>  主库使用默认的 6379 端口号，使用默认的配置信息即可；</li>
<li>  主要修改从库的端口号及配置信息；</li>
<li>  当然如果你非要改主库的配置信息也可以。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">成为某个实例的从服务器</span></span><br><span class="line">slaveof &lt;ip&gt; &lt;port&gt;</span><br><span class="line"></span><br><span class="line">SLAVEOF 127.0.0.1 6379</span><br></pre></td></tr></table></figure>

<ol>
<li><p>在 6380 和 6381 上执行: <code>slaveof 127.0.0.1 6379</code>，成为 6379 的备机。</p>
 <img src="/2020/11/21/Redis/image-20210810152453011.png" alt="image-20210810152453011" style="zoom: 150%;"></li>
<li><p><strong>在主机上写，从机上可以读取数据；[在从机上写数据报错]</strong></p>
 <img src="/2020/11/21/Redis/image-20210810152631660.png" alt="image-20210810152631660" style="zoom:150%;"></li>
<li><p><strong>主机挂掉，重启就行，一切如初；</strong></p>
<blockquote>
<p>  <strong>注解：</strong>主机宕机后，两个从机不会顶替主机称为新的 Master，而是依然安心当一个 Slave。当原来的 Master 重新启动后，依然会是这两台服务器的主机。</p>
</blockquote>
</li>
<li><p>从机重启后需重设：<code>slaveof 127.0.0.1 6379</code></p>
<blockquote>
<p>  <strong>注解：</strong>从机宕机后重启，默认情况下不会自动称为某个 Master 的备机，必须重新调用 <code>Slaveof</code> 命令才能让其成为某台 Master 的 Slave。但是可以将这条命令增加到配置文件中，从机启动时会加载配置文件，这样就可以实现从机启动后直接自动绑定某一台 Master。</p>
<p>  <img src="/2020/11/21/Redis/image-20210810153112350.png" alt="image-20210810153112350"></p>
</blockquote>
</li>
</ol>
<hr>
<h2 id="常用3招（常用的配置策略）"><a href="#常用3招（常用的配置策略）" class="headerlink" title="常用3招（常用的配置策略）"></a>常用3招（常用的配置策略）</h2><blockquote>
<ul>
<li>  一主二仆</li>
<li>  薪火相传</li>
<li>  反客为主</li>
</ul>
</blockquote>
<h3 id="一主二仆"><a href="#一主二仆" class="headerlink" title="一主二仆"></a>一主二仆</h3><ul>
<li>  一主二仆就是上文中演示的一个 Master 两个 Slave 的形态。</li>
</ul>
<img src="/2020/11/21/Redis/image-20210810153916067.png" alt="image-20210810153916067" style="zoom:150%;">

<hr>
<h3 id="薪火相传"><a href="#薪火相传" class="headerlink" title="薪火相传"></a>薪火相传</h3><img src="/2020/11/21/Redis/image-20210810153935273.png" alt="image-20210810153935273" style="zoom:150%;">

<blockquote>
<p>  <strong>为什么有？</strong></p>
</blockquote>
<p>如果一个 Redis 集群中只有一台 Master，那么每次 Master 中的数据发生变化时，其余所有的 Slave 都需要从这台 Master 中备份数据，假设有 100 台甚至更多台的 Slave 存在，Master 可能就会因为承受不了这么大的流量而宕机。为了解决这种问题，我们可以采用“薪火相传”的策略。</p>
<blockquote>
<p>  <strong>是什么？</strong></p>
</blockquote>
<p>“薪火相传”的策略就是：上一个 Slave 可以是下一个 Slave 的 Master ，Slave 同样可以接受其它 Slaves 的连接和同步请求，那么该 Slave 作为链条中一个的 Master，可以有效减轻 Master  的压力。</p>
<blockquote>
<p>  <strong>注意：</strong></p>
</blockquote>
<ul>
<li><p>  <strong>中间机器的角色仍然是一个 Slave ，但是它可以有自己的 Slave。</strong></p>
</li>
<li><p>  中间机器的 Slave 虽然可以承担了部分 Master 的功能，但是并不能进行数据的写操作。</p>
</li>
<li><p>  Master 挂了，Slave 还是从机，无法写数据了。</p>
</li>
<li><p>中途变更转向：会清除之前的数据，重新建立拷贝最新的。</p>
<blockquote>
<p>  注解：假设 6381 一开始的 Master 是 6379，中途使用 <code>slaveof 127.0.0.1 6380</code> 将 Master 变更为 6380，那么这是需要先清除掉从 6379 中得到的数据，重新拉取 6380 中最新的数据。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>  <strong>缺点：</strong></p>
</blockquote>
<ol>
<li> <strong>数据失真</strong>。数据传递的过程中可能会发生数据丢失，传递的次数越多，数据丢失的概率就越大。最严重的情况是：一旦某个 slave 宕机，后面的 slave 都无法备份。</li>
<li> <strong>传输延时</strong>。由于数据是链式的逐个向后备份，所以存在较严重的数据延时。</li>
</ol>
<blockquote>
<p>  <strong>使用方法：</strong></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Slaveof 新主库IP 新主库端口</span></span><br><span class="line">Slaveof &lt;ip&gt; &lt;port&gt;</span><br><span class="line"></span><br><span class="line">slaveof 127.0.0.1 6380</span><br></pre></td></tr></table></figure>

<img src="/2020/11/21/Redis/image-20210810154249590.png" alt="image-20210810154249590" style="zoom: 200%;">







<h3 id="反客为主"><a href="#反客为主" class="headerlink" title="反客为主"></a>反客为主</h3><blockquote>
<p>  <strong>是什么？</strong></p>
</blockquote>
<ul>
<li>主机宕机后，从机上位</li>
<li>当一个 Master 宕机后，后面的 Slave 可以立刻升为 Master，其后面的 Slave 不用做任何修改。</li>
<li>从机上位：Slaveof no one</li>
<li>另外的从机有两种选择：<ol>
<li> 另外的从机改换门庭：<code>Slaveof 127.0.0.1 6380</code></li>
<li> 另外的从机忠贞不屈：死等</li>
</ol>
</li>
</ul>
<blockquote>
<p>  <strong>怎么用？</strong></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">让当前从机变为主机</span></span><br><span class="line">Slaveof no one </span><br></pre></td></tr></table></figure>

<img src="/2020/11/21/Redis/image-20210810155315761.png" alt="image-20210810155315761" style="zoom:150%;">







<hr>
<h2 id="复制原理"><a href="#复制原理" class="headerlink" title="复制原理"></a>复制原理</h2><blockquote>
<ul>
<li>  <strong>全量复制</strong></li>
<li>  <strong>增量复制</strong></li>
</ul>
</blockquote>
<ol>
<li> Slave 在连接到 Master 后首先会发送一个同步（sync）命令；</li>
<li> Master 接到命令后，启动后台的存盘进程，同时收集所有接收到的修改数据的命令，在后台进程执行完毕之后，Master 将传送整个数据文件到 Slave，完成一次<strong>完全同步</strong>。</li>
<li> <strong>全量复制</strong>：Slave 在接收到数据库文件数据后，将其存盘并加载到内存中。</li>
<li> <strong>增量复制</strong>：Master 继续将新的所有收集到的命令依次传递给 Slave ，完成同步</li>
<li> 但是只要是重新连接 Master，一次完全同步（全量复制）将被自动执行。</li>
</ol>
<p><strong>总结：</strong></p>
<ul>
<li>  Slave 启动时，必先进行一次全量复制；</li>
<li>  在 Slave 启动期间，Master 中的数据发生变化时，Slave 只需要进行增量复制即可。</li>
</ul>
<img src="/2020/11/21/Redis/image-20210810160117746.png" alt="image-20210810160117746" style="zoom:150%;">





<h2 id="哨兵模式（sentinel）"><a href="#哨兵模式（sentinel）" class="headerlink" title="哨兵模式（sentinel）"></a>哨兵模式（sentinel）</h2><h3 id="是什么-3"><a href="#是什么-3" class="headerlink" title="是什么"></a>是什么</h3><ul>
<li>  <strong>反客为主的自动版</strong>。</li>
<li>  能够在后台监控 Master 是否故障，如果出现故障了所有 Slave 进行投票，根据票选结果自动将从机转换为新的主机。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置从机的优先级，值越小，优先级越高，用于选举主机时使用。默认100</span></span><br><span class="line">slave-priority 10</span><br></pre></td></tr></table></figure>

<img src="/2020/11/21/Redis/image-20210810160314929.png" alt="image-20210810160314929" style="zoom:150%;">





<h3 id="怎么用-1"><a href="#怎么用-1" class="headerlink" title="怎么用"></a>怎么用</h3><blockquote>
<ol>
<li> 初始化结构：一主二仆，6379 带着 6380、6381</li>
</ol>
</blockquote>
<img src="/2020/11/21/Redis/image-20210810160420195.png" alt="image-20210810160420195" style="zoom:150%;">



<blockquote>
<ol start="2">
<li> 自定义的配置文件 <code>/myredis</code>目录下新建 <strong>sentinel.conf</strong> 文件。名字绝不能错。配置文件内容。</li>
</ol>
</blockquote>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 其中mymaster是为监控对象起的服务器名称； 1 表示至少有多少个哨兵同意迁移的数量。</span></span><br><span class="line">sentinel monitor mymaster <span class="number">127.0</span>.<span class="number">0.1</span> <span class="number">6379</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>



<blockquote>
<ol start="3">
<li> 启动哨兵</li>
</ol>
</blockquote>
<ul>
<li>  执行 <code>redis-sentinel /myredis/sentinel.conf</code></li>
</ul>
<img src="/2020/11/21/Redis/image-20210810160748119.png" alt="image-20210810160748119" style="zoom: 150%;">



<blockquote>
<ol start="4">
<li> 当主机挂掉后，会从备机选举中产生新的主机。</li>
</ol>
</blockquote>
<blockquote>
<ol start="5">
<li> 原主机重启后会自动变为从机。</li>
</ol>
</blockquote>
<img src="/2020/11/21/Redis/image-20210810161028961.png" alt="image-20210810161028961" style="zoom:150%;">



<p><strong>注意</strong></p>
<ul>
<li>  一组 Sentinel 能同时监控多个 Master</li>
</ul>
<h2 id="复制的缺点"><a href="#复制的缺点" class="headerlink" title="复制的缺点"></a>复制的缺点</h2><blockquote>
<p>  <strong>复制延时</strong></p>
</blockquote>
<p>由于写操作都是在 Master 上操作，然后同步更新到 Slave 上，所以从 Master 同步到 Slave 机器有一定的延迟，当系统很繁忙的时候，延迟问题会更加严重，Slave 机器数量的增加也会使这个问题更加严重</p>
<h1 id="Redis-缓存"><a href="#Redis-缓存" class="headerlink" title="Redis 缓存"></a>Redis 缓存</h1><h2 id="1-Redis-过期键的删除策略"><a href="#1-Redis-过期键的删除策略" class="headerlink" title="1    Redis 过期键的删除策略"></a>1    Redis 过期键的删除策略</h2><h3 id="1-1-惰性删除"><a href="#1-1-惰性删除" class="headerlink" title="1.1    惰性删除"></a>1.1    惰性删除</h3><p><strong>是什么：</strong></p>
<ul>
<li>  惰性删除不会主动去删除 Redis 中的数据，而是在有请求访问数据的时候，再检查当前键值是否过期，如果过期则执行删除并返回 null 给客户端，如果没有过期则返回正常信息给客户端。</li>
<li>  也就是说，设置完某个 key 的过期时间后，我们不去管它，当需要该 key 时，我们在检查其是否过期，如果过期，我们就删掉它，反之正常返回该 key。</li>
</ul>
<p><strong>优点：</strong></p>
<ul>
<li>  对 CPU 友好，我们只会在使用该键时才会进行过期检查，对于很多用不到的 key 不用浪费 CPU 时间片进行过期检查。</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>  对内存不友好，如果一个键已经过期，但是一直没有使用，那么该键就会一直存在内存中，如果数据库中有很多这种使用不到的过期键，这些键便永远不会被删除，内存永远不会释放。从而造成内存泄漏。</li>
</ul>
<h3 id="1-2-定期删除"><a href="#1-2-定期删除" class="headerlink" title="1.2    定期删除"></a>1.2    定期删除</h3><p><strong>是什么：</strong></p>
<p>每隔一段时间 Redis 就会随机对一批设置了过期时间的 key 进行检查，并删除里面已过期的 key。</p>
<p><strong>优点：</strong></p>
<ul>
<li>  定期删除，能有效释放过期键占用的内存。</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>  难以确定删除操作执行的频率，如果执行的太频繁，定期删除策略变得和定时删除策略一样，对CPU不友好。如果执行的太少，那又和惰性删除一样了，对内存不友好。</li>
<li>  另外最重要的是，在获取某个键时，如果某个键的过期时间已经到了，但是还没执行定期删除，那么就会返回这个键的值，直接导致业务错误。</li>
</ul>
<h3 id="1-3-定时删除"><a href="#1-3-定时删除" class="headerlink" title="1.3    定时删除"></a>1.3    定时删除</h3><p><strong>是什么：</strong></p>
<p>在设置某个 key 的过期时间同时，我们创建一个定时器，让定时器在该过期时间到来时，立即执行对其进行删除的操作。</p>
<p><strong>优点：</strong></p>
<ul>
<li>  定时删除对内存是最友好的，能够保存内存中的 key 一旦过期就能立即从内存中删除。</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>  对 CPU 最不友好，在过期键比较多的时候，删除过期键会占用一部分 CPU 时间，对服务器的响应时间和吞吐量造成影响。</li>
</ul>
<h2 id="2-Redis-内存淘汰策略"><a href="#2-Redis-内存淘汰策略" class="headerlink" title="2    Redis 内存淘汰策略"></a>2    Redis 内存淘汰策略</h2><p><strong>是什么：</strong></p>
<p>虽然 Redis 会不断地删除一些过期的数据，但是在 Redis 中还有很多数据没有设置过期时间，对于这些数据，在 Redis 内存足够时不会执行回收处理，但是一旦当 Redis 内存不够用的时候，就会触发内存淘汰策略来进行回收。<br>所谓的 Redis 内存淘汰策略，就是指当 Redis 的内存超过最大允许的内存之后，Redis 会触发内存淘汰策略，删除一些不常用的数据，以保证 Redis 服务器能正常运行。</p>
<p><strong>常见的内存淘汰策略：</strong>【3类8种】</p>
<blockquote>
<p>  <strong>禁止内存淘汰</strong></p>
</blockquote>
<ol>
<li> <code>no-eviction</code>：禁止驱逐数据，也就是说当内存不足以容纳新写入数据时，新写入操作会报错。</li>
</ol>
<blockquote>
<p>  <strong>对设置了过期时间的 key 进行回收</strong></p>
</blockquote>
<ol start="2">
<li> <code>volatile-lru</code>：LRU（Least Recently Used），删除最近使用最少的 key。利用 LRU 算法移除设置过过期时间的 key。 </li>
<li> <code>volatile-lfu</code>：LFU（Least Frequently Used），删除从 Redis 启动到当前时间使用最少的 key。从已设置过期时间的数据集中挑选最不经常使用的数据淘汰。</li>
<li> <code>volatile-ttl</code>：从已设置过期时间的数据集中挑选将要过期的数据进行淘汰。</li>
<li> <code>volatile-random</code>：从已设置过期时间的数据集中任意选择数据淘汰</li>
</ol>
<blockquote>
<p>  <strong>对所有key进行回收</strong></p>
</blockquote>
<ol start="6">
<li> <code>allkeys-lru</code>：在键空间中，移除最近最少使用的 key.</li>
<li> <code>allkeys-lfu</code>：在键空间中，移除最不经常使用的 key。</li>
<li> <code>allkeys-random</code>：从数据集中任意选择数据淘汰。</li>
</ol>
<p>内存淘汰策略可以通过配置文件来修改，<code>Redis.conf</code> 对应的配置项是 <code>maxmemory-policy</code>，修改对应的值就行，默认是 <code>noeviction</code>。</p>
<h1 id="8-Redis的应用场景"><a href="#8-Redis的应用场景" class="headerlink" title="8    Redis的应用场景"></a>8    Redis的应用场景</h1><blockquote>
<ul>
<li>缓存（数据查询、短连接、新闻内容、商品内容等等）</li>
<li>聊天室的在线好友列表</li>
<li>任务队列。（秒杀、抢购、12306等等）</li>
<li>应用排行榜</li>
<li>网站访问统计</li>
<li>数据过期处理（可以精确到毫秒）</li>
<li>分布式集群架构中的session分离</li>
</ul>
</blockquote>
<hr>
<h1 id="Jedis"><a href="#Jedis" class="headerlink" title="Jedis"></a>Jedis</h1><blockquote>
<p><strong>Jedis</strong>：一款通过Java客户端操作Redis数据库的客户端工具。</p>
</blockquote>
<h2 id="1-Jedis-入门"><a href="#1-Jedis-入门" class="headerlink" title="1    Jedis 入门"></a>1    Jedis 入门</h2><ol>
<li><p>初始化项目并导入 Jedis 依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>在代码中使用 <strong>Jdeis API</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、创建Redis的客户端连接对象并绑定Redis服务器的地址（如果使用无参构造器初始化，则Redis服务器地址的缺省值是：&quot;localhost&quot;,6379）</span></span><br><span class="line"><span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);	 </span><br><span class="line"><span class="comment">// 2. 具体操作</span></span><br><span class="line">jedis.set(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line"><span class="comment">// 3. 关闭客户端与服务器的连接</span></span><br><span class="line">jedis.close();</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p><strong><code>Jedis类</code>常用的构造函数</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>public Jedis()</code></td>
<td align="center">创建Jedis实例对象，并连接到地址为<code>&quot;127.0.0.1&quot;, 6379</code>的服务器上</td>
</tr>
<tr>
<td align="center"><code>public Jedis(String host, int port)</code></td>
<td align="center">创建Jedis实例对象，并指定Redis服务器的地址</td>
</tr>
</tbody></table>
<hr>
<h2 id="2-Jedis-操作-Redis-常用的-API"><a href="#2-Jedis-操作-Redis-常用的-API" class="headerlink" title="2    Jedis 操作 Redis 常用的 API"></a>2    Jedis 操作 Redis 常用的 API</h2><blockquote>
<p>在上面的demo中，创建客户端连接对象<code>Jdeis</code> 和 关闭<code>Jdeis</code>客户端与<code>Redis</code>服务器之间的连接是两个固定操作，真正操作 Redis 数据库的步骤是第2步的具体操作，我们常用的 API 如下：</p>
</blockquote>
<p>首先，我们将获取 Jedis 客户端对象 和 释放连接 的操作提取出来！</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1、建立与 Redis 服务器的连接并获得客户端对象Jedis</span></span><br><span class="line"><span class="meta">@Before</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Jedis</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3、关闭与Redis服务器之间的连接</span></span><br><span class="line"><span class="meta">@After</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">destroy</span><span class="params">()</span>&#123;</span><br><span class="line">    jedis.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="2-1-字符串类型（String）"><a href="#2-1-字符串类型（String）" class="headerlink" title="2.1    字符串类型（String）"></a>2.1    字符串类型（String）</h3><ol>
<li>存储：<code>set key value</code></li>
<li>获取：<code>get key</code></li>
<li>删除：<code>del key</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2、操作String</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test01</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// 存储</span></span><br><span class="line">    jedis.set(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> jedis.get(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    System.out.println(username);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 普通删除</span></span><br><span class="line">    jedis.del(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 定时删除。使用setex()方法存储可以指定过期时间。</span></span><br><span class="line">    <span class="comment">// 将&#123;activecode：6380&#125;键值对存入redis，并且20秒后自动删除该键值对</span></span><br><span class="line">    jedis.setex(<span class="string">&quot;activecode&quot;</span>,<span class="number">20</span>,<span class="string">&quot;6380&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="2-2-哈希类型（Hash）"><a href="#2-2-哈希类型（Hash）" class="headerlink" title="2.2    哈希类型（Hash）"></a>2.2    哈希类型（Hash）</h3><ol>
<li><p>存储：<code>hset key field value</code></p>
</li>
<li><p>获取：</p>
<ul>
<li><p>获取指定field对应的值：<code>hget key field</code></p>
</li>
<li><p>获取所有的filed和value：<code>hgetall key</code></p>
</li>
</ul>
</li>
<li><p>删除：<code>hdel key field</code></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2、操作Hash</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test02</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// 存储hash</span></span><br><span class="line">    jedis.hset(<span class="string">&quot;person&quot;</span>,<span class="string">&quot;name&quot;</span>,<span class="string">&quot;wangyi&quot;</span>);</span><br><span class="line">    jedis.hset(<span class="string">&quot;person&quot;</span>,<span class="string">&quot;gender&quot;</span>,<span class="string">&quot;male&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取hash</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> jedis.hget(<span class="string">&quot;person&quot;</span>, <span class="string">&quot;name&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取hash的所有map中的数据</span></span><br><span class="line">	Map&lt;String, String&gt; user = jedis.hgetAll(<span class="string">&quot;person&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="2-3-列表类型（List）"><a href="#2-3-列表类型（List）" class="headerlink" title="2.3    列表类型（List）"></a>2.3    列表类型（List）</h3><ol>
<li><p>添加：可以添加一个元素到列表的头部（左边）或尾部（右边）</p>
<ul>
<li><code>lpush key value</code>：将元素加入列表左边</li>
<li><code>rpush key value</code>：将元素加入列表右边</li>
</ul>
</li>
<li><p>获取：<code>lrange key start end</code>，根据范围获取。<code>0 -1</code>表示获取全部元素。</p>
</li>
<li><p>删除：</p>
<ul>
<li><code>lpop key</code>：删除列表最左边的元素，并将元素返回</li>
<li><code>rpop key</code>：删除列表最右边的元素，并将元素返回</li>
</ul>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2、操作List</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// list 存储</span></span><br><span class="line">    jedis.lpush(<span class="string">&quot;mylist&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>);	<span class="comment">//从左边存</span></span><br><span class="line">    jedis.rpush(<span class="string">&quot;mylist&quot;</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>);	<span class="comment">//从右边存</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// list 范围获取</span></span><br><span class="line">    List&lt;String&gt; mylist = jedis.lrange(<span class="string">&quot;mylist&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// list 弹出</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">element1</span> <span class="operator">=</span> jedis.lpop(<span class="string">&quot;mylist&quot;</span>);	<span class="comment">//c</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">element2</span> <span class="operator">=</span> jedis.rpop(<span class="string">&quot;mylist&quot;</span>);	<span class="comment">//c</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// list 范围获取</span></span><br><span class="line">    List&lt;String&gt; mylist2 = jedis.lrange(<span class="string">&quot;mylist&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="2-4-集合类型（Set）"><a href="#2-4-集合类型（Set）" class="headerlink" title="2.4    集合类型（Set）"></a>2.4    集合类型（Set）</h3><ol>
<li>存储：<code>sadd key value</code></li>
<li>获取集合中的所有元素：<code>smembers key</code></li>
<li>删除集合中的某个元素：<code>srem key value</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2、操作Set</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set 存储</span></span><br><span class="line">    jedis.sadd(<span class="string">&quot;myset&quot;</span>,<span class="string">&quot;java&quot;</span>,<span class="string">&quot;php&quot;</span>,<span class="string">&quot;c++&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// set 获取</span></span><br><span class="line">    Set&lt;String&gt; myset = jedis.smembers(<span class="string">&quot;myset&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="2-5-有序集合类型（SortedSet）"><a href="#2-5-有序集合类型（SortedSet）" class="headerlink" title="2.5    有序集合类型（SortedSet）"></a>2.5    有序集合类型（SortedSet）</h3><ol>
<li>存储：<code>zadd key score value</code></li>
<li>获取：<ul>
<li><code>zrange key start</code>：按<code>分数（score）</code>从小到大的顺序获取<code>value</code></li>
<li><code>zrange key start end withscores</code>：按<code>分数（score）</code>从小到大的顺序获取<code>value</code>和<code>score</code></li>
</ul>
</li>
<li>删除：<code>zrem key value</code></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2、操作SortedSet</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sortedset 存储</span></span><br><span class="line">    jedis.zadd(<span class="string">&quot;mysortedset&quot;</span>,<span class="number">23</span>,<span class="string">&quot;詹姆斯&quot;</span>);</span><br><span class="line">    jedis.zadd(<span class="string">&quot;mysortedset&quot;</span>,<span class="number">07</span>,<span class="string">&quot;甜瓜&quot;</span>);</span><br><span class="line">    jedis.zadd(<span class="string">&quot;mysortedset&quot;</span>,<span class="number">77</span>,<span class="string">&quot;东契奇&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// sortedset 获取</span></span><br><span class="line">    Set&lt;String&gt; mysortedset = jedis.zrange(<span class="string">&quot;mysortedset&quot;</span>, <span class="number">0</span>, -<span class="number">1</span>);</span><br><span class="line">    System.out.println(mysortedset);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<hr>
<h2 id="3-Jedis-连接池"><a href="#3-Jedis-连接池" class="headerlink" title="3    Jedis 连接池"></a>3    Jedis 连接池</h2><p>Jedis 依赖中有一个 Jdeis 的数据库连接池对象的类 <code>JedisPool</code>，我们可以直接创建对象使用。</p>
<blockquote>
<p>  <code>JedisPool</code> 类常用的构造函数</p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">构造方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>JedisPool()</code></td>
<td align="left">使用默认的服务器地址、端口号和配置信息创建JedisPool实例对象。</td>
</tr>
<tr>
<td align="left"><code>JedisPool(JedisPoolConfig config, String host, int port)</code></td>
<td align="left">创建JedisPool实例对象，并手动指定的服务器地址、端口号和配置信息。</td>
</tr>
</tbody></table>
<ul>
<li>  配置信息保存在<code>JedisPoolConfig接口</code>的实现类中。</li>
</ul>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><blockquote>
<ol>
<li>创建JedisPoolConfig配置类对象。[可选，不设置时使用默认配置信息]</li>
<li>创建JedisPool连接池对象</li>
<li>调用方法 getResource()方法获取Jedis连接</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">//1.创建一个配置对象</span></span><br><span class="line">    <span class="type">JedisPoolConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class="line">    config.setMaxTotal(<span class="number">50</span>);</span><br><span class="line">    config.setMaxIdle(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.创建Jedis连接池对象</span></span><br><span class="line">    <span class="type">JedisPool</span> <span class="variable">jedisPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPool</span>(config,<span class="string">&quot;localhost&quot;</span>,<span class="number">6379</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.获取连接</span></span><br><span class="line">    <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> jedisPool.getResource();</span><br><span class="line">    <span class="comment">//4. 使用</span></span><br><span class="line">    jedis.set(<span class="string">&quot;hehe&quot;</span>,<span class="string">&quot;heihei&quot;</span>);</span><br><span class="line">    <span class="comment">//5. 关闭 归还到连接池中</span></span><br><span class="line">    jedis.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="代码优化"><a href="#代码优化" class="headerlink" title="代码优化"></a>代码优化</h3><blockquote>
<ul>
<li>将配置信息保存在外部配置文件中</li>
<li>创建一个工具类封装重复操作的代码块</li>
</ul>
</blockquote>
<ol>
<li><p>创建<code>jedis.properties</code>文件保存配置信息</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">host</span>=<span class="string">127.0.0.1</span></span><br><span class="line"><span class="attr">port</span>=<span class="string">6379</span></span><br><span class="line"><span class="attr">maxTotal</span>=<span class="string">50</span></span><br><span class="line"><span class="attr">maxIdle</span>=<span class="string">10</span></span><br></pre></td></tr></table></figure></li>
<li><p>在<code>src/main/java/utils</code>包下创建一个<code>JedisPoolUtil类</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JedisPoolUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> JedisPool jedisPool;</span><br><span class="line">    <span class="comment">// 静态代码块</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// 1、读取配置文件，并将配置文件输入流加载到Properties对象中</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> JedisPoolUtil.class.getClassLoader().getResourceAsStream(<span class="string">&quot;jedis.properties&quot;</span>);</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            properties.load(inputStream);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2、将配置文件信息加载到内存中，并转换为对应的数据类型</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> (String) properties.get(<span class="string">&quot;host&quot;</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> Integer.parseInt((String) properties.get(<span class="string">&quot;port&quot;</span>));</span><br><span class="line">        <span class="type">int</span> <span class="variable">maxTotal</span> <span class="operator">=</span> Integer.parseInt((String) properties.get(<span class="string">&quot;maxTotal&quot;</span>));</span><br><span class="line">        <span class="type">int</span> <span class="variable">maxIdle</span> <span class="operator">=</span> Integer.parseInt((String) properties.get(<span class="string">&quot;maxIdle&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3、初始化JedisPoolConfig对象</span></span><br><span class="line">        <span class="type">JedisPoolConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JedisPoolConfig</span>();</span><br><span class="line">        config.setMaxIdle(maxIdle);</span><br><span class="line">        config.setMaxTotal(maxTotal);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4、初始化JedisPool对象</span></span><br><span class="line">        jedisPool = <span class="keyword">new</span> <span class="title class_">JedisPool</span>(config, host, port);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    	工具类中的静态方法，作用是：获取Jedis对象</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Jedis <span class="title function_">getJedis</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> jedisPool.getResource();</span><br><span class="line">        <span class="keyword">return</span> jedis;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JedisPoolTest</span> &#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">		<span class="comment">// 1、获取Jedis连接对象 </span></span><br><span class="line">        <span class="type">Jedis</span> <span class="variable">jedis</span> <span class="operator">=</span> JedisConfig.getJedis();</span><br><span class="line">		<span class="comment">// 2、使用</span></span><br><span class="line">        jedis.set(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;wumeng&quot;</span>);</span><br><span class="line">        <span class="comment">// 3、归还到连接池中</span></span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="Redis中常见的配置信息"><a href="#Redis中常见的配置信息" class="headerlink" title="Redis中常见的配置信息"></a>Redis中常见的配置信息</h3><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#最大活动对象数     </span></span><br><span class="line"><span class="attr">redis.pool.maxTotal</span>=<span class="string">1000    </span></span><br><span class="line"><span class="comment">#最大能够保持idel状态的对象数      </span></span><br><span class="line"><span class="attr">redis.pool.maxIdle</span>=<span class="string">100  </span></span><br><span class="line"><span class="comment">#最小能够保持idel状态的对象数   </span></span><br><span class="line"><span class="attr">redis.pool.minIdle</span>=<span class="string">50    </span></span><br><span class="line"><span class="comment">#当池内没有返回对象时，最大等待时间    </span></span><br><span class="line"><span class="attr">redis.pool.maxWaitMillis</span>=<span class="string">10000    </span></span><br><span class="line"><span class="comment">#当调用borrow Object方法时，是否进行有效性检查    </span></span><br><span class="line"><span class="attr">redis.pool.testOnBorrow</span>=<span class="string">true    </span></span><br><span class="line"><span class="comment">#当调用return Object方法时，是否进行有效性检查    </span></span><br><span class="line"><span class="attr">redis.pool.testOnReturn</span>=<span class="string">true  </span></span><br><span class="line"><span class="comment">#“空闲链接”检测线程，检测的周期，毫秒数。如果为负值，表示不运行“检测线程”。默认为-1.  </span></span><br><span class="line"><span class="attr">redis.pool.timeBetweenEvictionRunsMillis</span>=<span class="string">30000  </span></span><br><span class="line"><span class="comment">#向调用者输出“链接”对象时，是否检测它的空闲超时；  </span></span><br><span class="line"><span class="attr">redis.pool.testWhileIdle</span>=<span class="string">true  </span></span><br><span class="line"><span class="comment"># 对于“空闲链接”检测线程而言，每次检测的链接资源的个数。默认为3.  </span></span><br><span class="line"><span class="attr">redis.pool.numTestsPerEvictionRun</span>=<span class="string">50  </span></span><br><span class="line"><span class="comment">#redis服务器的IP    </span></span><br><span class="line"><span class="attr">redis.ip</span>=<span class="string">xxxxxx  </span></span><br><span class="line"><span class="comment">#redis服务器的Port    </span></span><br><span class="line"><span class="attr">redis1.port</span>=<span class="string">6379   </span></span><br></pre></td></tr></table></figure>







<hr>
<h1 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">案例需求：</span><br><span class="line">	1. 提供index.html页面，页面中有一个省份 下拉列表</span><br><span class="line">	2. 当 页面加载完成后 发送ajax请求，加载所有省份</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 注意：使用redis缓存一些不经常发生变化的数据。</span><br><span class="line">	* 数据库的数据一旦发生改变，则需要更新缓存。</span><br><span class="line">		* 数据库的表执行 增删改的相关操作，需要将redis缓存数据情况，再次存入</span><br><span class="line">		* 在service对应的增删改方法中，将redis数据删除。</span><br></pre></td></tr></table></figure>





<hr>
<h1 id="SpringBoot-整合-Redis"><a href="#SpringBoot-整合-Redis" class="headerlink" title="SpringBoot 整合 Redis"></a>SpringBoot 整合 Redis</h1><ul>
<li>  超链接：<a target="_blank" rel="noopener" href="https://lvnengdong.github.io/2021/03/27/SpringBoot%E4%B8%8E%E7%BC%93%E5%AD%98/">https://lvnengdong.github.io/2021/03/27/SpringBoot%E4%B8%8E%E7%BC%93%E5%AD%98/</a></li>
</ul>
<h1 id="面试题"><a href="#面试题" class="headerlink" title="面试题"></a>面试题</h1><h2 id="Redis-传统五大数据类型的落地应用"><a href="#Redis-传统五大数据类型的落地应用" class="headerlink" title="Redis 传统五大数据类型的落地应用"></a>Redis 传统五大数据类型的落地应用</h2><p>除了上述5大数据类型，你还知道哪些 Redis 类型？（8 大数据类型）</p>
<blockquote>
<ol>
<li> String</li>
<li> Hash</li>
<li> Set</li>
<li> SortedSet</li>
<li> List</li>
<li> bitmap（位图）</li>
<li> HyperLogLog（统计）</li>
<li> GEO（地理）</li>
<li> ……</li>
</ol>
</blockquote>
<h2 id="分布式锁？Redis-分布式锁"><a href="#分布式锁？Redis-分布式锁" class="headerlink" title="分布式锁？Redis 分布式锁"></a>分布式锁？Redis 分布式锁</h2><h2 id="Redis-缓存过期淘汰策略"><a href="#Redis-缓存过期淘汰策略" class="headerlink" title="Redis 缓存过期淘汰策略"></a>Redis 缓存过期淘汰策略</h2><h2 id="Redis-的-LRU-算法"><a href="#Redis-的-LRU-算法" class="headerlink" title="Redis 的 LRU 算法"></a>Redis 的 LRU 算法</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/20/Maven/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/20/Maven/" class="post-title-link" itemprop="url">Maven</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-20 09:49:19" itemprop="dateCreated datePublished" datetime="2020-11-20T09:49:19+08:00">2020-11-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-04-08 09:54:48" itemprop="dateModified" datetime="2022-04-08T09:54:48+08:00">2022-04-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Maven/" itemprop="url" rel="index"><span itemprop="name">Maven</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="第1章-Maven介绍"><a href="#第1章-Maven介绍" class="headerlink" title="第1章 Maven介绍"></a>第1章 Maven介绍</h1><blockquote>
<p>  maven：内行，专家</p>
</blockquote>
<h2 id="是什么？"><a href="#是什么？" class="headerlink" title="是什么？"></a>是什么？</h2><p>Maven是一个<strong>项目管理工具</strong>，它包含了：</p>
<blockquote>
<ul>
<li>一个项目对象模型（POM：Project Object Model），</li>
<li>一组标准集合，</li>
<li>一个项目的生命周期（Project Lifecycle），</li>
<li>一个依赖管理系统（Dependency Management System）</li>
<li>和用来运行定义在生命周期阶段（phase）中插件（plugin）目标（goal）的逻辑。</li>
</ul>
</blockquote>
<h2 id="Maven能解决什么问题？"><a href="#Maven能解决什么问题？" class="headerlink" title="Maven能解决什么问题？"></a>Maven能解决什么问题？</h2><h3 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h3><ol>
<li>我们在写java代码的时候经常需要引入各种jar包，尤其是较大的工程，引用的jar包往往有几十上百个。每用到一种jar包，都需要手动引入工程目录，每新建一个工程，都需要重新引入一次jar包。而且经常会遇到各种版本冲突的jar包等。非常麻烦。</li>
<li>如果在一个非集成工作环境中编写java代码，计算机是无法自动编译我们编写的<code>.java</code>文件的，必须要手动将其编译为二进制字节码文件<code>.class</code>文件后才可以在电脑上执行，非常麻烦。</li>
<li>在日常改bug中，我们一般会使用单元测试模块，但是非常麻烦的是，我们需要对每个类/方法添加<code>@Test</code>注解，逐一测试这些代码。</li>
<li>当我们完成了代码的开发之后，还需要把代码和相关的配置文件、资源等糅合到一起，打包、发布。非常麻烦</li>
</ol>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ul>
<li>但是，Maven的出现，可以极大程度的简化上面提到的操作。</li>
<li>Maven可以帮助我们构建工程、管理jar包、编译代码、自动运行单元测试、打包、生成报表，甚至能帮你部署项目，生成web站点。</li>
</ul>
<h3 id="Maven的优势举例"><a href="#Maven的优势举例" class="headerlink" title="Maven的优势举例"></a>Maven的优势举例</h3><p>我们已经知道运行一个Web项目就必须把该项目所依赖的一些jar包添加到工程中，否则项目就不能运行。试想一下如果具有相同架构的项目有10个，我们就必须将这一份jar包复制到这10个不同的工程中。我们来看一下一个CRM项目的工程大小。</p>
<ol>
<li><p>使用传统Web项目构建的CRM项目内存大小如下：</p>
<p><img src="/2020/11/20/Maven/image-20200604140446259.png" alt="image-20200604140446259"></p>
<p>其中绝大部分内存是我们把运行Web项目所需要的jar包复制到工程中占用的内存，因此导致了工程很大。</p>
</li>
<li><p>同样的项目，我们使用Maven工程来构建，会发现工程所占的内存会小很多。</p>
<p><img src="/2020/11/20/Maven/image-20200604140829418.png" alt="image-20200604140829418"></p>
</li>
<li><p>小结：可以推断出Maven构建的这个工程内部是没有jar包的。那么，没有jar包的项目是如何运行的呢？</p>
</li>
</ol>
<h2 id="Maven的两个经典作用"><a href="#Maven的两个经典作用" class="headerlink" title="Maven的两个经典作用"></a>Maven的两个经典作用</h2><blockquote>
<ul>
<li>Maven的依赖管理</li>
<li>项目的一键构建</li>
</ul>
</blockquote>
<h3 id="Maven的依赖管理"><a href="#Maven的依赖管理" class="headerlink" title="Maven的依赖管理"></a>Maven的依赖管理</h3><p>Maven的一个核心功能就是<strong>依赖管理</strong>。当我们涉及到多模块项目（包含成百个模块或者子项目），管理依赖就变成了一项困难的任务。Maven展示出了它对处理这种情况的高度控制。    传统的WEB项目中，我们必须将工程所依赖的jar包复制到工程中，导致工程变得臃肿。那么Maven是如何使工程的大小变少的呢？</p>
<p><img src="/2020/11/20/Maven/%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86.png"></p>
<ul>
<li><p>分析：</p>
<blockquote>
<ol>
<li><p>使用Maven创建的工程，不是直接把jar包拷贝到工程中，而是在Maven的<code>pom.xml</code>文件中配置了工程所需要使用的jar包的坐标，而真正的jar包被保存在一个专门存放jar包的仓库（Maven仓库）。</p>
</li>
<li><p>当我们的工程需要使用jar包时，首先需要查找<code>pom.xml</code>配置文件中jar包的坐标，再根据坐标从Maven仓库中加载这些jar包。这样就避免了将jar包直接引进WEB工程。</p>
</li>
</ol>
</blockquote>
</li>
<li><p>存在的问题：通过<code>pom.xml</code>文件中坐标，再到Maven仓库中找到jar包，会不会很慢，从而影响程序的执行效率？</p>
<blockquote>
<p>答：通过<code>pom.xml</code>配置文件引入的jar包的坐标，再读取坐标并到仓库中加载jar包，最后返回给WEB工程使用，确实会影响程序的执行效率。    为了解决这个问题，Maven中也引入了索引的概念，通过建立索引，可以大大提高jar包的加载速度，使得我们认为jar包基本跟从放在本地的工程文件中读取出来的速度是一样的。这个过程就好比我们查阅字典时，为了能够快速查找到内容，书前都会有一个目录（索引），通过目录我们就能很快的定位到我们要查找的内容了；同样在Maven仓库中有了索引就可以加快我们找到jar包的速率。</p>
</blockquote>
</li>
</ul>
<h2 id="项目的一键构建"><a href="#项目的一键构建" class="headerlink" title="项目的一键构建"></a>项目的一键构建</h2><p>我们的项目，往往都要经过 <strong>编译<code>--&gt;&gt;</code>测试<code>--&gt;&gt;</code>运行<code>--&gt;&gt;</code>打包<code>--&gt;&gt;</code>安装<code>--&gt;&gt;</code>部署</strong>  等一系列过程才能被投入使用。</p>
<ol>
<li><p><strong>什么是构建？</strong></p>
<ul>
<li><p>没学Maven之前，我们如果要开发一个WEB项目，执行java文件时要用<code>javac</code>编译，测试需要导入<code>Test</code>模块，运行时首先要启动<code>TomCat</code>服务器，打包时需要手动将WEB项目打成<code>war</code>包才能在服务器上运行，还有配置工程路径等等。非常麻烦。</p>
</li>
<li><p>利用Maven可以极大的简化这些操作。我们利用maven开发的WEB工程，只需要一行命令[<code>mvn tomcat:run</code>]就可以进行黑盒操作，让Maven帮助我们执行上面的一系列操作，我们只需关注最终的结果即可。</p>
</li>
<li><p>构建指的是项目从<strong>编译<code>--&gt;&gt;</code>测试<code>--&gt;&gt;</code>运行<code>--&gt;&gt;</code>打包<code>--&gt;&gt;</code>安装<code>--&gt;&gt;</code>部署</strong>整个过程都交给Maven进行管理，这个过程称为构建。</p>
</li>
</ul>
</li>
<li><p><strong>一键构建</strong>：指的是整个构建过程，使用Maven中的一个命令就可以轻松完成整个工作。</p>
</li>
</ol>
<p><img src="/2020/11/20/Maven/image-20200604150418926.png" alt="image-20200604150418926"></p>
<ol start="3">
<li><p>示例：</p>
<blockquote>
<p>已知存在一个用maven开发的WEB项目。</p>
<ol>
<li><p>进入项目所在的文件夹</p>
<p><img src="/2020/11/20/Maven/image-20200604161159259.png" alt="image-20200604161159259"></p>
</li>
<li><p>在当前目录下进入cmd窗口</p>
</li>
<li><p>执行<code>mvn tomcat:run</code>命令，会自动对你的程序进行打包及发布，并发布web站点。</p>
</li>
</ol>
</blockquote>
</li>
</ol>
<hr>
<h1 id="Maven的使用"><a href="#Maven的使用" class="headerlink" title="Maven的使用"></a>Maven的使用</h1><h2 id="Maven安装"><a href="#Maven安装" class="headerlink" title="Maven安装"></a>Maven安装</h2><ol>
<li><p><a target="_blank" rel="noopener" href="https://maven.apache.org/">Maven官网地址</a></p>
</li>
<li><p>Maven软件的安装：</p>
<blockquote>
<ul>
<li>下载完成的Maven软件是一个压缩包</li>
<li>直接将Maven压缩包解压缩到一个没有中文、没有空格的目录下即可完成安装。</li>
<li>至此我们的Maven软件就可以使用了，前提是你的电脑上之前已经安装并配置好了JDK。</li>
</ul>
</blockquote>
</li>
<li><p>Maven解压后的目录结构：</p>
<p><img src="/2020/11/20/Maven/image-20200604152015094.png" alt="image-20200604152015094"></p>
<blockquote>
<ol>
<li><code>bin</code>    存放了Maven命令，比如我们前面用到的<code>mvn tomcat:run</code></li>
<li><code>boot</code>    存放了一些Maven本身的引导程序，如类加载器等</li>
<li><code>conf</code>    存放了Maven的一些配置文件，如<code>setting.xml</code>文件</li>
<li><code>lib</code>    存放了Maven本身运行所需要的一些jar包</li>
</ol>
</blockquote>
</li>
<li><p>Maven及JDK的全局配置。</p>
<ul>
<li><p>提前把JAVA_HOME配置好并添加到环境变量PATH中</p>
</li>
<li><p>配置MAVEN_HOME。</p>
<ol>
<li>找到存在JAVA_HOME的环境变量。根据自己之前的配置，可能是<code>User_name的用户变量</code>，也可能是<code>系统变量</code>，新建MAVEN_HOME环境变量如下图所示。</li>
</ol>
<p><img src="/2020/11/20/Maven/image-20200604152921489.png" alt="image-20200604152921489"></p>
<ol start="2">
<li><p>将MAVEN_HOME环境变量添加到对应的PATH中。</p>
<p>[下图中最后一步出错，<code>\bin</code>应该在<code>%</code>后面，正确格式是：**<code>%MAVEN_HOME%\bin</code>**]</p>
<p><img src="/2020/11/20/Maven/image-20200604153818728.png" alt="image-20200604153818728"></p>
</li>
<li><p>Maven运行时需要java的环境，所以必须确保环境变量中存在JAVA_HOME</p>
</li>
</ol>
</li>
</ul>
</li>
<li><p>Maven软件版本测试</p>
<ul>
<li>在cmd窗口输入<code>mvn -v</code>查看版本信息。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="Maven仓库"><a href="#Maven仓库" class="headerlink" title="Maven仓库"></a>Maven仓库</h2><p>Maven工程中没有jar包，只有jar包的坐标，所以Maven工程运行时需要从仓库加载一些jar包。</p>
<ul>
<li><p>Maven工程首先从<strong>本地仓库</strong>中去加载需要的jar包，</p>
</li>
<li><p>如果本地仓库没有，则默认去远程仓库中下载需要的jar包。远程仓库一般多用于公司或机构的局域网中，如果远程仓库中没有对应的jar包 或 没有配置远程仓库，则直接去<strong>中央仓库</strong>中下载。</p>
</li>
<li><p>中央仓库有非常全的开源jar包。从中央仓库下载的jar包会存储到<strong>私服</strong>或本地仓库，下次使用时可以直接到下载的位置去加载。</p>
</li>
<li><p>私服中的jar包可以从中央仓库中下载，也可以从本地仓库上传。</p>
</li>
</ul>
<p><img src="/2020/11/20/Maven/maven%E4%BB%93%E5%BA%93%E7%9A%84%E7%A7%8D%E7%B1%BB%E5%92%8C%E5%85%B3%E7%B3%BB-1591370377103.png"></p>
<h3 id="Maven仓库的分类"><a href="#Maven仓库的分类" class="headerlink" title="Maven仓库的分类"></a>Maven仓库的分类</h3><p>如上图所示，Maven仓库可分为3类：</p>
<ol>
<li><p>本地仓库：</p>
<ul>
<li>用来存储从远程仓库或中央仓库下载的插件或jar包。</li>
<li>项目使用的一些插件或jar包，优先从本地仓库加载。</li>
<li>默认本地仓库的位置在<code>$&#123;user.dir&#125;/m2/repository</code>，<code>$&#123;user.dir&#125;</code>表示本机的用户目录。</li>
</ul>
</li>
<li><p>远程仓库（私服）：</p>
<ul>
<li>如果本地仓库中没有需要的插件或jar包，默认去远程仓库下载。</li>
<li>远程仓库可以在互联网内，也可以在局域网内。</li>
</ul>
</li>
<li><p>中央仓库：</p>
<ul>
<li>在Maven软件中内置一个远程仓库地址 <a target="_blank" rel="noopener" href="https://repo1.macen.org/maven2">https://repo1.macen.org/maven2</a> ，叫做中央仓库，服务于整个互联网，里面储存了非常全的jar包。</li>
</ul>
</li>
</ol>
<h4 id="Maven本地仓库的配置"><a href="#Maven本地仓库的配置" class="headerlink" title="Maven本地仓库的配置"></a>Maven本地仓库的配置</h4><ol>
<li><p>在Maven的本地安装目录下找到配置文件<code>conf</code>中的<code>settings.xml</code></p>
<p><img src="/2020/11/20/Maven/image-20200605235824310.png" alt="image-20200605235824310"></p>
</li>
<li><p>在<code>settings.xml</code>的49~54行找到如下配置信息，可以修改本地仓库的默认下载位置。默认位置在本地系统盘中，可以自行修改本地仓库的位置。</p>
<p><img src="/2020/11/20/Maven/image-20200606000635341.png" alt="image-20200606000635341"></p>
</li>
<li><p>从远程仓库/中央仓库下载对应的jar包/插件 或 复制离线jar包/插件 到Maven本地仓库。</p>
</li>
</ol>
<hr>
<h2 id="Maven工程的认识"><a href="#Maven工程的认识" class="headerlink" title="Maven工程的认识"></a>Maven工程的认识</h2><h3 id="Maven标准目录结构"><a href="#Maven标准目录结构" class="headerlink" title="Maven标准目录结构"></a>Maven标准目录结构</h3><p><img src="/2020/11/20/Maven/Maven%E6%A0%87%E5%87%86%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84.png"></p>
<p>对于一个Web项目而言，最终需要打包发布后才可以被访问。    一般情况下，我们打包的部分往往只有核心代码部分，这部分代码较为稳定，不需要经常修改。而对于配置文件或测试代码部分等需要经常修改的代码我们往往不会将其打包发布。这就导致了上图中的几部分代码不应该放在同一个目录下。    对于不需要打包的部分，我们往往会自定义一些包名保存这些文件，但由于个人的使用习惯等问题，没有一个统一的标准。而在Maven中为我们制定了一个统一的标准，它提倡(但不强制)我们使用它规定的格式存储代码和配置文件，尽量提高代码的通用性。</p>
<p><strong>Maven标准目录结构</strong></p>
<blockquote>
<ol>
<li><code>src/main/java</code>    核心代码部分</li>
<li><code>src/main/rescoures</code>    配置文件部分</li>
<li><code>src/test/java</code>    测试代码部分</li>
<li><code>src/test/resources</code>    测试代码的配置文件部分</li>
<li><code>src/main/webapp</code>    页面资源，js，css，图片等。</li>
</ol>
</blockquote>
<h3 id="Maven工程的运行"><a href="#Maven工程的运行" class="headerlink" title="Maven工程的运行"></a>Maven工程的运行</h3><ol>
<li>进入Maven的工程目录（当前目录有<code>pom.xml</code>文件）</li>
<li>在当前文件夹下进入cmd命令窗口页面</li>
<li>运行<code>tomcat:run</code>命令</li>
<li>根据运行结果的提示信息，通过浏览器访问对应IP对应端口号下的资源。</li>
</ol>
<hr>
<h1 id="Maven的常用命令"><a href="#Maven的常用命令" class="headerlink" title="Maven的常用命令"></a>Maven的常用命令</h1><blockquote>
<p>我们可以在cmd中通过一系列的Maven命令来对我们的maven工程进行编译、测试、运行、打包、安装、部署。</p>
</blockquote>
<h2 id="Maven常用命令"><a href="#Maven常用命令" class="headerlink" title="Maven常用命令"></a>Maven常用命令</h2><h3 id="compile"><a href="#compile" class="headerlink" title="compile"></a>compile</h3><p><code>compile</code>是maven工程的<strong>编译</strong>命令，作用是将<code>src/main/java</code>目录下的文件编译为<code>.class文件</code>并保存到到target目录下。</p>
<blockquote>
<p>步骤：</p>
<ol>
<li>在项目目录下，cmd进入命令状态，执行<code>mvn compile</code>，</li>
<li>提示执行成功后，在当前项目的文件夹下会生成一个target文件夹，里面保存着生成的class文件，表示编译已完成。</li>
</ol>
</blockquote>
<h3 id="test"><a href="#test" class="headerlink" title="test"></a>test</h3><p><code>test</code>是maven工程的测试命令，作用是执行<code>src/test/java</code>目录下的单元测试类。</p>
<blockquote>
<p>步骤：</p>
<ol>
<li><p>在项目目录下，cmd进入命令状态，执行<code>mvn test</code>，</p>
</li>
<li><p>提示执行成功后，在当前项目的文件夹下会生成一个target文件夹，里面保存着<code>compile</code>编译好的文件，也保存着执行<code>test</code>命令后生成的class文件。</p>
</li>
</ol>
</blockquote>
<h3 id="package"><a href="#package" class="headerlink" title="package"></a>package</h3><p><code>package</code>是maven工程的打包命令，对于java工程打成jar包，对于web工程打成war包。</p>
<blockquote>
<p>步骤：</p>
<ol>
<li>在项目目录下，cmd进入命令状态，执行<code>mvn package</code>，</li>
<li>提示执行成功后，在当前项目的文件夹下会生成一个target文件夹，里面保存着执行<code>compile、test</code>编译好的文件，也保存着执行<code>package</code>命令生成的<code>jar/war</code>包。</li>
</ol>
</blockquote>
<h3 id="install"><a href="#install" class="headerlink" title="install"></a>install</h3><p><code>install</code>是maven工程的安装命令，执行<code>install</code>将Maven项目打成<code>war/jar</code>包发布到本地仓库。</p>
<blockquote>
<p>步骤：</p>
<ol>
<li>在项目目录下，cmd进入命令状态，执行<code>mvn install</code>，</li>
<li>提示执行成功后，在当前项目的文件夹下会生成一个target文件夹，里面保存着执行<code>compile、test、package</code>处理好的文件，同时也会在本地仓库多出一个以当前项目的多级文件名下保存的<code>war/jar</code>包。</li>
</ol>
</blockquote>
<h3 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a>Deploy</h3><h3 id="Tip"><a href="#Tip" class="headerlink" title="Tip"></a>Tip</h3><blockquote>
<p><strong>从运行结果可以看出，当后面的命令执行时，前面的操作过程也都会自动执行</strong></p>
</blockquote>
<h3 id="clean"><a href="#clean" class="headerlink" title="clean"></a>clean</h3><p><code>clean</code>是maven工程的清理命令，执行<code>clean</code>命令会删除target目录及内容</p>
<blockquote>
<p>步骤：</p>
<ol>
<li>在项目目录下，cmd进入命令状态，执行<code>mvn clean</code>，</li>
<li>提示执行成功后，会删除当前项目的文件夹下的target文件夹（如果存在）。</li>
</ol>
</blockquote>
<blockquote>
<p>使用场景：</p>
<ul>
<li>一般情况下，我们如果接手别人开发的项目，因为每台电脑的配置信息可能存在或大或小的配置上的差异。所以在接手别人的项目后，第一步就应该清空target目录，并在自己的电脑上重新部署。</li>
</ul>
</blockquote>
<h2 id="Maven指令的生命周期"><a href="#Maven指令的生命周期" class="headerlink" title="Maven指令的生命周期"></a>Maven指令的生命周期</h2><p>Maven对项目构建过程可分为<strong>三套</strong>  <strong>相互独立</strong>的生命周期。</p>
<p>这三套生命周期分别是：</p>
<blockquote>
<ul>
<li><code>清理生命周期：Clean Lifecycle</code>  在进行真正的构建之前进行一些清理工作</li>
<li><code>默认生命周期：Default Lifecycle</code>  构建的核心部分，编译、测试、打包、部署等等</li>
<li><code>站点生命周期：Site Lifecycle</code>  生成项目报告，站点，发布站点。</li>
</ul>
</blockquote>
<p><img src="/2020/11/20/Maven/maven%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.png"></p>
<hr>
<h2 id="Maven的概念模型"><a href="#Maven的概念模型" class="headerlink" title="Maven的概念模型"></a>Maven的概念模型</h2><p>Maven包含了：</p>
<blockquote>
<ul>
<li><p>依赖管理：</p>
<blockquote>
<ul>
<li>一个项目对象模型（Project Object Model），一组标准集合，</li>
<li>一个项目生命周期（Project Lifecycle），</li>
<li>一个依赖管理系统（Dependency Management System），</li>
</ul>
</blockquote>
</li>
<li><p>一键构建：</p>
<blockquote>
<ul>
<li>和用来运行定义在生命周期阶段（phase）中插件（plugin）目标（goal）的逻辑。</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<p><img src="/2020/11/20/Maven/maven%E6%A6%82%E5%BF%B5%E6%A8%A1%E5%9E%8B%E5%9B%BE.png"></p>
<h3 id="项目对象模型（POM）"><a href="#项目对象模型（POM）" class="headerlink" title="项目对象模型（POM）"></a>项目对象模型（POM）</h3><p>一个maven工程有一个<code>pom.xml</code>文件，通过<code>pom.xml</code>文件定义项目的坐标、依赖信息、项目信息、插件目标等。</p>
<ul>
<li>项目自身信息</li>
<li>项目运行所依赖的jar包信息</li>
<li>项目运行所需要的环境信息，比如：jdk，Tomcat信息等等。</li>
</ul>
<p><img src="/2020/11/20/Maven/Maven%E7%9A%84%E6%A6%82%E5%BF%B5%E6%A8%A1%E5%9E%8B.png"></p>
<h3 id="依赖管理系统（DMS）"><a href="#依赖管理系统（DMS）" class="headerlink" title="依赖管理系统（DMS）"></a>依赖管理系统（DMS）</h3><ul>
<li>通过maven的依赖管理对项目所依赖的jar包进行统一管理。</li>
</ul>
<h3 id="一个项目的生命周期（PL）"><a href="#一个项目的生命周期（PL）" class="headerlink" title="一个项目的生命周期（PL）"></a>一个项目的生命周期（PL）</h3><ul>
<li>使用Maven完成项目的构建。项目构建包括：清理、编译、测试、部署等过程，maven将这些过程规范为一个生命周期，</li>
</ul>
<h3 id="一组标准集合"><a href="#一组标准集合" class="headerlink" title="一组标准集合"></a>一组标准集合</h3><ul>
<li>Maven为整个项目管理过程定义一组标准。比如：通过Maven构建工程有标准的目录结构，有标准的声明周期阶段，依赖管理有标准的坐标定义等。</li>
</ul>
<h3 id="插件（plugin）目标（goal）"><a href="#插件（plugin）目标（goal）" class="headerlink" title="插件（plugin）目标（goal）"></a>插件（plugin）目标（goal）</h3><ul>
<li>Maven管理项目生命周期过程都是基于插件完成的。</li>
</ul>
<hr>
<h2 id="IDEA开发Maven项目"><a href="#IDEA开发Maven项目" class="headerlink" title="IDEA开发Maven项目"></a>IDEA开发Maven项目</h2><h3 id="IDEA集成Maven插件"><a href="#IDEA集成Maven插件" class="headerlink" title="IDEA集成Maven插件"></a>IDEA集成Maven插件</h3><ul>
<li> <strong><code>File--&gt;Settings--&gt;Maven</code></strong></li>
</ul>
<p><img src="/2020/11/20/Maven/image-20200612124538580.png" alt="image-20200612124538580"></p>
<p>​    </p>
<ul>
<li><strong>配置优先访问本地仓库</strong>[可选]</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-DarchetypeCatalog=internal</span><br></pre></td></tr></table></figure>

<p>​    配置本地仓库优先后，即使在离线条件下，如果本地仓库中有程序所需的依赖，Maven项目也可以正常运行。</p>
<p><img src="/2020/11/20/Maven/image-20200612124939265.png" alt="image-20200612124939265"></p>
<hr>
<h3 id="创建基于Maven的JavaSE工程"><a href="#创建基于Maven的JavaSE工程" class="headerlink" title="创建基于Maven的JavaSE工程"></a>创建基于Maven的JavaSE工程</h3><h4 id="使用模板创建基于Maven的JavaSE工程"><a href="#使用模板创建基于Maven的JavaSE工程" class="headerlink" title="使用模板创建基于Maven的JavaSE工程"></a>使用模板创建基于Maven的JavaSE工程</h4><p><img src="/2020/11/20/Maven/image-20200612130049229.png" alt="image-20200612130049229"></p>
<ol>
<li><p>选择创建一个Maven项目。</p>
</li>
<li><p>勾选使用模板创建Maven项目。</p>
</li>
<li><p>选择要使用的模板，点击下一步。</p>
<p><img src="/2020/11/20/Maven/image-20200612130341263.png" alt="image-20200612130341263"></p>
</li>
<li><p>填写对应的信息，点击下一步</p>
<p><img src="/2020/11/20/Maven/image-20200612130551355.png" alt="image-20200612130551355"></p>
</li>
<li><p>选择填写上述信息，完成Maven工程的创建。</p>
<p><img src="/2020/11/20/Maven/image-20200612131210777.png" alt="image-20200612131210777"></p>
</li>
<li><p>默认情况下，Maven工程不会帮我们创建配置文件目录<code>resources</code>，需要我们手动补齐。</p>
<p><img src="/2020/11/20/Maven/image-20200612131633499.png" alt="image-20200612131633499"></p>
<p>​    在当前目录下新建<code>Directory</code>目录，并设置其作为资源文件路径。</p>
<p><img src="/2020/11/20/Maven/image-20200612131840555.png" alt="image-20200612131840555"></p>
</li>
</ol>
<hr>
<h4 id="不使用模板创建Maven工程"><a href="#不使用模板创建Maven工程" class="headerlink" title="不使用模板创建Maven工程"></a>不使用模板创建Maven工程</h4><ul>
<li>只需要不勾选是否使用模板选项即可。</li>
</ul>
<hr>
<h3 id="创建基于Maven的JavaEE工程"><a href="#创建基于Maven的JavaEE工程" class="headerlink" title="创建基于Maven的JavaEE工程"></a>创建基于Maven的JavaEE工程</h3><h4 id="使用模板"><a href="#使用模板" class="headerlink" title="使用模板"></a>使用模板</h4><ul>
<li>只需要把使用的模板改为<code>***-webapp</code>即可</li>
</ul>
<p><img src="/2020/11/20/Maven/image-20200612134707189.png" alt="image-20200612134707189"></p>
<ul>
<li><p>创建完成后，目录结构如下：</p>
<p><img src="/2020/11/20/Maven/image-20200612135331151.png" alt="image-20200612135331151"></p>
<p>需要手动在<code>main</code>目录下添加<code>java</code>目录并将其设置为资源目录。（参考JavaSE工程修改）</p>
</li>
</ul>
<hr>
<h4 id="不使用模板"><a href="#不使用模板" class="headerlink" title="不使用模板"></a>不使用模板</h4><ul>
<li>只需要不勾选是否使用模板选项即可。</li>
</ul>
<hr>
<h1 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h1><h2 id="坐标定义"><a href="#坐标定义" class="headerlink" title="坐标定义"></a>坐标定义</h2><p>在<code>pom.xml</code>中定义坐标，内容包括：<code>groupId</code>、<code>artifacId</code>、<code>version</code>、<code>packaging</code>等。含义分别是：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--项目名称--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.xsyu.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 模块名称 --&gt;</span>项目名或模块名</span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 当前项目版本号 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 打包类型 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span> ：</span><br></pre></td></tr></table></figure>

<ul>
<li><p>项目名称：一般为<code>组织名 + 项目名</code>公司或组织域名的倒序</p>
</li>
<li><p>当前项目版本号：</p>
<blockquote>
<p><code>snapshot</code>为快照版本即非正式版本</p>
<p><code>release</code>为正式发布版本</p>
</blockquote>
</li>
<li><p>打包类型：</p>
<blockquote>
<p><code>jar</code>：执行package命令会打成jar包<br><code>war</code>：执行package命令会打成war包<br><code>pom</code>：用于maven工程的继承，通常父工程设置为pom</p>
</blockquote>
</li>
</ul>
<h2 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h2><p><code>pom.xml</code>是Maven项目的核心配置文件，位于每个工程的根目录，基本配置如下：</p>
<p><code>&lt;project&gt;</code> ：文件的根节点 </p>
<p><code>&lt;modelversion&gt;</code> ： pom.xml使用的对象模型版本 </p>
<p><code>&lt;groupId&gt; </code>：项目名称，一般写项目的域名 </p>
<p><code>&lt;artifactId&gt;</code> ：模块名称，子项目名或模块名称</p>
<p><code> &lt;version&gt;</code> ：产品的版本号 .</p>
<p><code>&lt;packaging&gt;</code> ：打包类型，一般有jar、war、pom 等 </p>
<p><code>&lt;name&gt;</code> ：项目的显示名，常用于 Maven 生成的文档。 </p>
<p><code>&lt;description&gt;</code> ：项目描述，常用于 Maven 生成的文档</p>
<p><code>&lt;dependencies&gt; </code>：项目依赖构件配置，配置项目依赖构件的坐标</p>
<p><code>&lt;build&gt;</code> ：项目构建配置，配置编译、运行插件等。</p>
<ul>
<li><p>配置编译版本</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1&lt;/version &gt; </span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span> </span><br><span class="line">                <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="依赖范围"><a href="#依赖范围" class="headerlink" title="依赖范围"></a>依赖范围</h2><ul>
<li>Compile</li>
<li>Test</li>
<li>Runtime</li>
<li>Provided</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/13/Ajax/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/13/Ajax/" class="post-title-link" itemprop="url">Ajax</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-11-13 22:11:26" itemprop="dateCreated datePublished" datetime="2020-11-13T22:11:26+08:00">2020-11-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-04-11 17:07:28" itemprop="dateModified" datetime="2021-04-11T17:07:28+08:00">2021-04-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="异步和同步"><a href="#异步和同步" class="headerlink" title="异步和同步"></a>异步和同步</h1><p>异步和同步建立在客户端和服务器端相互通信的基础上：</p>
<ul>
<li><strong>同步</strong>：客户端向服务器端发送请求，在服务器处理请求的时间段内，客户端必须等待服务器端做出响应后才能进行下一步操作。在等待的期间客户端不能进行其它的操作。</li>
<li><strong>异步</strong>：客户端向服务器端发送请求，在服务器处理请求的时间段内，客户端也要等待服务器端的响应，但在等待响应的期间，客户端可以进行其它的操作。</li>
</ul>
<p><img src="/2020/11/13/Ajax/1.%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5.bmp"></p>
<ul>
<li>对于传统的网页（不使用异步请求）而言，如果需要更新内容，就必须重新加载渲染整个页面。</li>
<li>而异步请求是一种在无需重新加载整个网页的情况下，能够更新部分网页的技术。</li>
<li>客户端（浏览器）通过发送异步请求请求与服务器进行少量数据交换，可以实现整个网页的异步更新（即在不重新加载整个网页的情况下，对网页中的部分内容进行更新）。</li>
</ul>
<hr>
<h1 id="什么是AJAX请求"><a href="#什么是AJAX请求" class="headerlink" title="什么是AJAX请求"></a>什么是AJAX请求</h1><blockquote>
<p>AJAX（Asynchronous JavaScript And XML）：<strong>异步的</strong> JavaScript 和 XML</p>
</blockquote>
<p>Ajax 在客户端与服务器端之间采用异步数据传输。</p>
<p>Ajax 是一种客户端通过 JavaScript 发起异步请求，局部更新页面的技术。</p>
<p>采用 Ajax 请求可以使客户端（如浏览器页面）每次只发送部分请求到服务器端，而不是整个页面包含的所有请求。</p>
<ul>
<li>注意事项：<ol>
<li>Ajax 请求是局部更新，<strong>浏览器地址栏不会发生变化</strong>；</li>
</ol>
</li>
</ul>
<hr>
<h1 id="Ajax-请求的实现方式"><a href="#Ajax-请求的实现方式" class="headerlink" title="Ajax 请求的实现方式"></a>Ajax 请求的实现方式</h1><p><strong>Ajax 是通过 JavaScript 来发送的，所以需要定义在<code>&lt;script&gt;</code>标签内。</strong></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.w3school.com.cn/ajax/index.asp">参考文档地址</a></p>
</blockquote>
<hr>
<h1 id="通过-Js-发送-Ajax-原生请求"><a href="#通过-Js-发送-Ajax-原生请求" class="headerlink" title="通过 Js 发送 Ajax 原生请求"></a>通过 Js 发送 Ajax 原生请求</h1><h2 id="1、创建-XMLHttpRequest-实例"><a href="#1、创建-XMLHttpRequest-实例" class="headerlink" title="1、创建 XMLHttpRequest 实例"></a>1、创建 XMLHttpRequest 实例</h2><blockquote>
<p><strong>XMLHttpRequest</strong> 对象</p>
</blockquote>
<ul>
<li>XMLHttpRequest 对象是一个 Js 对象，用于向服务器发送请求。</li>
<li>市面上主流的浏览器均支持使用 XMLHttpRequest 对象发送请求。（只有 IE5 和 IE6 需要使用 ActiveXObject 对象发送请求）</li>
<li>为了适用所有的现代浏览器，发送请求前需要先检查浏览器是否支持使用 XMLHttpRequest 对象发送请求。如果支持，则创建 XMLHttpRequest 对象；如果不支持，则创建 ActiveXObject 对象 </li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 声明一个全局变量</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> xmlhttp;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 校验浏览器是否支持使用 XMLHttpRequest 对象发送请求</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>)</span></span><br><span class="line"><span class="language-javascript">    &#123;</span></span><br><span class="line"><span class="language-javascript">        xmlhttp=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">else</span></span></span><br><span class="line"><span class="language-javascript">    &#123;</span></span><br><span class="line"><span class="language-javascript">        xmlhttp=<span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="2、与服务器建立连接"><a href="#2、与服务器建立连接" class="headerlink" title="2、与服务器建立连接"></a>2、与服务器建立连接</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过上面声明的全局变量与服务器建立连接</span></span><br><span class="line">xmlhttp.<span class="title function_">open</span>()</span><br></pre></td></tr></table></figure>

<ul>
<li>方法描述：</li>
</ul>
<blockquote>
<p>**open(method, url, async)**：与服务器建立连接，并规定好请求的类型、URL以及是否异步。</p>
<blockquote>
<p>props：</p>
<ul>
<li>method：GET/POST</li>
<li>url：请求的路径</li>
<li>async：true(异步)/false(同步)</li>
</ul>
</blockquote>
</blockquote>
<h2 id="3、向服务器发送请求"><a href="#3、向服务器发送请求" class="headerlink" title="3、向服务器发送请求"></a>3、向服务器发送请求</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过上面声明的全局变量向服务器发送请求</span></span><br><span class="line">xmlhttp.<span class="title function_">send</span>()</span><br></pre></td></tr></table></figure>

<ul>
<li>方法描述：</li>
</ul>
<blockquote>
<p><strong>send(string)</strong>    ： 将请求发送到服务器。</p>
<blockquote>
<p>props：</p>
<ul>
<li>如果发送的是 GET 请求，则 <code>send()</code> 方法无需任何参数；</li>
<li>如果是 POST 请求，则需要携带 string 类型的请求参数作为请求体信息。</li>
</ul>
</blockquote>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/* -------------------------------------------</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    	向服务器发送请求</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    		1&gt; 与服务器建立连接</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">    		2&gt; 发送请求</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">        ------------------------------------------- */</span></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/* GET请求 */</span></span></span><br><span class="line"><span class="language-javascript">    xmlhttp.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/AJAX/AjaxServlet?username=zhangsan&quot;</span>,<span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">    xmlhttp.<span class="title function_">send</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/* POST请求 */</span></span></span><br><span class="line"><span class="language-javascript">    xmlhttp.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>,<span class="string">&quot;AjaxServlet&quot;</span>,<span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">    xmlhttp.<span class="title function_">send</span>(<span class="string">&quot;username=zhangsan&amp;password=123&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4、服务器处理请求"><a href="#4、服务器处理请求" class="headerlink" title="4、服务器处理请求"></a>4、服务器处理请求</h2><p>服务器接收请求 <code>--&gt;&gt;</code> 执行业务逻辑 <code>--&gt;&gt;</code> 返回响应结果</p>
<h2 id="5、客户端处理服响应结果"><a href="#5、客户端处理服响应结果" class="headerlink" title="5、客户端处理服响应结果"></a>5、客户端处理服响应结果</h2><p>当 <strong>XMLHttpServlet</strong> 对象发出请求后，该对象中的 <strong>onreadystatechange</strong> 函数就会一直监听该请求的响应状态，当监听到响应状态为成功后，通过该对象中的 <strong>responseText</strong> 方法获取响应结果。</p>
<p><strong>XMLHttpServlet</strong> 对象中的3个重要方法/属性：</p>
<blockquote>
<p><strong>onreadystatechange</strong></p>
<blockquote>
<p>描述：<code>onreadystatechange</code>是一个回调函数，它会一直监听<code>readyState</code>属性，每当<code>readyState</code>属性改变时，就会调用该函数。</p>
</blockquote>
<p><strong>readyState</strong></p>
<blockquote>
<p>描述：存放<code>XMLHttpServlet</code>的状态。从0到4共五种状态。</p>
<ul>
<li>0：请求未初始化</li>
<li>1：已与服务器建立连接</li>
<li>2：请求已接收</li>
<li>3：请求处理中</li>
<li>4：请求已完成，且响应已就绪</li>
</ul>
</blockquote>
<p><strong>status</strong></p>
<blockquote>
<p>描述：响应状态描述</p>
<ul>
<li>200：‘OK’</li>
<li>404：未找到页面</li>
<li>……</li>
</ul>
</blockquote>
</blockquote>
<p>当且仅当 <code>readyState = 4 &amp;&amp; status = 200</code> 时，表示响应成功，这时才处理响应结果</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 3.接收并处理来自服务器的响应</span></span></span><br><span class="line"><span class="language-javascript">    xmlhttp.<span class="property">onreadystatechange</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 1&gt; 判断readyState的状态是否为4 &amp; 判断响应码状态是否为200</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (xmlhttp.<span class="property">readyState</span>==<span class="number">4</span> &amp;&amp; xmlhttp.<span class="property">status</span>==<span class="number">200</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 2&gt; 获取服务器的响应结果</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> responseText = xmlhttp.<span class="property">responseText</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(responseText)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>完整代码</strong>：</p>
<ol>
<li>客户端代码</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>原生JS方式实现AJAX<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 1.创建XMLHttpRequest对象</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> xmlhttp;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>)</span></span><br><span class="line"><span class="language-javascript">                &#123;</span></span><br><span class="line"><span class="language-javascript">                    xmlhttp=<span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">else</span></span></span><br><span class="line"><span class="language-javascript">                &#123;</span></span><br><span class="line"><span class="language-javascript">                    xmlhttp=<span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;Microsoft.XMLHTTP&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 2.向服务器发送请求</span></span></span><br><span class="line"><span class="language-javascript">                xmlhttp.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;/AJAX/AjaxServlet?username=zhangsan&quot;</span>,<span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript">                xmlhttp.<span class="title function_">send</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 3.接收并处理来自服务器的响应</span></span></span><br><span class="line"><span class="language-javascript">                xmlhttp.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// 判断响应成功后才获取服务器的响应结果</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (xmlhttp.<span class="property">readyState</span>==<span class="number">4</span> &amp;&amp; xmlhttp.<span class="property">status</span>==<span class="number">200</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">let</span> responseText = xmlhttp.<span class="property">responseText</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="title function_">alert</span>(responseText)</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;发送异步请求&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun()&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--点击&#x27;button&#x27;按钮发送异步请求，等待响应的时间段内，整个Html页面仍然正常运行，可以在此文本框中进行任何操作--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>服务器段代码</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.XSYU.web.servlet;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(&quot;/AjaxServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AjaxServlet</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 1.获取请求参数</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4.模拟处理业务耗时</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2.打印到控制台上</span></span><br><span class="line">        System.out.println(username);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3.返回结果</span></span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;Hello&quot;</span>+username);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="built_in">this</span>.doPost(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>









<hr>
<h1 id="通过-JQuery-发送-Ajax-请求"><a href="#通过-JQuery-发送-Ajax-请求" class="headerlink" title="通过 JQuery 发送 Ajax 请求"></a>通过 JQuery 发送 Ajax 请求</h1><h2 id="通用方式：-ajax"><a href="#通用方式：-ajax" class="headerlink" title="通用方式：$ajax()"></a>通用方式：<code>$ajax()</code></h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>通过 JQuery 发送 Ajax 请求<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--导入JQuery依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery-3.3.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span> <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 1.使用 $.ajax()发送异步请求</span></span></span><br><span class="line"><span class="language-javascript">                $.<span class="title function_">ajax</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">url</span>: <span class="string">&quot;/AJAX/ajaxServlet&quot;</span>,       <span class="comment">// 请求资源路径</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">type</span>: <span class="string">&quot;POST&quot;</span>,                    <span class="comment">// 请求方式</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">// data: &quot;username=jack&amp;age=23&quot;,   // 请求参数类型1</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">data</span>: &#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;jack&quot;</span>, <span class="string">&quot;age&quot;</span>:<span class="number">23</span>&#125;,     <span class="comment">// 请求参数类型2[json格式]</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">success</span>:<span class="keyword">function</span> (<span class="params">data</span>) &#123;    <span class="comment">// data是响应消息数据</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="title function_">alert</span>(data);</span></span><br><span class="line"><span class="language-javascript">                    &#125;,                              <span class="comment">// 响应成功的回调函数</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">error</span>:<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="title function_">alert</span>(<span class="string">&quot;出错了qaq&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                    &#125;,                              <span class="comment">// 响应出错后的回调函数</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">dataType</span>: <span class="string">&quot;text&quot;</span>                <span class="comment">// 设置接收到的响应数据的格式</span></span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;点击发送异步请求&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun();&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h2 id="GET请求类型：-get"><a href="#GET请求类型：-get" class="headerlink" title="GET请求类型：$.get()"></a>GET请求类型：<code>$.get()</code></h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>JQuery实现AJAX的GET请求方式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/jquery-3.3.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//定义方法</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span>  <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                $.<span class="title function_">get</span>(<span class="string">&#x27;/AJAX/ajaxServlet&#x27;</span>,&#123;<span class="attr">username</span>:<span class="string">&#x27;rose&#x27;</span>&#125;, <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(data);</span></span><br><span class="line"><span class="language-javascript">                &#125;, <span class="string">&#x27;text&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">             $.get(url, data, callbackFunction, &#x27;dataType&#x27;)的参数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 url  :  服务器地址</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 data  ：  请求参数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 callbackFunction  ：  回调函数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 dataType  ：  设置响应数据类型</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          */</span></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;发送异步请求&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun();&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="POST请求类型：-post"><a href="#POST请求类型：-post" class="headerlink" title="POST请求类型：$.post()"></a>POST请求类型：<code>$.post()</code></h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>JQuery实现AJAX的GET请求方式<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/jquery-3.3.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//定义方法</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span>  <span class="title function_">fun</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                $.<span class="title function_">post</span>(<span class="string">&#x27;/AJAX/ajaxServlet&#x27;</span>,&#123;<span class="attr">username</span>:<span class="string">&#x27;lisi&#x27;</span>&#125;, <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">alert</span>(data);</span></span><br><span class="line"><span class="language-javascript">                &#125;, <span class="string">&#x27;text&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">             $.get(url, data, callbackFunction, &#x27;dataType&#x27;)的参数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 url  :  服务器地址</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 data  ：  请求参数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 callbackFunction  ：  回调函数</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">                 dataType  ：  设置响应数据类型</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">          */</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;发送异步请求&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;fun();&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>





<hr>
<h1 id="通过-Axios-发送-Ajax-请求"><a href="#通过-Axios-发送-Ajax-请求" class="headerlink" title="通过 Axios 发送 Ajax 请求"></a>通过 Axios 发送 Ajax 请求</h1><h2 id="Axios-概述"><a href="#Axios-概述" class="headerlink" title="Axios 概述"></a>Axios 概述</h2><p>Axios 可用于在浏览器或 Node.js 中发送 Ajax 请求！</p>
<p>本次测试使用 Vue + Axios 组合的方式发送 Ajax 请求！</p>
<h2 id="Axios-实例"><a href="#Axios-实例" class="headerlink" title="Axios 实例"></a>Axios 实例</h2><h3 id="1、导入依赖"><a href="#1、导入依赖" class="headerlink" title="1、导入依赖"></a>1、导入依赖</h3><h4 id="1-1-下载-Vue-和-Axios-的-Js-依赖"><a href="#1-1-下载-Vue-和-Axios-的-Js-依赖" class="headerlink" title="1.1    下载 Vue 和 Axios 的 Js 依赖"></a>1.1    下载 Vue 和 Axios 的 Js 依赖</h4><ul>
<li><p><code>vue.min.js</code></p>
</li>
<li><p><code>axios.min.js</code></p>
</li>
<li><p>通过 NPM 下载 Vue 和 Axios 依赖的指令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install vue --save</span><br><span class="line">npm install axios --save</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="1-2-创建-axios-html-并引入-Vue-和-Axios-的-Js-依赖"><a href="#1-2-创建-axios-html-并引入-Vue-和-Axios-的-Js-依赖" class="headerlink" title="1.2    创建 axios.html 并引入 Vue 和 Axios 的 Js 依赖"></a>1.2    创建 <code>axios.html</code> 并引入 Vue 和 Axios 的 Js 依赖</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./node_modules/vue/dist/vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./node_modules/axios/dist/axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2、Axios-语法格式"><a href="#2、Axios-语法格式" class="headerlink" title="2、Axios 语法格式"></a>2、Axios 语法格式</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: &#123; &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Xxx</span>() &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 使用 Axios 发送 Ajax请求</span></span></span><br><span class="line"><span class="language-javascript">                axios.<span class="title function_">get</span>(<span class="string">&quot;请求的接口路径&quot;</span>)	<span class="comment">// 1、设置请求方式		2、设置请求的接口路径</span></span></span><br><span class="line"><span class="language-javascript">                    .<span class="title function_">then</span>()		<span class="comment">//请求成功的回调函数</span></span></span><br><span class="line"><span class="language-javascript">                    .<span class="title function_">catch</span>() 	<span class="comment">//请求失败的回调函数</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="3、测试代码"><a href="#3、测试代码" class="headerlink" title="3、测试代码"></a>3、测试代码</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">&quot;user in userList&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;user.name&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;user.age&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;vue.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">userList</span>:[]</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">created</span>(<span class="params"></span>) &#123; <span class="comment">//在页面渲染之前执行</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//调用方法，得到返回json数据</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="title function_">getList</span>()</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">getList</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//使用axios方式ajax请求</span></span></span><br><span class="line"><span class="language-javascript">                axios.<span class="title function_">get</span>(<span class="string">&quot;user.json&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">                    .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="comment">//console.log(response)</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">userList</span> =  response.<span class="property">data</span>.<span class="property">data</span>.<span class="property">items</span>	<span class="comment">// 获取json数据内层的数据</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">userList</span>)</span></span><br><span class="line"><span class="language-javascript">                &#125;) </span></span><br><span class="line"><span class="language-javascript">                    .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(error)</span></span><br><span class="line"><span class="language-javascript">                &#125;) <span class="comment">//请求失败</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里请求回调后得到的是一个json数据，我们分别使用了<code>response</code>和 <code>error</code> 接收回调的数据。实际上我们可以使用任意名字来接收回调的数据，他都会将回调的结果封装起来并命名为你起的名字！ </p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/11/13/XML/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2020/11/13/XML/" class="post-title-link" itemprop="url">XML</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2020-11-13 20:05:05 / Modified: 22:08:12" itemprop="dateCreated datePublished" datetime="2020-11-13T20:05:05+08:00">2020-11-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h1><blockquote>
<p><strong>XML</strong>：Extensible Markup Language，可扩展标记语言</p>
<ul>
<li><strong>可扩展</strong>：标签都是自定义的。 如可以定义<code>&lt;user&gt;  &lt;student&gt;</code>等标签。</li>
<li><strong>标记语言</strong>：标签构成的语言</li>
</ul>
</blockquote>
<h2 id="XML的功能"><a href="#XML的功能" class="headerlink" title="XML的功能"></a>XML的功能</h2><blockquote>
<p>XML的功能：<strong>存储数据</strong></p>
<ul>
<li>存储的数据一般作为配置文件，在网络中传输。</li>
</ul>
</blockquote>
<h2 id="XML-vs-HTML"><a href="#XML-vs-HTML" class="headerlink" title="XML  vs.  HTML"></a>XML  vs.  HTML</h2><blockquote>
<ol>
<li>xml标签都是自定义的，html标签是预定义的。</li>
<li>xml的语法严格，html语法松散</li>
<li>xml是存储数据的，html是展示数据</li>
</ol>
</blockquote>
<hr>
<h1 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h1><blockquote>
<ol>
<li>xml文档的后缀名<code>.xml</code></li>
<li>xml第一行必须定义为文档声明，且必须顶行写</li>
<li>xml文档中有且仅有一个根标签</li>
<li>属性值必须使用引号(单双都可)引起来</li>
<li>标签必须正确关闭</li>
<li>xml标签名称区分大小写</li>
</ol>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&#x27;1.0&#x27; ?&gt;</span>		<span class="comment">&lt;!--文档声明--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">users</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">user</span> <span class="attr">id</span>=<span class="string">&#x27;1&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>zhangsan<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span>23<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gender</span>&gt;</span>male<span class="tag">&lt;/<span class="name">gender</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">user</span> <span class="attr">id</span>=<span class="string">&#x27;2&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>lisi<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span>24<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gender</span>&gt;</span>female<span class="tag">&lt;/<span class="name">gender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">users</span>&gt;</span></span><br></pre></td></tr></table></figure>





<hr>
<h1 id="XML文档的组成部分"><a href="#XML文档的组成部分" class="headerlink" title="XML文档的组成部分"></a>XML文档的组成部分</h1><h2 id="文档声明"><a href="#文档声明" class="headerlink" title="文档声明"></a>文档声明</h2><ol>
<li>格式：</li>
</ol>
<blockquote>
<p><code>&lt;?xml 属性列表 ?&gt;</code></p>
</blockquote>
<ol start="2">
<li>属性列表：</li>
</ol>
<blockquote>
<ul>
<li><p><code>version</code>：版本号（必须有）</p>
</li>
<li><p><code>encoding</code>：编码方式。告知解析引擎当前文档使用的字符集，默认值：ISO-8859-1</p>
</li>
<li><p><code>standalone</code>：是否独立。取值：</p>
<blockquote>
<ul>
<li>yes：不依赖其他文件</li>
<li>no：依赖其他文件</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<hr>
<h2 id="指令-了解"><a href="#指令-了解" class="headerlink" title="指令(了解)"></a>指令(了解)</h2><blockquote>
<p>XML最初被设计出来是用于HTML的。在XML中。指令就是用于关联CSS的。目前基本已经被弃用。</p>
</blockquote>
<hr>
<h2 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h2><blockquote>
<p>自定义标签的的规则：</p>
<ul>
<li>名称可以包含字母、数字以及其他的字符 </li>
<li>名称不能以数字或者标点符号开始 </li>
<li>名称不能以字母 xml（或者 XML、Xml 等等）开始 </li>
<li>名称不能包含空格 </li>
</ul>
</blockquote>
<h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><blockquote>
<p>类似于HTML</p>
</blockquote>
<h3 id="Tip："><a href="#Tip：" class="headerlink" title="Tip："></a>Tip：</h3><blockquote>
<ul>
<li>标签中的id属性值是唯一的</li>
</ul>
</blockquote>
<hr>
<h2 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h2><blockquote>
<p>类似于HTML</p>
</blockquote>
<h3 id="CDATA区"><a href="#CDATA区" class="headerlink" title="CDATA区"></a>CDATA区</h3><blockquote>
<p>CDATA区中的数据会被原样展示</p>
</blockquote>
<p>格式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;![CDATA[ 数据 ]]&gt;</span><br></pre></td></tr></table></figure>



<p>​        </p>
<hr>
<h1 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h1><blockquote>
<ul>
<li>约束就是xml文档的书写规则，是用来限制xml文件的。</li>
<li>约束位于XML文件的文档声明部分。</li>
<li>每个规范的XML文档都应该有自己的约束</li>
</ul>
</blockquote>
<p>作为一个开发人员需要做到：</p>
<ol>
<li>能够在xml中引入约束文档</li>
<li>能够简单的读懂约束文档</li>
</ol>
<blockquote>
<p>作为一个开发人员，在使用框架时配置文件中经常会给出一些约束。        框架是一个半成品的软件，且xml可以自定义标签，如果不加约束全部采用自定义的标签，显然框架的底层实现是无法识别这些自定义标签的。        所以在使用框架时一般都会手动（或自动）引入框架自带的一些约束，程序员可以在约束范围内最大程序的修改xml文件，但不能根据自己的喜好随意更改xml文件。</p>
</blockquote>
<hr>
<h2 id="常见的约束技术"><a href="#常见的约束技术" class="headerlink" title="常见的约束技术"></a>常见的约束技术</h2><h3 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h3><blockquote>
<p>一种简单的约束技术</p>
</blockquote>
<h4 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h4><blockquote>
<p>引入dtd文档到xml文档中</p>
</blockquote>
<h5 id="内部dtd"><a href="#内部dtd" class="headerlink" title="内部dtd"></a>内部dtd</h5><blockquote>
<p>将约束规则定义在xml文档中</p>
</blockquote>
<h5 id="外部dtd"><a href="#外部dtd" class="headerlink" title="外部dtd"></a>外部dtd</h5><blockquote>
<p>将约束的规则定义在外部的dtd文件中</p>
</blockquote>
<p>格式：</p>
<blockquote>
<ol>
<li>从本地引入dtd约束文件</li>
<li>从网络上引入dtd约束文件</li>
</ol>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--1、从本地引入dtd约束文件	system表示本地系统--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE 根标签名 <span class="keyword">SYSTEM</span> <span class="string">&quot;dtd文件的位置&quot;</span>&gt;</span>	 	</span><br><span class="line"><span class="comment">&lt;!--2、从网络上引入dtd约束文件	  dtd文件的位置URL&quot;--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE 根标签名 <span class="keyword">PUBLIC</span> “dtd文件名字” “dtd文件的位置URL”&gt;</span></span><br></pre></td></tr></table></figure>



<hr>
<h3 id="Schema"><a href="#Schema" class="headerlink" title="Schema"></a>Schema</h3><blockquote>
<p>一种复杂的约束技术</p>
</blockquote>
<ul>
<li>Schema约束文件的后缀名：<code>*.xsd</code></li>
<li>schema文档本身就是一个xml文档</li>
</ul>
<h4 id="为什么要使用Schema-（DTD的缺点）"><a href="#为什么要使用Schema-（DTD的缺点）" class="headerlink" title="为什么要使用Schema?（DTD的缺点）"></a>为什么要使用Schema?（DTD的缺点）</h4><blockquote>
<p>DTD约束是一种弱约束类型。</p>
<p>在DTD约束中，标签内的值的数据类型可以是任意的，比如一个人的年龄可以是无限大或负数，姓名可以是数字等等。这些在schema中都能得到解决。</p>
</blockquote>
<h4 id="如何在xml配置文件中引入schema约束文档？"><a href="#如何在xml配置文件中引入schema约束文档？" class="headerlink" title="如何在xml配置文件中引入schema约束文档？"></a>如何在xml配置文件中引入schema约束文档？</h4><ol>
<li>填写xml文档的根元素。</li>
<li>引入xsi前缀（固定格式）。<code>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</code></li>
<li>引入xsd文件命名空间。<code>xsi:schemaLocation=&quot;http://www.itcast.cn/xml&quot;</code></li>
<li>为每一个xsd约束声明一个前缀（别名），作为标识。<code>  student.xsd</code></li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">students</span>   <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xmlns</span>=<span class="string">&quot;http://www.itcast.cn/xml&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.itcast.cn/xml  </span></span></span><br><span class="line"><span class="string"><span class="tag">                              student.xsd&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​    </p>
<h1 id="XML文档解析"><a href="#XML文档解析" class="headerlink" title="XML文档解析"></a>XML文档解析</h1><blockquote>
<p>XML文档的作用就是存储数据，但是计算机是无法直接使用这些数据的，必须通过解析器把XML文档转化为计算机可以识别的二进制数据。    <strong>解析</strong>就是操作XML文档，将文档中的数据读取到内存中</p>
</blockquote>
<h2 id="对XML文档的操作"><a href="#对XML文档的操作" class="headerlink" title="对XML文档的操作"></a>对XML文档的操作</h2><blockquote>
<ol>
<li>解析(读取)：将文档中的数据读取到内存中</li>
<li>写入：将内存中的数据保存到xml文档中。持久化的存储</li>
</ol>
</blockquote>
<h3 id="解析XML文档的方式"><a href="#解析XML文档的方式" class="headerlink" title="解析XML文档的方式"></a>解析XML文档的方式</h3><ol>
<li><p><strong>DOM</strong></p>
<blockquote>
<p>将标记语言文档一次性加载进内存，在内存中形成一一棵DOM树</p>
<ul>
<li>优点：操作方便，可以对文档进行CRUD的所有操作</li>
<li>缺点：占内存</li>
</ul>
</blockquote>
</li>
<li><p><strong>SAX</strong></p>
</li>
</ol>
<blockquote>
<p>逐行读取，基于事件驱动的。</p>
<ul>
<li>优点：不占内存。</li>
<li>缺点：只能读取，不能增删改</li>
</ul>
</blockquote>
<p>​    </p>
<h2 id="常见的XML解析器"><a href="#常见的XML解析器" class="headerlink" title="常见的XML解析器"></a>常见的XML解析器</h2><blockquote>
<ul>
<li><code>JAXP</code>：sun公司提供的解析器，支持dom和sax两种思想</li>
<li><code>DOM4J</code>：一款非常优秀的解析器</li>
<li><code>Jsoup</code>：Jsoup 是一款Java 的HTML解析器，可直接解析某个URL地址、HTML文本内容。它提供了一套非常省力的API，可通过DOM，CSS以及类似于jQuery的操作方法来取出和操作数据。</li>
<li><code>PULL</code>：Android操作系统内置的解析器，sax方式的。</li>
</ul>
</blockquote>
<h2 id="Jsoup"><a href="#Jsoup" class="headerlink" title="Jsoup"></a>Jsoup</h2><blockquote>
<p>Jsoup是一款Java的<strong>HTML/XML</strong>解析器，可直接解析某个HTML/XML文本内容。</p>
<p>它提供了一套非常省力的API，可通过DOM，CSS以及类似于jQuery的操作方法来取出和操作数据。</p>
</blockquote>
<h3 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h3><blockquote>
<ol>
<li>导入依赖库（jar包/Maven依赖）</li>
<li>获取Document对象</li>
<li>获取对应的标签Element对象</li>
<li>获取数据</li>
</ol>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">// 1、获取student.xml的path</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> JsoupDemo1.class.getClassLoader().getResource(<span class="string">&quot;student.xml&quot;</span>).getPath();</span><br><span class="line">    <span class="comment">// 2、解析xml文档，加载文档进内存，获取dom树---&gt;Document</span></span><br><span class="line">    <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> Jsoup.parse(<span class="keyword">new</span> <span class="title class_">File</span>(path), <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">    <span class="comment">// 3、获取元素对象 Element</span></span><br><span class="line">    <span class="type">Elements</span> <span class="variable">elements</span> <span class="operator">=</span> document.getElementsByTag(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"></span><br><span class="line">    System.out.println(elements.size());</span><br><span class="line">    <span class="comment">// 3.1、获取第一个name的Element对象</span></span><br><span class="line">    <span class="type">Element</span> <span class="variable">element</span> <span class="operator">=</span> elements.get(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 3.2、获取数据</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> element.text();</span><br><span class="line">    System.out.println(name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<h3 id="Jsoup对象"><a href="#Jsoup对象" class="headerlink" title="Jsoup对象"></a>Jsoup对象</h3><blockquote>
<p>Jsoup类是一个工具类，可以解析XML/HTML文档，返回Document对象</p>
</blockquote>
<h4 id="Jsoup对象中的方法（重载）"><a href="#Jsoup对象中的方法（重载）" class="headerlink" title="Jsoup对象中的方法（重载）"></a>Jsoup对象中的方法（重载）</h4><table>
<thead>
<tr>
<th align="center"></th>
<th align="center">方法</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center"><code>parse(String html)</code></td>
<td align="center">解析HTML/XML字符串，返回字符串的DOM对象</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center"><code>parse(File in, String charsetName)</code></td>
<td align="center">解析本地磁盘上的HTML/XML文档，返回文档的DOM对象</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center"><code>parse(URL url, int timeoutMillis)</code></td>
<td align="center">解析指定URL上的的HTML/XML文档，返回文档的DOM对象，<br><code>timeoutMillis</code>是超时时间</td>
</tr>
</tbody></table>
<h4 id="Document对象中的方法"><a href="#Document对象中的方法" class="headerlink" title="Document对象中的方法"></a>Document对象中的方法</h4><blockquote>
<p>Document：这里的Document对象是XML文档的DOM对象，代表内存中的DOM树。与JS中的DOM对象类似但本质上是不同的。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">作用</th>
<th align="center">方法</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">获取Element对象</td>
<td align="center"><code>getElementById(String id)</code></td>
<td align="center">根据id属性值获取唯一的element对象</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"><code>getElementsByTag(String tagName)</code></td>
<td align="center">根据标签名称获取元素对象集合</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"><code>getElementsByAttribute(String key)</code></td>
<td align="center">根据属性名称获取元素对象集合</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"><code>getElementsByAttributeValue(String key, String value)</code></td>
<td align="center">根据对应的属性名和属性值获取元素对象集合</td>
</tr>
</tbody></table>
<h4 id="Elements对象"><a href="#Elements对象" class="headerlink" title="Elements对象"></a>Elements对象</h4><blockquote>
<p>元素Element对象的集合。可以当做 <code>ArrayList&lt;Element&gt;</code>来使用</p>
</blockquote>
<h4 id="Element对象"><a href="#Element对象" class="headerlink" title="Element对象"></a>Element对象</h4><blockquote>
<p>元素对象</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">作用</th>
<th align="center">方法</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1、获取子元素对象</td>
<td align="center"><code>getElementById(String id)</code></td>
<td align="center">根据id属性值获取唯一的element对象</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"><code>getElementsByTag(String tagName)</code></td>
<td align="center">根据标签名称获取元素对象集合</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"><code>getElementsByAttribute(String key)</code></td>
<td align="center">根据属性名称获取元素对象集合</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"><code>getElementsByAttributeValue(String key, String value)</code></td>
<td align="center">根据对应的属性名和属性值获取元素对象集合</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">获取属性值</td>
<td align="center"><code>String attr(String key)</code></td>
<td align="center">根据属性名称获取属性值</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">获取文本内容</td>
<td align="center"><code>String text()</code></td>
<td align="center">获取文本内容</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"><code>String html()</code></td>
<td align="center">获取标签体的所有内容(包括字标签的字符串内容)</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<h4 id="Node对象"><a href="#Node对象" class="headerlink" title="Node对象"></a>Node对象</h4><blockquote>
<p>Node，节点对象，是Document和Element的父类    </p>
</blockquote>
<hr>
<h2 id="XPath"><a href="#XPath" class="headerlink" title="XPath"></a>XPath</h2><ol>
<li>XPath：XPath即为XML路径语言，它是一种用来确定XML（标准通用标记语言的子集）文档中某部分位置的语言。</li>
</ol>
<ul>
<li>使用Jsoup的Xpath需要额外导入类库（jar包/Maven依赖）。</li>
<li>查询w3cshool参考手册，使用xpath的语法完成查询。</li>
</ul>
<ol start="2">
<li><p>代码：</p>
   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.获取student.xml的path</span></span><br><span class="line"><span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> JsoupDemo6.class.getClassLoader().getResource(<span class="string">&quot;student.xml&quot;</span>).getPath();</span><br><span class="line"><span class="comment">//2.获取Document对象</span></span><br><span class="line"><span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> Jsoup.parse(<span class="keyword">new</span> <span class="title class_">File</span>(path), <span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"><span class="comment">//3.根据document对象，创建JXDocument对象</span></span><br><span class="line"><span class="type">JXDocument</span> <span class="variable">jxDocument</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JXDocument</span>(document);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.结合xpath语法查询</span></span><br><span class="line"><span class="comment">//4.1查询所有student标签</span></span><br><span class="line">List&lt;JXNode&gt; jxNodes = jxDocument.selN(<span class="string">&quot;//student&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (JXNode jxNode : jxNodes) &#123;</span><br><span class="line">    System.out.println(jxNode);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.2查询所有student标签下的name标签</span></span><br><span class="line">List&lt;JXNode&gt; jxNodes2 = jxDocument.selN(<span class="string">&quot;//student/name&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (JXNode jxNode : jxNodes2) &#123;</span><br><span class="line">    System.out.println(jxNode);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.3查询student标签下带有id属性的name标签</span></span><br><span class="line">List&lt;JXNode&gt; jxNodes3 = jxDocument.selN(<span class="string">&quot;//student/name[@id]&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (JXNode jxNode : jxNodes3) &#123;</span><br><span class="line">    System.out.println(jxNode);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line"><span class="comment">//4.4查询student标签下带有id属性的name标签 并且id属性值为itcast</span></span><br><span class="line"></span><br><span class="line">List&lt;JXNode&gt; jxNodes4 = jxDocument.selN(<span class="string">&quot;//student/name[@id=&#x27;itcast&#x27;]&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (JXNode jxNode : jxNodes4) &#123;</span><br><span class="line">    System.out.println(jxNode);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.根据document对象，创建JXDocument对象</span></span><br><span class="line"><span class="type">JXDocument</span> <span class="variable">jxDocument</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JXDocument</span>(document);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.结合xpath语法查询</span></span><br><span class="line"><span class="comment">//4.1查询所有student标签</span></span><br><span class="line">List&lt;JXNode&gt; jxNodes = jxDocument.selN(<span class="string">&quot;//student&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (JXNode jxNode : jxNodes) &#123;</span><br><span class="line">    System.out.println(jxNode);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.2查询所有student标签下的name标签</span></span><br><span class="line">List&lt;JXNode&gt; jxNodes2 = jxDocument.selN(<span class="string">&quot;//student/name&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (JXNode jxNode : jxNodes2) &#123;</span><br><span class="line">    System.out.println(jxNode);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.3查询student标签下带有id属性的name标签</span></span><br><span class="line">List&lt;JXNode&gt; jxNodes3 = jxDocument.selN(<span class="string">&quot;//student/name[@id]&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (JXNode jxNode : jxNodes3) &#123;</span><br><span class="line">    System.out.println(jxNode);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line"><span class="comment">//4.4查询student标签下带有id属性的name标签 并且id属性值为itcast</span></span><br><span class="line"></span><br><span class="line">List&lt;JXNode&gt; jxNodes4 = jxDocument.selN(<span class="string">&quot;//student/name[@id=&#x27;itcast&#x27;]&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (JXNode jxNode : jxNodes4) &#123;</span><br><span class="line">    System.out.println(jxNode);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/19/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><span class="page-number current">20</span><a class="page-number" href="/page/21/">21</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/21/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
