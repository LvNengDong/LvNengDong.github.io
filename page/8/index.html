<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.11.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/8/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/8/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/8/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hexo</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Hexo</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>







</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">235</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">69</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/28/Kafka/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/28/Kafka/" class="post-title-link" itemprop="url">Kafka</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-28 20:33:27" itemprop="dateCreated datePublished" datetime="2021-11-28T20:33:27+08:00">2021-11-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-11-29 11:21:19" itemprop="dateModified" datetime="2021-11-29T11:21:19+08:00">2021-11-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" itemprop="url" rel="index"><span itemprop="name">消息队列</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="消息队列"><a href="#消息队列" class="headerlink" title="消息队列"></a>消息队列</h1><h2 id="消息队列的应用场景"><a href="#消息队列的应用场景" class="headerlink" title="消息队列的应用场景"></a>消息队列的应用场景</h2><ul>
<li>  异步处理</li>
</ul>
<h2 id="消息队列的两种模式"><a href="#消息队列的两种模式" class="headerlink" title="消息队列的两种模式"></a>消息队列的两种模式</h2><h3 id="点对点模式"><a href="#点对点模式" class="headerlink" title="点对点模式"></a>点对点模式</h3><p><strong>特点：</strong></p>
<ol>
<li> 一对一，</li>
<li> 消费者主动从消费队列中拉取数据，</li>
<li> MQ 会自动把消费者已经收到的消息清除。【因为每条 message 只存在一个消费者】</li>
</ol>
<p><strong>流程：</strong></p>
<img src="/2021/11/28/Kafka/image-20211128204651428.png" alt="image-20211128204651428" style="zoom:150%;">

<ol>
<li> 生产者 Producer 生产消息发送到 MessageQueue 中，然后消费者 Consumer 从 MQ 中取出并且消费消息。</li>
<li> 消息被消费以后，Consumer 会向 MQ 发送确认，当 MQ 收到确认后，就会自动从 queue 中删除该条消息。所以消息消费者不可能消费到已经被消费的消息。</li>
</ol>
<p><strong>说明：</strong></p>
<p>在点对点模式下，MQ 支持存在多个消费者，但是对某一个消息而言，只会存在一个消费者可以消费该条消息。</p>
<hr>
<h3 id="发布-订阅模式"><a href="#发布-订阅模式" class="headerlink" title="发布/订阅模式"></a>发布/订阅模式</h3><p><strong>特点：</strong></p>
<ul>
<li>  一对多，</li>
<li>  消费者消费数据之后不会清除消息【因为每条 message 可能存在多个消费者，所以该条 message 的删除时机是不确定的，一般是在消息队列满了之后由开发人员自行设置删除策略的】</li>
</ul>
<p><strong>流程：</strong></p>
<p>消息生产者 Producer 将消息发布到 Topic 中，同时有多个消费者 Consumer（订阅）消费该消息。和点对点方式不同，发布到 Topic 的消息会被所有订阅者消费。</p>
<p> <img src="/2021/11/28/Kafka/image-20211128205611922.png" alt="image-20211128205611922"></p>
<hr>
<h1 id="Kafka-简介"><a href="#Kafka-简介" class="headerlink" title="Kafka 简介"></a>Kafka 简介</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>Kafka 是一个分布式的基于<strong>发布/订阅模式</strong>的消息队列（Message Queue），主要应用于大数据实时处理领域。</p>
<p>Kafka 是一个分布式的数据流式传输平台。在流式计算中，Kafka 一般用来缓存数据，Spark 通过消费 Kafka 中的数据来进行计算。</p>
<ol>
<li> Apache Kafka 是由 Scala 语言编写的，Scala 语言编译后的文件可以运行在 JVM 虚拟机上。</li>
<li> Kafka 的目标是为处理<strong>实时数据</strong>提供一个统一、高通量、低等待的平台。</li>
<li> Kafka 是一个分布式消息队列。</li>
<li> Kafka 保存消息时会根据消息的 Topic 进行归类。</li>
<li> Kafka 集群由多个 kafka 实例组成，每个实例（server）称为 <strong>broker</strong>。</li>
<li> 无论是 kafka 集群，还是 consumer 都依赖于 <strong>zookeeper</strong> 集群保存一些meta信息，来保证系统可用性。</li>
</ol>
<hr>
<h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2><p>作为一个数据流式传输平台，kafka有以下三大特点：</p>
<ol>
<li> 类似于消息队列和商业的消息系统，kafka 提供对流式数据的发布和订阅</li>
<li> kafka 提供一种<strong>持久</strong>的<strong>容错</strong>的方式存储流式数据【持久：支持持久化。容错：采用多副本机制支持容错】</li>
<li> kafka 拥有良好的性能，可以近实时地处理流式数据</li>
</ol>
<p>基于以上三种特点，kafka 在以下两种应用之间流行：</p>
<ol>
<li> 需要在多个应用和系统间建立高可靠的实时数据通道</li>
<li> 一些需要实时传输数据及及时计算的应用</li>
</ol>
<p>此外，kafka 还有以下特点：</p>
<ul>
<li>  Kafka 集群将数据按照类别记录存储，这种类别在 kafka 中称为主题（Topic）</li>
<li>  每条记录由一个键，一个值和一个时间戳组成</li>
</ul>
<hr>
<h1 id="Kafka核心概念"><a href="#Kafka核心概念" class="headerlink" title="Kafka核心概念"></a>Kafka核心概念</h1><h2 id="Broker"><a href="#Broker" class="headerlink" title="Broker"></a>Broker</h2><blockquote>
<p>  <code>broker，代理</code></p>
</blockquote>
<p>Kafka 集群中的每台服务器都是 broker，一个集群由多个 broker 组成。</p>
<hr>
<h2 id="Topic"><a href="#Topic" class="headerlink" title="Topic"></a>Topic</h2><p>Topic 就是数据的主题，kafka 建议将不同的数据存放在不同的 Topic 中。</p>
<p>Topic 是对于数据的逻辑分类，即一个 Topic 的数据可以分布式存储在不同 broker 上。</p>
<p>一个 Topic 可以拥有一个或者多个消费者来订阅它的数据。</p>
<p>Topic 可以类比为数据库中的库。</p>
<hr>
<h2 id="Partition"><a href="#Partition" class="headerlink" title="Partition"></a>Partition</h2><p>Partition 是对数据的物理分区，每个 Topic 中的数据可以存储在多个分区上。通过分区的设计，Topic 可以不断进行扩展，即一个 Topic 的多个分区分布式存储在多个 broker 上。</p>
<p>此外通过分区还可以让一个 Topic 中的数据被多个 consumer 并行的进行消费。</p>
<p>Kafka 只能保证一个 partition 中的消息顺序地发给 consumer，不保证一个 topic 的整体（多个partition间）的顺序。</p>
<p>分区可以类比为数据库中的表。</p>
<hr>
<h2 id="Offset"><a href="#Offset" class="headerlink" title="Offset"></a>Offset</h2><p>Partition 是 Kafka 中数据的存储的物理单位，每个分区中的数据会按照写入的时间顺序按顺序保存，这个顺序是通过一个称之为 <code>offset</code> 的 id 来唯一标识的，因此也可以认为offset是有序且不可变的。</p>
<p>数据会按照时间顺序被不断第追加到分区中的一个结构化的 commit log中。每个分区中存储的记录都是有序的，且顺序不可变。</p>
<p>在每个消费者端，会唯一保存的元数据是 <code>offset（偏移量）</code>，即消费在 log 中的位置（消费者消费到了第几条数据），偏移量由消费者控制。通常在读取记录后，消费者会以线性的方式增加偏移量，但是实际上，由于这个位置由消费者控制，所以消费者可以采用任何顺序来消费记录。例如，一个消费者可以重置到一个旧的偏移量，从而重新处理过去的数据；也可以跳过最近的记录，从”现在”开始消费。</p>
<p>这些细节说明 Kafka 消费者是非常廉价的——消费者的增加和减少，对集群或者其他消费者没有多大的影响。比如，你可以使用命令行工具，对一些 topic 内容执行 tail 操作，并不会影响已存在的消费者消费数据。</p>
<blockquote>
<p>  图1 Topic拓扑结构</p>
</blockquote>
<p> <img src="/2021/11/28/Kafka/image-20211128213939763.png" alt="image-20211128213939763"></p>
<blockquote>
<p>  图2 数据流</p>
</blockquote>
<p><img src="/2021/11/28/Kafka/image-20211128213950934.png" alt="image-20211128213950934"></p>
<hr>
<h2 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h2><p>Kafka 集群会保留所有发布的记录，无论它们是否已被消费。</p>
<p>如果想要删除发布记录，可以通过配置保留期限参数来控制。举个例子，如果保留策略设置为2天，一条记录发布后两天内，可以随时被消费，两天过后这条记录会被清除并释放磁盘空间。</p>
<p>Kafka 的性能和数据大小无关，所以长时间存储数据没有什么问题。</p>
<hr>
<h2 id="副本机制"><a href="#副本机制" class="headerlink" title="副本机制"></a>副本机制</h2><p>Kafka 通过副本机制来保证高可用。</p>
<p>日志的分区 partition （分布）在Kafka集群的服务器上。每个服务器在处理数据和请求时，共享这些分区。每一个分区都会在已配置的服务器上进行备份，确保容错性。</p>
<p>每个分区都有一台 server 作为 “leader”，零台或者多台 server 作为 follwers。leader server 处理一切对 partition （分区）的读写请求，而 follwers 只需被动的同步 leader 上的数据。当 leader 宕机了，followers 中的一台服务器会自动成为新的 leader。通过这种机制，既可以保证数据有多个副本，也实现了一个高可用的机制！</p>
<p>基于安全考虑，每个分区的Leader和follower一般会错在在不同的broker!</p>
<h2 id="Producer"><a href="#Producer" class="headerlink" title="Producer"></a>Producer</h2><p>消息生产者，就是向 <code>kafka broker</code> 发消息的客户端，生产者负责将消息分配到 topic 的指定 partition（分区）中。</p>
<h2 id="Consumer"><a href="#Consumer" class="headerlink" title="Consumer"></a>Consumer</h2><p>消息消费者，向 <code>kafka broker</code> 取消息的客户端。每个消费者都要维护自己读取数据的 offset。</p>
<p>0.9 之前的低版本 kafka 将 offset 保存在 Zookeeper 中，0.9及之后保存在 Kafka 的 <code>__consumer_offsets</code> 主题中。</p>
<hr>
<h2 id="Consumer-Group"><a href="#Consumer-Group" class="headerlink" title="Consumer Group"></a>Consumer Group</h2><p>每个消费者都会使用一个消费组名称来进行标识。同一个组中的不同的消费者实例，可以分布在多个进程或多个机器上！</p>
<p>如果所有的消费者实例在同一消费组中，消息记录会负载平衡到每一个消费者实例（单播）。即每个消费者可以同时读取一个topic的不同分区！</p>
<p>如果所有的消费者实例在不同的消费组中，每条消息记录会广播到所有的消费者进程(广播)。</p>
<p>如果需要实现广播，只要每个consumer有一个独立的组就可以了。要实现单播只要所有的consumer在同一个组。</p>
<p>一个topic可以有多个consumer group。topic的消息会复制（不是真的复制，是概念上的）到所有的CG，但每个partion只会把消息发给该CG中的一个consumer。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/25/HttpServletRequest%E5%92%8CHttpServletResponse/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/25/HttpServletRequest%E5%92%8CHttpServletResponse/" class="post-title-link" itemprop="url">HttpServletRequest和HttpServletResponse</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-25 22:24:14" itemprop="dateCreated datePublished" datetime="2021-11-25T22:24:14+08:00">2021-11-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-11-26 18:03:37" itemprop="dateModified" datetime="2021-11-26T18:03:37+08:00">2021-11-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/JavaWeb/" itemprop="url" rel="index"><span itemprop="name">JavaWeb</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <ul>
<li>Request 对象和 Response 对象是 TomCat 服务器在监听到请求后由 Servlet 程序自动创建的，我们可以在 Servlet 的实现类中直接使用。</li>
<li>Request 对象是用来获取请求消息的，Response 对象是用来返回响应消息的。</li>
</ul>
<h1 id="1-Request"><a href="#1-Request" class="headerlink" title="1    Request"></a>1    Request</h1><h3 id="6-1-1-Request对象的继承结构"><a href="#6-1-1-Request对象的继承结构" class="headerlink" title="6.1.1    Request对象的继承结构"></a>6.1.1    Request对象的继承结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ServletRequest		-- 接口</span><br><span class="line">	|（继承）</span><br><span class="line">HttpServletRequest		-- 接口</span><br><span class="line">	|（实现）</span><br><span class="line">org.apache.catalina.connector.RequestFacade 	--类（TomCat创建的）</span><br></pre></td></tr></table></figure>

<h3 id="6-1-2-HttpServletRequest"><a href="#6-1-2-HttpServletRequest" class="headerlink" title="6.1.2    HttpServletRequest"></a>6.1.2    HttpServletRequest</h3><h4 id="1、HttpServletRequest-有什么作用？"><a href="#1、HttpServletRequest-有什么作用？" class="headerlink" title="1、HttpServletRequest 有什么作用？"></a>1、HttpServletRequest 有什么作用？</h4><ol>
<li>TomCat 服务器会一直监听客户端的请求，并把请求消息中携带的信息封装到 ServletRequest 接口的实现类对象中；</li>
<li>通过 Servlet 对象的 <code>service()</code>方法（或者 <code>doGet()</code> 和 <code>doPos()</code> 方法）可以获取到这个实现类对象；</li>
<li>通过<code>HttpServletRequest</code> 的子类实例对象，获取到客户端请求消息中包含的信息；</li>
<li>在<code>service()</code>方法中处理请求并作出响应，将响应结果封装到<code>HttpServletResponse</code>的实现类对象中，返回给客户端。</li>
</ol>
<h4 id="2、HttpServletRequest类中的方法："><a href="#2、HttpServletRequest类中的方法：" class="headerlink" title="2、HttpServletRequest类中的方法："></a>2、HttpServletRequest类中的方法：</h4><h5 id="1、获取请求消息中的数据的方法"><a href="#1、获取请求消息中的数据的方法" class="headerlink" title="1、获取请求消息中的数据的方法"></a>1、获取请求消息中的数据的方法</h5><ol>
<li><p><strong>获取请求行数据</strong>：</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
<th align="left">例子</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left">获取请求消息的请求方式</td>
<td align="left"><code>String getMethod()</code></td>
<td align="left"><code>GET</code></td>
</tr>
<tr>
<td align="center">2</td>
<td align="left">获取访问路径(url-pattern)</td>
<td align="left"><code>String getServletPath()</code></td>
<td align="left"><code>/demo01</code></td>
</tr>
<tr>
<td align="center">3</td>
<td align="left">获取请求参数[只适用于GET请求]</td>
<td align="left"><code>String getQueryString()</code></td>
<td align="left"><code>name=zhangsan</code></td>
</tr>
<tr>
<td align="center">4</td>
<td align="left">获取URI（统一资源标识符）</td>
<td align="left"><code>String getRequestURI()</code></td>
<td align="left"><code>/day14/demo01</code></td>
</tr>
<tr>
<td align="center">5</td>
<td align="left">获取URL（统一资源定位符）</td>
<td align="left"><code>StringBuffer getRequestURL()</code></td>
<td align="left"><code>http://localhost/day14/demo01</code></td>
</tr>
<tr>
<td align="center">6</td>
<td align="left">获取协议及版本信息</td>
<td align="left"><code>String getProtocol()</code></td>
<td align="left">-</td>
</tr>
<tr>
<td align="center">7</td>
<td align="left">获取客户机的IP地址</td>
<td align="left"><code>String getRemoteHost()</code></td>
<td align="left">-</td>
</tr>
<tr>
<td align="center"></td>
<td align="left"></td>
<td align="left"><code>String getRemoteAddr()</code></td>
<td align="left">-</td>
</tr>
</tbody></table>
<ul>
<li><code>ServletRequest</code> 接口中没有定义<code>getMethod()</code>方法，<code>HttpServletRequest</code>接口中才开始定义该方法，所以如果想要使用该方法，自定义的类必须实现 <code>HttpServletRequest</code>接口。</li>
</ul>
</li>
<li><p><strong>获取请求头数据</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left"><code>Enumeration&lt;String&gt; getHeaderNames()</code></td>
<td align="left">获取所有请求头的名称</td>
</tr>
<tr>
<td align="center">2</td>
<td align="left"><code>String getHeader(String name)</code></td>
<td align="left">通过请求头的名称获取请求头的值</td>
</tr>
</tbody></table>
</li>
<li><p><strong>获取请求体数据</strong>[<strong>POST请求专有</strong>]</p>
<p> <code>ServletRequest</code> 接口会将 Request 请求消息中的请求体封装到一个<strong>数据流对象</strong>中，只有获得了这个流对象，就可以从流对象中读取到<strong>请求体数据</strong>。所以说获取请求体的数据可分为2步实现：</p>
<ol>
<li>获取数据流对象</li>
<li>从流对象中读取请求体数据</li>
</ol>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td align="left">获取流对象</td>
<td align="left"></td>
</tr>
<tr>
<td align="center">1</td>
<td align="left"><code>BufferedReader getReader()</code></td>
<td align="left">获取字符输入流</td>
</tr>
<tr>
<td align="center">2</td>
<td align="left"><code>ServletInputStream getInputStream()</code></td>
<td align="left">获取字节输入流</td>
</tr>
<tr>
<td align="center"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="center"></td>
<td align="left">从流对象中读取数据</td>
<td align="left">参考File对象</td>
</tr>
</tbody></table>
</li>
<li><p><strong>获取请求参数的通用方法</strong>：</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left"><code>String getParameter(String name)</code></td>
<td align="left">根据请求参数的key获取value</td>
</tr>
<tr>
<td align="center">2</td>
<td align="left"><code>String[] getParameterValues(String name)</code></td>
<td align="left">根据请求参数的key获取value数组</td>
</tr>
<tr>
<td align="center">3</td>
<td align="left"><code>Enumeration&lt;String&gt; getParameterNames()</code></td>
<td align="left">获取所有请求参数的key</td>
</tr>
<tr>
<td align="center">4</td>
<td align="left"><code>Map&lt;String,String[]&gt; getParameterMap()</code></td>
<td align="left">获取所有参数的Map集合</td>
</tr>
</tbody></table>
</li>
<li><p><strong>其它[☆]</strong></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left"><code>getAtrribute(key)</code></td>
<td align="left">获取Request共享域中的数据</td>
</tr>
<tr>
<td align="center">2</td>
<td align="left"><code>getRequestDispatcher(String path)</code></td>
<td align="left">获取请求转发对象</td>
</tr>
</tbody></table>
</li>
</ol>
<h5 id="2、修改请求消息中数据的方法"><a href="#2、修改请求消息中数据的方法" class="headerlink" title="2、修改请求消息中数据的方法"></a>2、修改请求消息中数据的方法</h5><table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left"><code>setAttribute(key, value)</code></td>
<td align="left">向Request共享域中添加数据</td>
</tr>
<tr>
<td align="center">2</td>
<td align="left"><code>setCharacterEncoding(&quot;utf-8&quot;)</code></td>
<td align="left">设置请求体的编码方式为utf-8</td>
</tr>
<tr>
<td align="center"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="center"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<ol>
<li><p><strong>中文乱码问题</strong></p>
<blockquote>
<p>GET方式</p>
<ul>
<li>TomCat 8++之后已经将GET提交中文乱码的问题解决了。</li>
</ul>
<p>POST方式：</p>
<ul>
<li>在获取请求体之前，先通过Request对象设置请求体的编码方式</li>
</ul>
</blockquote>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.先设置请求体的编码方式为utf-8</span></span><br><span class="line">request.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line"><span class="comment">// 2.根据参数名称获取参数值</span></span><br><span class="line">String <span class="title function_">getParameter</span><span class="params">(String name)</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Tip：一定要在获取请求参数之前调用该方法，加入你要获取的请求参数有多个，但是只有最后一个会出现乱码，也必须在获取获取第一个请求参数之前调用<code>setCharacterEncoding()</code>方法，否则该方法不会生效。</p>
</blockquote>
</li>
</ol>
<h4 id="3、请求转发"><a href="#3、请求转发" class="headerlink" title="3、请求转发"></a>3、请求转发</h4><blockquote>
<p><strong>请求转发</strong>是指：服务器收到请求后，从一个资源跳到另一个资源的操作。</p>
<ul>
<li>请求转发是一种服务内部的资源跳转方式。</li>
</ul>
</blockquote>
<h5 id="3-1、为什么要使用请求转发？"><a href="#3-1、为什么要使用请求转发？" class="headerlink" title="3.1、为什么要使用请求转发？"></a>3.1、为什么要使用请求转发？</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">客户端通过浏览器访问服务器资源； </span><br><span class="line">--&gt;&gt; </span><br><span class="line">在服务器内部，我们希望服务器是&quot;高内聚、低耦合&quot;的，尽量让每个类满足单一职责要求。	这种情况下，客户端要访问的资源就不可能只存储在一个类中，也就是说客户端一次请求所需要的资源需要在服务器的同一个工程下的多个类中获取。这时候就需要请求转发了；</span><br><span class="line">--&gt;&gt; </span><br><span class="line">请求转发规定了一块范围，这块范围内的所有数据可以共享。</span><br></pre></td></tr></table></figure>

<p><img src="/2021/11/25/HttpServletRequest%E5%92%8CHttpServletResponse/image-20200519150806643-1597652154014.png" alt="image-20200519150806643"></p>
<h5 id="3-2、请求转发的特点"><a href="#3-2、请求转发的特点" class="headerlink" title="3.2、请求转发的特点"></a>3.2、请求转发的特点</h5><blockquote>
<ul>
<li>浏览器的地址栏路径不会发生变化。</li>
<li>只能转发到当前Web工程的子资源中。</li>
<li>请求转发是一次请求。</li>
<li>请求转发可以访问到<code>WEB-INF</code>目录下。[<code>WEB-INF</code>是受保护的目录，浏览器不能直接访问到该目录]</li>
</ul>
</blockquote>
<h5 id="3-3、Request共享域"><a href="#3-3、Request共享域" class="headerlink" title="3.3、Request共享域"></a>3.3、Request共享域</h5><blockquote>
<ul>
<li><p><code>request共享域</code>：代表一次请求的范围，一般用于请求转发的多个资源间共享数据。</p>
</li>
<li><p>共享数据必须被保存到共享域中才能被该共享域中的其它对象访问到。</p>
</li>
</ul>
</blockquote>
<p>常用方法：</p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left"><code>void setAttribute(String name, Object obj)</code></td>
<td align="left">添加Map数据到Request共享域中</td>
</tr>
<tr>
<td align="center">2</td>
<td align="left"><code>Object getAttribute(String name)</code></td>
<td align="left">从Request共享域中通过键获取值</td>
</tr>
<tr>
<td align="center">3</td>
<td align="left"><code>void removeAttribute(String name)</code></td>
<td align="left">通过键删除键值对</td>
</tr>
</tbody></table>
<h5 id="3-4-请求转发的步骤"><a href="#3-4-请求转发的步骤" class="headerlink" title="3.4    请求转发的步骤"></a>3.4    请求转发的步骤</h5><ol>
<li><p>通过Request对象获取<em>请求转发器</em>对象：</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">RequestDispatcher <span class="title function_">getRequestDispatcher</span><span class="params">(String path)</span></span><br><span class="line"><span class="comment">// 如：</span></span><br><span class="line">    req.getRequestDispatcher(String path)	<span class="comment">// 参数为要转发的地址的资源路径url-pattern</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	请求转发必须要以 &quot;/&quot; 开头，斜杠表示绝对路径，地址为：</span></span><br><span class="line"><span class="comment">		http://ip:port/工程名/</span></span><br><span class="line"><span class="comment">	映射到IDEA代码的WEB目录</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
<li><p>使用<code>RequestDispatcher</code>转发器对象来进行转发：</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	请求转发是一次请求，但是要访问多个资源。所有的请求信息都包含在第一次请求中，所有的响应消息都在最后一次请求完毕后返回给用户。</span></span><br><span class="line"><span class="comment">	所以在转发的时候，要把	客户端的 请求和响应 同时转发给下一个服务器资源对象 </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">forward(ServletRequest req, Servletresponse resp)</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="3-5-lt-Base-gt-标签的作用"><a href="#3-5-lt-Base-gt-标签的作用" class="headerlink" title="3.5    &lt;Base&gt;标签的作用"></a>3.5    <code>&lt;Base&gt;</code>标签的作用</h5><ul>
<li><p><code>&lt;Base&gt;</code>标签可以设置当前页面中所有相对路径的参考路径</p>
</li>
<li><p>我们在WEB目录下新建两个HTML项目</p>
<ol>
<li><p><code>index.html</code>：这是一个首页，可以跳转到<code>c.html</code>，也可以跳转到转发器ForwardC，通过转发器转发到<code>c.html</code></p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>首页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;a/b/c.html&quot;</span>&gt;</span>跳转到网页C<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://localhost:8080/D1/demo06&quot;</span>&gt;</span>调到转发器，转发器转发到网页C<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p><code>a/b/c.html</code>：这是C页面，可以跳转回首页（<code>index.html</code>）【通过相对路径跳转】</p>
 <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>这里是C网页<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--添加&lt;base&gt;标签--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;http://localhost:8080/D1/a/b/c.html&quot;</span>&gt;</span>	 </span><br><span class="line"><span class="comment">&lt;!--&lt;base href=&quot;http://localhost:8080/D1/a/b/&quot;&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--文件名可以省略，斜杠不能省略。[省略斜杠会让b默认是文件，而不是文件夹]--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;../../index.html&quot;</span>&gt;</span>跳转到首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
<li><p><code>ForwardC.java</code>：这是一个Java类，里面有一个转发器，跳转到C网页（<code>c.html</code>）</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo06_ForwardC</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;这里是转发器ForwardC&quot;</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            WEB目录下的首页 index.html --&gt;&gt; 转发器ForwardC --&gt;&gt; WEB/a/b/c.html</span></span><br><span class="line"><span class="comment">	   */</span></span><br><span class="line">        <span class="type">RequestDispatcher</span> <span class="variable">requestDispatcher</span> <span class="operator">=</span> req.getRequestDispatcher(<span class="string">&quot;/a/b/c.html&quot;</span>);</span><br><span class="line">        requestDispatcher.forward(req, resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</li>
</ol>
</li>
</ul>
<p><img src="/2021/11/25/HttpServletRequest%E5%92%8CHttpServletResponse/image-20200519154532869-1597652154015.png" alt="image-20200519154532869"></p>
<ul>
<li><p>如果不使用<code>&lt;base&gt;</code>，经过转发器转发后，<code>c.html</code>返回首页的链接就会以转发器所在的<code>ForwardC.java</code>类的绝对路径为标准进行相对查找，这样找到的路径是不对的。</p>
</li>
<li><p>所以我们必须设置一个具有参考意义的绝对路径，让每次执行跳转到首页的操作时参考该路径，就不会出现转发器转发后路径错误的现象。</p>
</li>
<li><p><code>&lt;Base&gt;</code>标签可以设置当前页面中所有相对路径的参考路径，该参考路径为绝对路径。</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//ip:port/工程路径/[资源路径] </span></span><br><span class="line"><span class="comment">// 资源路径可以省略</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h1 id="2-Response"><a href="#2-Response" class="headerlink" title="2    Response"></a>2    Response</h1><h2 id="2-1-HttpServletResopnse"><a href="#2-1-HttpServletResopnse" class="headerlink" title="2.1    HttpServletResopnse"></a>2.1    HttpServletResopnse</h2><p>TomCat 服务器在运行时会维护 <code>HttpServletResponse</code> 接口和 <code>HttpServletRequest</code> 接口的实现类对象，每当服务器监听到请求消息时，就会为该请求创建一对 Request 的实现类对象和 Response 的实现类类对象。</p>
<p><code>HttpServletRequest</code> 对象用于封装客户端的请求数据，<code>HttpServletResponse</code> 对象则用于封装服务器的响应数据。</p>
<p>TomCat 会进一步把 <code>HttpServletResponse</code> 对象响应给客户端。</p>
<hr>
<h2 id="HttpServletResopnse-源码分析"><a href="#HttpServletResopnse-源码分析" class="headerlink" title="HttpServletResopnse 源码分析"></a>HttpServletResopnse 源码分析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet.http;	<span class="comment">// Servlet包下的API</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.function.Supplier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">1、继承自 ServletResponse 接口</span></span><br><span class="line"><span class="comment">2、实现了基于 HTTP 协议的响应相关的功能</span></span><br><span class="line"><span class="comment">3、分析：ServletResponse 是一个更为宽泛的概念，所有的响应（不仅仅局限于HTTP，包括RPC响应等等）</span></span><br><span class="line"><span class="comment">消息都需要实现这个接口，而 HttpServletResponse 只是 HTTP 协议关于响应消息的一个实现</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">HttpServletResponse</span> <span class="keyword">extends</span> <span class="title class_">ServletResponse</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1、添加指定的cookie到响应体。</span></span><br><span class="line"><span class="comment">     * 2、可以多次调用此方法添加多个cookie。 </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCookie</span><span class="params">(Cookie cookie)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 作用：返回一个Boolean值，判断响应头 response header 中是否含有某个值，</span></span><br><span class="line"><span class="comment">     * 常用于判断响应头中是否含有某个值，如果有就删除/替换（没有就添加）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">containsHeader</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Encodes the specified URL by including the session ID in it, or, if</span></span><br><span class="line"><span class="comment">     * encoding is not needed, returns the URL unchanged. The implementation of</span></span><br><span class="line"><span class="comment">     * this method includes the logic to determine whether the session ID needs</span></span><br><span class="line"><span class="comment">     * to be encoded in the URL. For example, if the browser supports cookies,</span></span><br><span class="line"><span class="comment">     * or session tracking is turned off, URL encoding is unnecessary.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * For robust session tracking, all URLs emitted by a servlet should be run</span></span><br><span class="line"><span class="comment">     * through this method. Otherwise, URL rewriting cannot be used with</span></span><br><span class="line"><span class="comment">     * browsers which do not support cookies.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">     *            the url to be encoded.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the encoded URL if encoding is needed; the unchanged URL</span></span><br><span class="line"><span class="comment">     *         otherwise.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encodeURL</span><span class="params">(String url)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Encodes the specified URL for use in the &lt;code&gt;sendRedirect&lt;/code&gt; method</span></span><br><span class="line"><span class="comment">     * or, if encoding is not needed, returns the URL unchanged. The</span></span><br><span class="line"><span class="comment">     * implementation of this method includes the logic to determine whether the</span></span><br><span class="line"><span class="comment">     * session ID needs to be encoded in the URL. Because the rules for making</span></span><br><span class="line"><span class="comment">     * this determination can differ from those used to decide whether to encode</span></span><br><span class="line"><span class="comment">     * a normal link, this method is separated from the &lt;code&gt;encodeURL&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     * method.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * All URLs sent to the &lt;code&gt;HttpServletResponse.sendRedirect&lt;/code&gt; method</span></span><br><span class="line"><span class="comment">     * should be run through this method. Otherwise, URL rewriting cannot be</span></span><br><span class="line"><span class="comment">     * used with browsers which do not support cookies.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">     *            the url to be encoded.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the encoded URL if encoding is needed; the unchanged URL</span></span><br><span class="line"><span class="comment">     *         otherwise.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #sendRedirect</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #encodeUrl</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encodeRedirectURL</span><span class="params">(String url)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">     *            the url to be encoded.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the encoded URL if encoding is needed; the unchanged URL</span></span><br><span class="line"><span class="comment">     *         otherwise.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@deprecated</span> As of version 2.1, use encodeURL(String url) instead</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encodeUrl</span><span class="params">(String url)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">     *            the url to be encoded.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the encoded URL if encoding is needed; the unchanged URL</span></span><br><span class="line"><span class="comment">     *         otherwise.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@deprecated</span> As of version 2.1, use encodeRedirectURL(String url) instead</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encodeRedirectUrl</span><span class="params">(String url)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sends an error response to the client using the specified status code and</span></span><br><span class="line"><span class="comment">     * clears the output buffer. The server defaults to creating the response to</span></span><br><span class="line"><span class="comment">     * look like an HTML-formatted server error page containing the specified</span></span><br><span class="line"><span class="comment">     * message, setting the content type to &quot;text/html&quot;, leaving cookies and</span></span><br><span class="line"><span class="comment">     * other headers unmodified. If an error-page declaration has been made for</span></span><br><span class="line"><span class="comment">     * the web application corresponding to the status code passed in, it will</span></span><br><span class="line"><span class="comment">     * be served back in preference to the suggested msg parameter.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * If the response has already been committed, this method throws an</span></span><br><span class="line"><span class="comment">     * IllegalStateException. After using this method, the response should be</span></span><br><span class="line"><span class="comment">     * considered to be committed and should not be written to.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sc</span></span><br><span class="line"><span class="comment">     *            the error status code</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> msg</span></span><br><span class="line"><span class="comment">     *            the descriptive message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IOException</span></span><br><span class="line"><span class="comment">     *                If an input or output exception occurs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IllegalStateException</span></span><br><span class="line"><span class="comment">     *                If the response was committed</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendError</span><span class="params">(<span class="type">int</span> sc, String msg)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sends an error response to the client using the specified status code and</span></span><br><span class="line"><span class="comment">     * clears the buffer. This is equivalent to calling &#123;<span class="doctag">@link</span> #sendError(int,</span></span><br><span class="line"><span class="comment">     * String)&#125; with the same status code and &lt;code&gt;null&lt;/code&gt; for the message.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sc</span></span><br><span class="line"><span class="comment">     *            the error status code</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IOException</span></span><br><span class="line"><span class="comment">     *                If an input or output exception occurs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IllegalStateException</span></span><br><span class="line"><span class="comment">     *                If the response was committed before this method call</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendError</span><span class="params">(<span class="type">int</span> sc)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sends a temporary redirect response to the client using the specified</span></span><br><span class="line"><span class="comment">     * redirect location URL. This method can accept relative URLs; the servlet</span></span><br><span class="line"><span class="comment">     * container must convert the relative URL to an absolute URL before sending</span></span><br><span class="line"><span class="comment">     * the response to the client. If the location is relative without a leading</span></span><br><span class="line"><span class="comment">     * &#x27;/&#x27; the container interprets it as relative to the current request URI.</span></span><br><span class="line"><span class="comment">     * If the location is relative with a leading &#x27;/&#x27; the container interprets</span></span><br><span class="line"><span class="comment">     * it as relative to the servlet container root.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * If the response has already been committed, this method throws an</span></span><br><span class="line"><span class="comment">     * IllegalStateException. After using this method, the response should be</span></span><br><span class="line"><span class="comment">     * considered to be committed and should not be written to.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> location</span></span><br><span class="line"><span class="comment">     *            the redirect location URL</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IOException</span></span><br><span class="line"><span class="comment">     *                If an input or output exception occurs</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IllegalStateException</span></span><br><span class="line"><span class="comment">     *                If the response was committed or if a partial URL is given</span></span><br><span class="line"><span class="comment">     *                and cannot be converted into a valid URL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendRedirect</span><span class="params">(String location)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets a response header with the given name and date-value. The date is</span></span><br><span class="line"><span class="comment">     * specified in terms of milliseconds since the epoch. If the header had</span></span><br><span class="line"><span class="comment">     * already been set, the new value overwrites the previous one. The</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;containsHeader&lt;/code&gt; method can be used to test for the presence</span></span><br><span class="line"><span class="comment">     * of a header before setting its value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     *            the name of the header to set</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     *            the assigned date value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #containsHeader</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #addDateHeader</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDateHeader</span><span class="params">(String name, <span class="type">long</span> date)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Adds a response header with the given name and date-value. The date is</span></span><br><span class="line"><span class="comment">     * specified in terms of milliseconds since the epoch. This method allows</span></span><br><span class="line"><span class="comment">     * response headers to have multiple values.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     *            the name of the header to set</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> date</span></span><br><span class="line"><span class="comment">     *            the additional date value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setDateHeader</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addDateHeader</span><span class="params">(String name, <span class="type">long</span> date)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets a response header with the given name and value. If the header had</span></span><br><span class="line"><span class="comment">     * already been set, the new value overwrites the previous one. The</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;containsHeader&lt;/code&gt; method can be used to test for the presence</span></span><br><span class="line"><span class="comment">     * of a header before setting its value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     *            the name of the header</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     *            the header value If it contains octet string, it should be</span></span><br><span class="line"><span class="comment">     *            encoded according to RFC 2047</span></span><br><span class="line"><span class="comment">     *            (http://www.ietf.org/rfc/rfc2047.txt)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #containsHeader</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #addHeader</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHeader</span><span class="params">(String name, String value)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Adds a response header with the given name and value. This method allows</span></span><br><span class="line"><span class="comment">     * response headers to have multiple values.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     *            the name of the header</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     *            the additional header value If it contains octet string, it</span></span><br><span class="line"><span class="comment">     *            should be encoded according to RFC 2047</span></span><br><span class="line"><span class="comment">     *            (http://www.ietf.org/rfc/rfc2047.txt)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setHeader</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addHeader</span><span class="params">(String name, String value)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets a response header with the given name and integer value. If the</span></span><br><span class="line"><span class="comment">     * header had already been set, the new value overwrites the previous one.</span></span><br><span class="line"><span class="comment">     * The &lt;code&gt;containsHeader&lt;/code&gt; method can be used to test for the</span></span><br><span class="line"><span class="comment">     * presence of a header before setting its value.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     *            the name of the header</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     *            the assigned integer value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #containsHeader</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #addIntHeader</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIntHeader</span><span class="params">(String name, <span class="type">int</span> value)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Adds a response header with the given name and integer value. This method</span></span><br><span class="line"><span class="comment">     * allows response headers to have multiple values.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     *            the name of the header</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     *            the assigned integer value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setIntHeader</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addIntHeader</span><span class="params">(String name, <span class="type">int</span> value)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the status code for this response. </span></span><br><span class="line"><span class="comment">     * 设置响应状态码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStatus</span><span class="params">(<span class="type">int</span> sc)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the status code and message for this response.</span></span><br><span class="line"><span class="comment">     * 设置响应状态码和响应消息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStatus</span><span class="params">(<span class="type">int</span> sc, String sm)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the HTTP status code for this Response.</span></span><br><span class="line"><span class="comment">     * 获取响应状态码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getStatus</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return the value for the specified header, or &lt;code&gt;null&lt;/code&gt; if this</span></span><br><span class="line"><span class="comment">     * header has not been set.  If more than one value was added for this</span></span><br><span class="line"><span class="comment">     * name, only the first is returned; use &#123;<span class="doctag">@link</span> #getHeaders(String)&#125; to</span></span><br><span class="line"><span class="comment">     * retrieve all of them.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name Header name to look up</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 1、根据参数name获取响应头中对应的值；</span></span><br><span class="line"><span class="comment">     * 2、如果值不存在，返回null；</span></span><br><span class="line"><span class="comment">     * 3、如果存在多个值，只返回第一个。</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> Servlet 3.0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getHeader</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return a Collection of all the header values associated with the</span></span><br><span class="line"><span class="comment">     * specified header name.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 1、根据参数name获取响应头中对应的所有值</span></span><br><span class="line"><span class="comment">     * 2、弥补上一个方法的缺陷，返回的是一个集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;String&gt; <span class="title function_">getHeaders</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the header names set for this HTTP response.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The header names set for this HTTP response.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> Servlet 3.0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Collection&lt;String&gt; <span class="title function_">getHeaderNames</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Configure the supplier of the trailer headers. The supplier will be</span></span><br><span class="line"><span class="comment">     * called in the scope of the thread that completes the response.</span></span><br><span class="line"><span class="comment">     * &lt;br&gt;</span></span><br><span class="line"><span class="comment">     * Trailers that don&#x27;t meet the requirements of RFC 7230, section 4.1.2 will</span></span><br><span class="line"><span class="comment">     * be ignored.</span></span><br><span class="line"><span class="comment">     * &lt;br&gt;</span></span><br><span class="line"><span class="comment">     * The default implementation is a NO-OP.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> supplier The supplier for the trailer headers</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalStateException if this method is called when the</span></span><br><span class="line"><span class="comment">     *         underlying protocol does not support trailer headers or if using</span></span><br><span class="line"><span class="comment">     *         HTTP/1.1 and the response has already been committed</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> Servlet 4.0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">setTrailerFields</span><span class="params">(Supplier&lt;Map&lt;String, String&gt;&gt; supplier)</span> &#123;</span><br><span class="line">        <span class="comment">// NO-OP</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Obtain the supplier of the trailer headers.</span></span><br><span class="line"><span class="comment">     * &lt;br&gt;</span></span><br><span class="line"><span class="comment">     * The default implementation returns null.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The supplier for the trailer headers</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> Servlet 4.0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">default</span> Supplier&lt;Map&lt;String, String&gt;&gt; <span class="title function_">getTrailerFields</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * Server status codes; see RFC 2068.</span></span><br><span class="line"><span class="comment">     * 响应状态码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_CONTINUE</span> <span class="operator">=</span> <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_SWITCHING_PROTOCOLS</span> <span class="operator">=</span> <span class="number">101</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_OK</span> <span class="operator">=</span> <span class="number">200</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_CREATED</span> <span class="operator">=</span> <span class="number">201</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_ACCEPTED</span> <span class="operator">=</span> <span class="number">202</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_NON_AUTHORITATIVE_INFORMATION</span> <span class="operator">=</span> <span class="number">203</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_NO_CONTENT</span> <span class="operator">=</span> <span class="number">204</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_RESET_CONTENT</span> <span class="operator">=</span> <span class="number">205</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_PARTIAL_CONTENT</span> <span class="operator">=</span> <span class="number">206</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_MULTIPLE_CHOICES</span> <span class="operator">=</span> <span class="number">300</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_MOVED_PERMANENTLY</span> <span class="operator">=</span> <span class="number">301</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_MOVED_TEMPORARILY</span> <span class="operator">=</span> <span class="number">302</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_FOUND</span> <span class="operator">=</span> <span class="number">302</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_SEE_OTHER</span> <span class="operator">=</span> <span class="number">303</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_NOT_MODIFIED</span> <span class="operator">=</span> <span class="number">304</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_USE_PROXY</span> <span class="operator">=</span> <span class="number">305</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_TEMPORARY_REDIRECT</span> <span class="operator">=</span> <span class="number">307</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_BAD_REQUEST</span> <span class="operator">=</span> <span class="number">400</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_UNAUTHORIZED</span> <span class="operator">=</span> <span class="number">401</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_PAYMENT_REQUIRED</span> <span class="operator">=</span> <span class="number">402</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_FORBIDDEN</span> <span class="operator">=</span> <span class="number">403</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_NOT_FOUND</span> <span class="operator">=</span> <span class="number">404</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_METHOD_NOT_ALLOWED</span> <span class="operator">=</span> <span class="number">405</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_NOT_ACCEPTABLE</span> <span class="operator">=</span> <span class="number">406</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_PROXY_AUTHENTICATION_REQUIRED</span> <span class="operator">=</span> <span class="number">407</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_REQUEST_TIMEOUT</span> <span class="operator">=</span> <span class="number">408</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_CONFLICT</span> <span class="operator">=</span> <span class="number">409</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_GONE</span> <span class="operator">=</span> <span class="number">410</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_LENGTH_REQUIRED</span> <span class="operator">=</span> <span class="number">411</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_PRECONDITION_FAILED</span> <span class="operator">=</span> <span class="number">412</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_REQUEST_ENTITY_TOO_LARGE</span> <span class="operator">=</span> <span class="number">413</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_REQUEST_URI_TOO_LONG</span> <span class="operator">=</span> <span class="number">414</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_UNSUPPORTED_MEDIA_TYPE</span> <span class="operator">=</span> <span class="number">415</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_REQUESTED_RANGE_NOT_SATISFIABLE</span> <span class="operator">=</span> <span class="number">416</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_EXPECTATION_FAILED</span> <span class="operator">=</span> <span class="number">417</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_INTERNAL_SERVER_ERROR</span> <span class="operator">=</span> <span class="number">500</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_NOT_IMPLEMENTED</span> <span class="operator">=</span> <span class="number">501</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_BAD_GATEWAY</span> <span class="operator">=</span> <span class="number">502</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_SERVICE_UNAVAILABLE</span> <span class="operator">=</span> <span class="number">503</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_GATEWAY_TIMEOUT</span> <span class="operator">=</span> <span class="number">504</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SC_HTTP_VERSION_NOT_SUPPORTED</span> <span class="operator">=</span> <span class="number">505</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="1、设置响应行"><a href="#1、设置响应行" class="headerlink" title="1、设置响应行"></a>1、设置响应行</h3><p><strong>响应行格式：</strong></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK		</span><br></pre></td></tr></table></figure>

<p><strong>设置响应状态码</strong></p>
<ul>
<li>  在响应行中，协议名称、版本号以及协议状态都不用手动设置，唯一可以手动设置的只有状态码了。</li>
</ul>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left"><code>setStatus(int sc)</code></td>
<td align="left">设置响应状态码</td>
</tr>
</tbody></table>
<hr>
<h3 id="2、设置响应头"><a href="#2、设置响应头" class="headerlink" title="2、设置响应头"></a>2、设置响应头</h3><ul>
<li>  响应头都是一些键值对数据</li>
</ul>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">方法</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left"><code>setHeader(String name, String value)</code></td>
<td align="left">设置响应头消息（重置）</td>
</tr>
<tr>
<td align="center">2</td>
<td align="left"><code>addHeader(String name, String value)</code></td>
<td align="left">添加响应头（追加）</td>
</tr>
</tbody></table>
<hr>
<h3 id="3、设置响应体（重要）"><a href="#3、设置响应体（重要）" class="headerlink" title="3、设置响应体（重要）"></a>3、设置响应体（重要）</h3><blockquote>
<p>  <strong>ServletResponse 源码</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> javax.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 定义一个对象用于帮助 servlet 服务器向客户端发送响应。</span></span><br><span class="line"><span class="comment"> * 这个 Servlet 容器会创建一个 ServletResponse 对象，</span></span><br><span class="line"><span class="comment"> * 并且将它作为参数传递给 Servlet 的 service 方法。</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * 1、如果想要返回二进制（binary）的MIME类型的响应数据，请使用</span></span><br><span class="line"><span class="comment"> * ServletOutputStream 类中的 getOutputStream 方法返回的对象； </span></span><br><span class="line"><span class="comment"> * 2、如果想要返回 character 类型的数据，请使用 PrintWriter中的#getWriter方法</span></span><br><span class="line"><span class="comment"> * 3、如果想要返回二进制和文本的混合类型数据（mix binary and text data），可以</span></span><br><span class="line"><span class="comment"> * 使用 ServletOutputStream 创建一个 multipart response 对象，并手动管理character</span></span><br><span class="line"><span class="comment"> * 类型的部分数据。</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The charset for the MIME body response can be specified explicitly or</span></span><br><span class="line"><span class="comment"> * implicitly. The priority order for specifying the response body is:</span></span><br><span class="line"><span class="comment"> * &lt;ol&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;explicitly per request using &#123;<span class="doctag">@link</span> #setCharacterEncoding&#125; and</span></span><br><span class="line"><span class="comment"> *    &#123;<span class="doctag">@link</span> #setContentType&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;implicitly per request using &#123;<span class="doctag">@link</span> #setLocale&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;per web application via the deployment descriptor or</span></span><br><span class="line"><span class="comment"> *     &#123;<span class="doctag">@link</span> ServletContext#setRequestCharacterEncoding(String)&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;container default via vendor specific configuration&lt;/li&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;ISO-8859-1&lt;/li&gt;</span></span><br><span class="line"><span class="comment"> * &lt;/ol&gt;</span></span><br><span class="line"><span class="comment"> * The &lt;code&gt;setCharacterEncoding&lt;/code&gt;, &lt;code&gt;setContentType&lt;/code&gt;, or</span></span><br><span class="line"><span class="comment"> * &lt;code&gt;setLocale&lt;/code&gt; method must be called before &lt;code&gt;getWriter&lt;/code&gt;</span></span><br><span class="line"><span class="comment"> * and before committing the response for the character encoding to be used.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * See the Internet RFCs such as &lt;a href=&quot;http://www.ietf.org/rfc/rfc2045.txt&quot;&gt;</span></span><br><span class="line"><span class="comment"> * RFC 2045&lt;/a&gt; for more information on MIME. Protocols such as SMTP and HTTP</span></span><br><span class="line"><span class="comment"> * define profiles of MIME, and those standards are still evolving.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> ServletOutputStream</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ServletResponse</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the name of the character encoding (MIME charset) used for the</span></span><br><span class="line"><span class="comment">     * body sent in this response.</span></span><br><span class="line"><span class="comment">     * The charset for the MIME body response can be specified explicitly or</span></span><br><span class="line"><span class="comment">     * implicitly. The priority order for specifying the response body is:</span></span><br><span class="line"><span class="comment">     * &lt;ol&gt;</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;explicitly per request using &#123;<span class="doctag">@link</span> #setCharacterEncoding&#125; and</span></span><br><span class="line"><span class="comment">     *    &#123;<span class="doctag">@link</span> #setContentType&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;implicitly per request using &#123;<span class="doctag">@link</span> #setLocale&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;per web application via the deployment descriptor or</span></span><br><span class="line"><span class="comment">     *     &#123;<span class="doctag">@link</span> ServletContext#setRequestCharacterEncoding(String)&#125;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;container default via vendor specific configuration&lt;/li&gt;</span></span><br><span class="line"><span class="comment">     * &lt;li&gt;ISO-8859-1&lt;/li&gt;</span></span><br><span class="line"><span class="comment">     * &lt;/ol&gt;</span></span><br><span class="line"><span class="comment">     * Calls made to &#123;<span class="doctag">@link</span> #setCharacterEncoding&#125;, &#123;<span class="doctag">@link</span> #setContentType&#125; or</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #setLocale&#125; after &lt;code&gt;getWriter&lt;/code&gt; has been called or after</span></span><br><span class="line"><span class="comment">     * the response has been committed have no effect on the character encoding.</span></span><br><span class="line"><span class="comment">     * If no character encoding has been specified, &lt;code&gt;ISO-8859-1&lt;/code&gt; is</span></span><br><span class="line"><span class="comment">     * returned.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * See RFC 2047 (http://www.ietf.org/rfc/rfc2047.txt) for more information</span></span><br><span class="line"><span class="comment">     * about character encoding and MIME.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a &lt;code&gt;String&lt;/code&gt; specifying the name of the character</span></span><br><span class="line"><span class="comment">     *         encoding, for example, &lt;code&gt;UTF-8&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCharacterEncoding</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the content type used for the MIME body sent in this response.</span></span><br><span class="line"><span class="comment">     * The content type proper must have been specified using</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #setContentType&#125; before the response is committed. If no content</span></span><br><span class="line"><span class="comment">     * type has been specified, this method returns null. If a content type has</span></span><br><span class="line"><span class="comment">     * been specified and a character encoding has been explicitly or implicitly</span></span><br><span class="line"><span class="comment">     * specified as described in &#123;<span class="doctag">@link</span> #getCharacterEncoding&#125;, the charset</span></span><br><span class="line"><span class="comment">     * parameter is included in the string returned. If no character encoding</span></span><br><span class="line"><span class="comment">     * has been specified, the charset parameter is omitted.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a &lt;code&gt;String&lt;/code&gt; specifying the content type, for example,</span></span><br><span class="line"><span class="comment">     *         &lt;code&gt;text/html; charset=UTF-8&lt;/code&gt;, or null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 2.4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getContentType</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a &#123;<span class="doctag">@link</span> ServletOutputStream&#125; suitable for writing binary data in</span></span><br><span class="line"><span class="comment">     * the response. The servlet container does not encode the binary data.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * Calling flush() on the ServletOutputStream commits the response. Either</span></span><br><span class="line"><span class="comment">     * this method or &#123;<span class="doctag">@link</span> #getWriter&#125; may be called to write the body, not</span></span><br><span class="line"><span class="comment">     * both.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a &#123;<span class="doctag">@link</span> ServletOutputStream&#125; for writing binary data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IllegalStateException</span></span><br><span class="line"><span class="comment">     *                if the &lt;code&gt;getWriter&lt;/code&gt; method has been called on</span></span><br><span class="line"><span class="comment">     *                this response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IOException</span></span><br><span class="line"><span class="comment">     *                if an input or output exception occurred</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getWriter</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> ServletOutputStream <span class="title function_">getOutputStream</span><span class="params">()</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a &lt;code&gt;PrintWriter&lt;/code&gt; object that can send character text to</span></span><br><span class="line"><span class="comment">     * the client. The &lt;code&gt;PrintWriter&lt;/code&gt; uses the character encoding</span></span><br><span class="line"><span class="comment">     * returned by &#123;<span class="doctag">@link</span> #getCharacterEncoding&#125;. If the response&#x27;s character</span></span><br><span class="line"><span class="comment">     * encoding has not been specified as described in</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;getCharacterEncoding&lt;/code&gt; (i.e., the method just returns the</span></span><br><span class="line"><span class="comment">     * default value &lt;code&gt;ISO-8859-1&lt;/code&gt;), &lt;code&gt;getWriter&lt;/code&gt; updates it</span></span><br><span class="line"><span class="comment">     * to &lt;code&gt;ISO-8859-1&lt;/code&gt;.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * Calling flush() on the &lt;code&gt;PrintWriter&lt;/code&gt; commits the response.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * Either this method or &#123;<span class="doctag">@link</span> #getOutputStream&#125; may be called to write the</span></span><br><span class="line"><span class="comment">     * body, not both.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a &lt;code&gt;PrintWriter&lt;/code&gt; object that can return character data</span></span><br><span class="line"><span class="comment">     *         to the client</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> java.io.UnsupportedEncodingException</span></span><br><span class="line"><span class="comment">     *                if the character encoding returned by</span></span><br><span class="line"><span class="comment">     *                &lt;code&gt;getCharacterEncoding&lt;/code&gt; cannot be used</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IllegalStateException</span></span><br><span class="line"><span class="comment">     *                if the &lt;code&gt;getOutputStream&lt;/code&gt; method has already</span></span><br><span class="line"><span class="comment">     *                been called for this response object</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IOException</span></span><br><span class="line"><span class="comment">     *                if an input or output exception occurred</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getOutputStream</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setCharacterEncoding</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> PrintWriter <span class="title function_">getWriter</span><span class="params">()</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the character encoding (MIME charset) of the response being sent to</span></span><br><span class="line"><span class="comment">     * the client, for example, to UTF-8. If the character encoding has already</span></span><br><span class="line"><span class="comment">     * been set by container default, ServletContext default,</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #setContentType&#125; or &#123;<span class="doctag">@link</span> #setLocale&#125;, this method overrides it.</span></span><br><span class="line"><span class="comment">     * Calling &#123;<span class="doctag">@link</span> #setContentType&#125; with the &lt;code&gt;String&lt;/code&gt; of</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;text/html&lt;/code&gt; and calling this method with the</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;String&lt;/code&gt; of &lt;code&gt;UTF-8&lt;/code&gt; is equivalent with calling</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;setContentType&lt;/code&gt; with the &lt;code&gt;String&lt;/code&gt; of</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;text/html; charset=UTF-8&lt;/code&gt;.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * This method can be called repeatedly to change the character encoding.</span></span><br><span class="line"><span class="comment">     * This method has no effect if it is called after &lt;code&gt;getWriter&lt;/code&gt;</span></span><br><span class="line"><span class="comment">     * has been called or after the response has been committed.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * Containers must communicate the character encoding used for the servlet</span></span><br><span class="line"><span class="comment">     * response&#x27;s writer to the client if the protocol provides a way for doing</span></span><br><span class="line"><span class="comment">     * so. In the case of HTTP, the character encoding is communicated as part</span></span><br><span class="line"><span class="comment">     * of the &lt;code&gt;Content-Type&lt;/code&gt; header for text media types. Note that</span></span><br><span class="line"><span class="comment">     * the character encoding cannot be communicated via HTTP headers if the</span></span><br><span class="line"><span class="comment">     * servlet does not specify a content type; however, it is still used to</span></span><br><span class="line"><span class="comment">     * encode text written via the servlet response&#x27;s writer.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> charset</span></span><br><span class="line"><span class="comment">     *            a String specifying only the character set defined by IANA</span></span><br><span class="line"><span class="comment">     *            Character Sets</span></span><br><span class="line"><span class="comment">     *            (http://www.iana.org/assignments/character-sets)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setContentType #setLocale</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 2.4</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCharacterEncoding</span><span class="params">(String charset)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the length of the content body in the response In HTTP servlets,</span></span><br><span class="line"><span class="comment">     * this method sets the HTTP Content-Length header.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> len</span></span><br><span class="line"><span class="comment">     *            an integer specifying the length of the content being returned</span></span><br><span class="line"><span class="comment">     *            to the client; sets the Content-Length header</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setContentLength</span><span class="params">(<span class="type">int</span> len)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the length of the content body in the response In HTTP servlets,</span></span><br><span class="line"><span class="comment">     * this method sets the HTTP Content-Length header.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> length</span></span><br><span class="line"><span class="comment">     *            an integer specifying the length of the content being returned</span></span><br><span class="line"><span class="comment">     *            to the client; sets the Content-Length header</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> Servlet 3.1</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setContentLengthLong</span><span class="params">(<span class="type">long</span> length)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the content type of the response being sent to the client, if the</span></span><br><span class="line"><span class="comment">     * response has not been committed yet. The given content type may include a</span></span><br><span class="line"><span class="comment">     * character encoding specification, for example,</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;text/html;charset=UTF-8&lt;/code&gt;. The response&#x27;s character encoding</span></span><br><span class="line"><span class="comment">     * is only set from the given content type if this method is called before</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;getWriter&lt;/code&gt; is called.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * This method may be called repeatedly to change content type and character</span></span><br><span class="line"><span class="comment">     * encoding. This method has no effect if called after the response has been</span></span><br><span class="line"><span class="comment">     * committed. It does not set the response&#x27;s character encoding if it is</span></span><br><span class="line"><span class="comment">     * called after &lt;code&gt;getWriter&lt;/code&gt; has been called or after the response</span></span><br><span class="line"><span class="comment">     * has been committed.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * Containers must communicate the content type and the character encoding</span></span><br><span class="line"><span class="comment">     * used for the servlet response&#x27;s writer to the client if the protocol</span></span><br><span class="line"><span class="comment">     * provides a way for doing so. In the case of HTTP, the</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;Content-Type&lt;/code&gt; header is used.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> type</span></span><br><span class="line"><span class="comment">     *            a &lt;code&gt;String&lt;/code&gt; specifying the MIME type of the content</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setLocale</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setCharacterEncoding</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getOutputStream</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getWriter</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setContentType</span><span class="params">(String type)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the preferred buffer size for the body of the response. The servlet</span></span><br><span class="line"><span class="comment">     * container will use a buffer at least as large as the size requested. The</span></span><br><span class="line"><span class="comment">     * actual buffer size used can be found using &lt;code&gt;getBufferSize&lt;/code&gt;.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * A larger buffer allows more content to be written before anything is</span></span><br><span class="line"><span class="comment">     * actually sent, thus providing the servlet with more time to set</span></span><br><span class="line"><span class="comment">     * appropriate status codes and headers. A smaller buffer decreases server</span></span><br><span class="line"><span class="comment">     * memory load and allows the client to start receiving data more quickly.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * This method must be called before any response body content is written;</span></span><br><span class="line"><span class="comment">     * if content has been written or the response object has been committed,</span></span><br><span class="line"><span class="comment">     * this method throws an &lt;code&gt;IllegalStateException&lt;/code&gt;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> size</span></span><br><span class="line"><span class="comment">     *            the preferred buffer size</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IllegalStateException</span></span><br><span class="line"><span class="comment">     *                if this method is called after content has been written</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #flushBuffer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #isCommitted</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #reset</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBufferSize</span><span class="params">(<span class="type">int</span> size)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the actual buffer size used for the response. If no buffering is</span></span><br><span class="line"><span class="comment">     * used, this method returns 0.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the actual buffer size used</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #flushBuffer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #isCommitted</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #reset</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getBufferSize</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Forces any content in the buffer to be written to the client. A call to</span></span><br><span class="line"><span class="comment">     * this method automatically commits the response, meaning the status code</span></span><br><span class="line"><span class="comment">     * and headers will be written.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException if an I/O occurs during the flushing of the response</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #isCommitted</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #reset</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">flushBuffer</span><span class="params">()</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Clears the content of the underlying buffer in the response without</span></span><br><span class="line"><span class="comment">     * clearing headers or status code. If the response has been committed, this</span></span><br><span class="line"><span class="comment">     * method throws an &lt;code&gt;IllegalStateException&lt;/code&gt;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #isCommitted</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #reset</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 2.3</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">resetBuffer</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns a boolean indicating if the response has been committed. A</span></span><br><span class="line"><span class="comment">     * committed response has already had its status code and headers written.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a boolean indicating if the response has been committed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #flushBuffer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #reset</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isCommitted</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Clears any data that exists in the buffer as well as the status code and</span></span><br><span class="line"><span class="comment">     * headers. If the response has been committed, this method throws an</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;IllegalStateException&lt;/code&gt;.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@exception</span> IllegalStateException</span></span><br><span class="line"><span class="comment">     *                if the response has already been committed</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getBufferSize</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #flushBuffer</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #isCommitted</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reset</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the locale of the response, if the response has not been committed</span></span><br><span class="line"><span class="comment">     * yet. It also sets the response&#x27;s character encoding appropriately for the</span></span><br><span class="line"><span class="comment">     * locale, if the character encoding has not been explicitly set using</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #setContentType&#125; or &#123;<span class="doctag">@link</span> #setCharacterEncoding&#125;,</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;getWriter&lt;/code&gt; hasn&#x27;t been called yet, and the response hasn&#x27;t</span></span><br><span class="line"><span class="comment">     * been committed yet. If the deployment descriptor contains a</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;locale-encoding-mapping-list&lt;/code&gt; element, and that element</span></span><br><span class="line"><span class="comment">     * provides a mapping for the given locale, that mapping is used. Otherwise,</span></span><br><span class="line"><span class="comment">     * the mapping from locale to character encoding is container dependent.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * This method may be called repeatedly to change locale and character</span></span><br><span class="line"><span class="comment">     * encoding. The method has no effect if called after the response has been</span></span><br><span class="line"><span class="comment">     * committed. It does not set the response&#x27;s character encoding if it is</span></span><br><span class="line"><span class="comment">     * called after &#123;<span class="doctag">@link</span> #setContentType&#125; has been called with a charset</span></span><br><span class="line"><span class="comment">     * specification, after &#123;<span class="doctag">@link</span> #setCharacterEncoding&#125; has been called, after</span></span><br><span class="line"><span class="comment">     * &lt;code&gt;getWriter&lt;/code&gt; has been called, or after the response has been</span></span><br><span class="line"><span class="comment">     * committed.</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * Containers must communicate the locale and the character encoding used</span></span><br><span class="line"><span class="comment">     * for the servlet response&#x27;s writer to the client if the protocol provides</span></span><br><span class="line"><span class="comment">     * a way for doing so. In the case of HTTP, the locale is communicated via</span></span><br><span class="line"><span class="comment">     * the &lt;code&gt;Content-Language&lt;/code&gt; header, the character encoding as part</span></span><br><span class="line"><span class="comment">     * of the &lt;code&gt;Content-Type&lt;/code&gt; header for text media types. Note that</span></span><br><span class="line"><span class="comment">     * the character encoding cannot be communicated via HTTP headers if the</span></span><br><span class="line"><span class="comment">     * servlet does not specify a content type; however, it is still used to</span></span><br><span class="line"><span class="comment">     * encode text written via the servlet response&#x27;s writer.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loc</span></span><br><span class="line"><span class="comment">     *            the locale of the response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #getLocale</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setContentType</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setCharacterEncoding</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setLocale</span><span class="params">(Locale loc)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the locale specified for this response using the</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@link</span> #setLocale&#125; method. Calls made to &lt;code&gt;setLocale&lt;/code&gt; after the</span></span><br><span class="line"><span class="comment">     * response is committed have no effect.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The locale specified for this response using the</span></span><br><span class="line"><span class="comment">     *          &#123;<span class="doctag">@link</span> #setLocale&#125; method. If no locale has been specified, the</span></span><br><span class="line"><span class="comment">     *          container&#x27;s default locale is returned.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@see</span> #setLocale</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Locale <span class="title function_">getLocale</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>设置响应体文本</strong>：</p>
<ol>
<li>先通过<code>resp</code>对象获取<code>输出流对象</code></li>
<li>调用<code>输出流对象</code>中的<code>write(String s)</code>方法可以将字符串<code>s</code>添加到<code>Response缓冲区</code>中，之后TomCat会将<code>Response缓冲区</code>中的内容封装到响应消息的响应体中返回给客户端浏览器。</li>
</ol>
<ol>
<li><p>通过<code>resp</code>对象获取<em>输出流对象</em></p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.获取输出流对象的方法： </span></span><br><span class="line">PrintWriter <span class="title function_">getWriter</span><span class="params">()</span>;	<span class="comment">// 获取字符输出流</span></span><br><span class="line">ServletOutputStream <span class="title function_">getOutputStream</span><span class="params">()</span>;	<span class="comment">// 获取字节输出流</span></span><br></pre></td></tr></table></figure></li>
<li><p>调用<em>输出流对象</em>中的<code>write()</code>方法</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2.使用输出流，将数据输出到客户端浏览器</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="两个输出流的说明"><a href="#两个输出流的说明" class="headerlink" title="两个输出流的说明"></a>两个输出流的说明</h5><table>
<thead>
<tr>
<th align="center"></th>
<th align="center">获取</th>
<th align="center">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center">字节流</td>
<td align="center"><code>getOutputStream()</code></td>
<td align="center">常用于下载（传递二进制数据）</td>
</tr>
<tr>
<td align="center">字符流</td>
<td align="center"><code>getWriter()</code></td>
<td align="center">常用于回传字符串</td>
</tr>
<tr>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<blockquote>
<p>Tip：两个流同时只能使用一个，否则访问服务器时会出现500以上的错误。</p>
</blockquote>
<h4 id="4、如何解决客户端输出到浏览器上的中文数据乱码问题？"><a href="#4、如何解决客户端输出到浏览器上的中文数据乱码问题？" class="headerlink" title="4、如何解决客户端输出到浏览器上的中文数据乱码问题？"></a>4、如何解决客户端输出到浏览器上的中文数据乱码问题？</h4><ol>
<li><strong>乱码产生的原因</strong></li>
</ol>
<blockquote>
<p>乱码问题产生的原因：编码&amp;解码使用的标准不一致。</p>
<ul>
<li>Response缓冲区的默认编码是<code>ISO-8859-1</code>。</li>
<li>如果服务器的响应消息中不告诉用户浏览器使用什么方式解码，那么用户浏览器就会使用默认的解码方式解码【默认解码方式与用户系统一致，比如安装的是中文系统的Windows，那么默认使用GBK编码】</li>
<li>那么拿着ISO-8859-1编码的数据，使用GBK解码，显然会出现乱码的现象。</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo05_Response</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1.获取输出流对象</span></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        <span class="comment">// 2.调用输出流对象中的write()方法，将字符串写到Response缓冲区中(并使用ISO编码编译)</span></span><br><span class="line">        writer.write(<span class="string">&quot;你好，世界&quot;</span>);</span><br><span class="line">        <span class="comment">// 3.出现问题，输出到浏览器页面的中文内容无法被解析</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4.查看resp对象的编码类型 【ISO-8859-1】</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">encoding</span> <span class="operator">=</span> resp.getCharacterEncoding();</span><br><span class="line">        System.out.println(encoding);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 5.原因：浏览器默认使用的GBK编码，TomCat服务器通过resp对象传给浏览器的数据默认是ISO-8859-1编码，是浏览器无法解析的数据类型，所以会出现乱码。</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ol start="2">
<li><p><strong>解决方案</strong>（3个方法）：</p>
<ul>
<li><p>1)、在Response获取输出流对象之前，设置该流使用的编码方式与浏览器默认的解码方式一致</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法1:</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/demo03response&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo05_Response</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 0.设置TomCat的字符输出流的编码方式与系统相同（GBK）【耦合度高】</span></span><br><span class="line">        resp.setCharacterEncoding(<span class="string">&quot;gbk&quot;</span>);</span><br><span class="line">        <span class="comment">// 1..获取字节/字符输出流对象【通过TomCat创建的resp对象来获取】</span></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">pw</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        <span class="comment">// 2.使用输出流，把数据输出到客户端浏览器</span></span><br><span class="line">        pw.write(<span class="string">&quot;&lt;h1&gt;hello 世界&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
<li><p>2)、服务器在Response消息的响应头Headers中告诉客户端浏览器我使用的编码方式是什么，让浏览器选择对应的解码方式。[我们已知了计算机系统的默认编码方式为GBK，但是如果把这个程序放到默认以UTF-8编码的计算机上以方法1运行仍然会报错，所以我们需要把    设置输出流编码方式  &amp;  告诉浏览器输出流的编码方式  结合起来使用。]</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/demo03response&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo03_Response</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        <span class="comment">// 0. 首先要设置服务器中字符输出流的编码格式</span></span><br><span class="line">        resp.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">	   	<span class="comment">// 1.服务器告诉浏览器我使用哪种编码，让浏览器按照对应的码表解码	</span></span><br><span class="line">        resp.setHeader(<span class="string">&quot;content-type&quot;</span>, <span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 2.获取字节/字符输出流【通过TomCat创建的resp对象来获取】</span></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">pw</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        <span class="comment">// 2.使用输出流，把数据输出到客户端浏览器</span></span><br><span class="line">        pw.write(<span class="string">&quot;&lt;h1&gt;hello 世界&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>3)、resoponse对象中的<code>setContentType()</code>方法不仅设置了服务器使用utf-8字符集，还设置了响应头中的<code>ContentType</code>的值为<code>&quot;text/html;utf-8&quot;</code>。简化了方法2的书写</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/demo03response&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo03_Response</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">       </span><br><span class="line">	   	<span class="comment">// 1.同时设置服务器可客户端使用utf-8字符集	</span></span><br><span class="line">        resp.setContentType(<span class="string">&quot;text/html;utf-8&quot;</span>);</span><br><span class="line">        <span class="comment">// 2.获取字节/字符输出流【通过TomCat创建的resp对象来获取】</span></span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">pw</span> <span class="operator">=</span> resp.getWriter();</span><br><span class="line">        <span class="comment">// 3.使用输出流，把数据输出到客户端浏览器</span></span><br><span class="line">        pw.write(<span class="string">&quot;&lt;h1&gt;hello 世界&lt;/h1&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Tip：此方法一定要在获取流对象之前调用才有效</p>
</blockquote>
</li>
</ul>
</li>
</ol>
<h3 id="6-2-2-重定向-vs-转发"><a href="#6-2-2-重定向-vs-转发" class="headerlink" title="6.2.2    重定向 vs. 转发"></a>6.2.2    重定向 vs. 转发</h3><p><img src="/2021/11/25/HttpServletRequest%E5%92%8CHttpServletResponse/%E9%87%8D%E5%AE%9A%E5%90%91-1597652154015.bmp"></p>
<p><img src="/2021/11/25/HttpServletRequest%E5%92%8CHttpServletResponse/image-20200519183919703-1597652154016.png" alt="image-20200519183919703"></p>
<ul>
<li><p>重定向：<code>redirect</code></p>
<ol>
<li><p>重定向是一种资源跳转的方式。</p>
<ul>
<li>用户希望访问一些数据，先通过URL找到了A资源，A告诉用户我满足不了你的需求，但是我知道B能满足你的需求，所以A的Response中包含了302的响应状态码以及B的URL。告诉用户的浏览器去重新访问B资源。其中用户的浏览器对A和B都发送了Request请求，这是2次请求。</li>
</ul>
</li>
<li><p>重定向的特点：</p>
<ol>
<li>地址栏发生变化。</li>
<li>重定向可以访问其他站点（服务器）的资源。</li>
<li>重定向是两次请求。</li>
<li>不能共享Request域中的数据。</li>
<li>不能访问WEB-INF目录下的资源</li>
</ol>
</li>
<li><p>请求重定向的2种方法：</p>
<ul>
<li>方法1：<code>resp.setStatus(302)</code> + <code>resp.setHeader(&quot;location&quot;,&quot;/D4/demo02response&quot;)</code></li>
</ul>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/demo01response&quot;)</span>	<span class="comment">// 当前资源路径</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01_Response</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;demo01重定向到demo02&quot;</span>);		<span class="comment">// 本路径的资源</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	重定向</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="comment">// 1. 给客户端返回302状态码。</span></span><br><span class="line">        resp.setStatus(<span class="number">302</span>);</span><br><span class="line">        <span class="comment">// 2. 给客户端返回跳转的地址【键值对】保存在响应头中返回。</span></span><br><span class="line">        resp.setHeader(<span class="string">&quot;location&quot;</span>,<span class="string">&quot;/D4/demo02response&quot;</span>);	<span class="comment">// 第一个斜杠表示绝对地址（给浏览器解析）</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>方法2(推荐使用)：<code> resp.sendRedirect(&quot;http://www.baidu.com&quot;)</code></li>
</ul>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(&quot;/demo01response&quot;)</span>	<span class="comment">// 当前资源路径</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo01_Response</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;demo01重定向到demo02&quot;</span>);		<span class="comment">// 本路径的资源	</span></span><br><span class="line">         <span class="comment">/*</span></span><br><span class="line"><span class="comment">        	重定向</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">		<span class="comment">// 1.动态的获取[绝对]工程路径</span></span><br><span class="line">     <span class="type">String</span> <span class="variable">contextPath</span> <span class="operator">=</span> req.getContextPath(	);</span><br><span class="line">        <span class="comment">// 2.调用重定向方法（该方法实现了返回302状态码 &amp; 返回跳转的地址）</span></span><br><span class="line">     <span class="comment">// resp.sendRedirect(contextPath+&quot;/demo02response&quot;);</span></span><br><span class="line">        resp.sendRedirect(<span class="string">&quot;http://www.baidu.com&quot;</span>);     <span class="comment">// 重定向可以访问其它服务器上的资源</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
</li>
<li><p>转发：forward</p>
<ol>
<li>转发时地址栏路径不变</li>
<li>转发只能访问当前服务器下的资源</li>
<li>转发是一次请求，可以共享数据。</li>
</ol>
</li>
</ul>
<hr>
<ul>
<li>访问缓存（304）<ol>
<li>用户浏览器会把用户机暂时访问过的部分资源缓存到客户机中，未清空缓存的情况下，用户再次访问该资源时，客户端会自动检测到这些缓存的存在，就会给用户浏览器返回304响应状态码，让用户使用缓存的资源。从而节省了传输时间，减轻了服务器的压力。</li>
</ol>
</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/22/Hadoop%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/22/Hadoop%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">Hadoop完全分布式集群搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-22 21:21:29" itemprop="dateCreated datePublished" datetime="2021-11-22T21:21:29+08:00">2021-11-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-02-16 10:36:51" itemprop="dateModified" datetime="2022-02-16T10:36:51+08:00">2022-02-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hadoop/" itemprop="url" rel="index"><span itemprop="name">Hadoop</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="完全分布式集群的搭建（重点）"><a href="#完全分布式集群的搭建（重点）" class="headerlink" title="完全分布式集群的搭建（重点）"></a>完全分布式集群的搭建（重点）</h1><p><strong>是什么？</strong>Hadoop 中各个组件（HDFS、Yarn等）的各个进程（HDFS 的 NameNode 和 DataNode；Yarn 的ResourceManager 和 DataManager 等）分布在多台机器上运行。</p>
<h2 id="进程规划"><a href="#进程规划" class="headerlink" title="进程规划"></a>进程规划</h2><p>进程规划原则：</p>
<ol>
<li> 核心进程尽量分散。</li>
<li> 同质进程尽量分散。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">解析：</span><br><span class="line">    1、核心进程尽量分散：</span><br><span class="line">        在 Hadoop 集群中，HDFS 中的 NM 和 YARN 中的 RM 都属于核心进程，一个集群中只能有一个。    </span><br><span class="line">        对于这些进程来说，一旦集群中的某个节点上的机器突然宕机，整个集群就会立即停止运转，所以我们在进程规划时尽量会把 NM 和 RM 分配到不同的节点上，这样能有效的避免单点故障。</span><br><span class="line">        </span><br><span class="line">    2、同质进程尽量分散：</span><br><span class="line">        所谓同质进程，就是指 运行某两个进程需求的相同或类似的资源。</span><br><span class="line">        比如 NN 和 2NN ，在运行时都需要分配大量的内存空间，所以我们一般把这两个进程分配到不同的节点上去，这样可以提高内存资源的利用率。</span><br></pre></td></tr></table></figure>



<h2 id="执行群起"><a href="#执行群起" class="headerlink" title="执行群起"></a>执行群起</h2><ul>
<li>  <code>start-dfs.sh</code> 命令可以在集群中的任意一台机器上执行。</li>
<li>  <code>start-yarn.sh</code> 如果在没有配置 RM 的机器上执行，那么不会启动 RM，只能启动 NM！</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Tip：</span><br><span class="line">    1、建议所有的群起脚本都在 RM 所在的机器上执行！</span><br><span class="line">    2、只需要配置 RM 所在的机器到集群中其它机器的 SSH 免密登录即可。</span><br></pre></td></tr></table></figure>

<ul>
<li>  在执行群起脚本时，默认读取当前机器中的 <code>$HADOOP_HOME/etc/hadoop/slaves</code> 文件，所以要在该文件中配置当前集群中所有的主机IP地址。</li>
</ul>
<h2 id="集群的时间同步"><a href="#集群的时间同步" class="headerlink" title="集群的时间同步"></a>集群的时间同步</h2><blockquote>
<p>  一个集群中，每台机器的时间必须保证是同步的！</p>
</blockquote>
<hr>
<h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><h2 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h2><p><strong>scp（secure copy）：安全拷贝</strong></p>
<p><strong>作用：</strong></p>
<ul>
<li>  <code>scp</code> 可以实现服务器与服务器之间的数据拷贝。（from server1 to server2）</li>
</ul>
<p><strong>特点：</strong></p>
<ul>
<li>  <code>scp</code> 命令执行的是全量复制，每次复制时都会把一份完整的源文件重新复制拷贝到目的文件夹中。如果经常需要执行增量复制的话，<code>scp</code> 命令就不太合适了。</li>
<li>  正常情况下，一个文件第一次从A机器拷贝到B机器需要执行一次全量复制，但是当A机器中该文件数据发生变化后，下一次复制只需执行一次增量复制就可以了。但是如果使用 <code>scp</code> 命令的话，每次执行的都是全量复制。</li>
</ul>
<p><strong>基本语法</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r 源文件属主A@主机名1:path1    目标文件属主B@主机名2:path2</span><br></pre></td></tr></table></figure>

<ul>
<li>  <strong>作用：</strong>在主机1上，使用 A 用户读取 <code>path1</code> 的文件，再使用用户B登录到主机2上，在主机2的 <code>path2</code> 路径执行写入操作。</li>
<li>  <code>-r</code>：递归，如果要拷贝的是一个目录，且目录还有其它文件，就一定要使用递归。</li>
<li><strong>要求：</strong><ol>
<li> 主机名1上的用户名A对 <code>path1</code> 有读权限</li>
<li> 主机名2上的用户名B对 <code>path2</code> 有写权限</li>
</ol>
</li>
<li>  <strong>小技巧</strong>：如果从本机执行读取或写入，<code>用户名B@主机名2:</code> 可以省略！</li>
</ul>
<p><strong>测试</strong></p>
<ol>
<li><p> 在 hadoop102 的 <code>/opt/module/</code> 目录下有一个 testUpload 文件，其属主是用户 <code>lvnengdong</code></p>
</li>
<li><p>现在在 hadoop103 上执行命令，将 hadoop102 上的文件 <code>/opt/module/testUpload</code> 拷贝到 hadoop103 的 <code>/opt/module/</code> 目录下，执行的脚本为：</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 etc]$ scp -r lvnengdong@hadoop102:/opt/module/testUpload /opt/module/</span><br><span class="line">testUpload             									100%   19    12.9KB/s   00:00 </span><br></pre></td></tr></table></figure></li>
<li><p> 在 hadoop103 上查看是否拷贝成功。</p>
</li>
</ol>
<hr>
<h2 id="rsync"><a href="#rsync" class="headerlink" title="rsync"></a>rsync</h2><p><strong>rsync（remote sync）    远程同步</strong></p>
<p><strong>作用 &amp; 特点：</strong></p>
<ul>
<li>  <code>rsync</code> 也用于执行多个服务器间数据的拷贝，但是该命令采用的是<strong>增量复制</strong>策略。</li>
<li>  增量复制的原理是对比文件的修改时间，只同步修改时间不一致的文件。</li>
</ul>
<p><strong>基本语法：</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -rvlt 源文件属主A@主机名1:path1    目标文件属主B@主机名2:path2</span><br></pre></td></tr></table></figure>

<ul>
<li>  <strong>作用：</strong>在主机1上，使用 A 用户读取 <code>path1</code> 的文件，再使用用户B登录到主机2上，在主机2的 <code>path2</code> 路径执行写入操作。但是由于 <code>rsync</code> 命令只支持将本机的文件或目录同步到其它机器上，所以 <code>源文件属主A@主机名1:</code> 就可以省略，一般命令写为：</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -rvlt path1  目标文件属主B@主机名2:path2</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>选项参数</strong></p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-r:	 递归，复制目录时使用</span><br><span class="line">-v： 显示复制的过程</span><br><span class="line">-l:  即使是软连接，也会将软连接同步</span><br><span class="line">-t:  基于文件的修改时间进行对比，只同步发生变化的文件</span><br></pre></td></tr></table></figure></li>
<li><p><strong>注意事项：</strong></p>
<ol>
<li> 只能将本机的文件同步到其他机器！</li>
<li> 如果 <code>path1</code> 是个目录，目录以 <code>/</code> 结尾，表示只会同步目录中的内容，不会同步目录本身；如果目录不以 <code>/</code> 结尾，不进会同步目录中的内容，也会同步目录本身！</li>
</ol>
</li>
</ul>
<hr>
<h1 id="SSH-免密登录"><a href="#SSH-免密登录" class="headerlink" title="SSH 免密登录"></a>SSH 免密登录</h1><p>举例：  A机器的a用户，希望在A机器上，使用b用户的身份登录到B机器！（A机器上的A用户，使用b用户远程连接到B机器）</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br><span class="line"></span><br><span class="line">ssh-keygen  生成秘钥的指令 </span><br><span class="line">-t rsa	-t表示指定生成的算法  rsa 是一种算法</span><br></pre></td></tr></table></figure>





<hr>
<h1 id="编写数据同步脚本"><a href="#编写数据同步脚本" class="headerlink" title="编写数据同步脚本"></a>编写数据同步脚本</h1><ol>
<li><p> <strong>需求：</strong>循环复制文件到所有节点的相同目录下</p>
</li>
<li><p><strong>分析</strong>：</p>
<ul>
<li><p><code>rsync</code> 命令原始拷贝：</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync  -rvl     /opt/module  		 root@hadoop103:/opt/</span><br></pre></td></tr></table></figure></li>
<li><p>期望脚本：</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xsync 要同步的文件名称</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p> <strong>说明：</strong>在 <code>/home/&#123;用户名&#125;/bin</code> 这个目录下存放的脚本，用户可以在系统任何地方直接执行。</p>
</li>
<li><p><strong>脚本实现</strong></p>
<ol>
<li><p>在 <code>/home/&#123;用户名&#125;</code> 目录下创建 <code>bin</code> 目录，并在 <code>bin</code> 目录下创建脚本文件 <code>xsync</code> ，脚本文件内容如下：</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#1 获取输入参数个数，如果没有参数，直接退出</span></span><br><span class="line">pcount=<span class="variable">$#</span></span><br><span class="line"><span class="keyword">if</span>((pcount==0)); <span class="keyword">then</span></span><br><span class="line"><span class="built_in">echo</span> no args;</span><br><span class="line"><span class="built_in">exit</span>;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 获取文件名称</span></span><br><span class="line">p1=<span class="variable">$1</span></span><br><span class="line">fname=`<span class="built_in">basename</span> <span class="variable">$p1</span>`</span><br><span class="line"><span class="built_in">echo</span> fname=<span class="variable">$fname</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 获取上级目录到绝对路径</span></span><br><span class="line">pdir=`<span class="built_in">cd</span> -P $(<span class="built_in">dirname</span> <span class="variable">$p1</span>); <span class="built_in">pwd</span>`</span><br><span class="line"><span class="built_in">echo</span> pdir=<span class="variable">$pdir</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4 获取当前用户名称</span></span><br><span class="line">user=`<span class="built_in">whoami</span>`</span><br><span class="line"></span><br><span class="line"><span class="comment">#5 循环</span></span><br><span class="line"><span class="keyword">for</span>((host=103; host&lt;105; host++)); <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">echo</span> ------------------- hadoop<span class="variable">$host</span> --------------</span><br><span class="line">        rsync -rvl <span class="variable">$pdir</span>/<span class="variable">$fname</span> <span class="variable">$user</span>@hadoop<span class="variable">$host</span>:<span class="variable">$pdir</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改脚本文件 <code>xsync</code> 具有执行权限</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 ~]$ <span class="built_in">chmod</span> 777 xsync</span><br></pre></td></tr></table></figure></li>
<li><p>调用脚本形式：<code>xsync 文件名称</code></p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 ~]$ xsync /home/lvnengdong/bin</span><br><span class="line"><span class="comment"># 将 /bin 目录及其子目录或文件分发到集群中的其它机器上</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
<li><p> <strong>注意：</strong>如果将 <code>xsync</code> 放到 <code>/home/atguigu/bin</code> 目录下仍然不能实现全局使用，可以将 <code>xsync</code> 移动到 <code>/usr/local/bin</code> 目录下。</p>
</li>
</ol>
<hr>
<h1 id="集群搭建"><a href="#集群搭建" class="headerlink" title="集群搭建"></a>集群搭建</h1><h2 id="1、集群部署规划"><a href="#1、集群部署规划" class="headerlink" title="1、集群部署规划"></a>1、集群部署规划</h2><table>
<thead>
<tr>
<th align="left"></th>
<th align="left">hadoop102</th>
<th>hadoop103</th>
<th>hadoop104</th>
</tr>
</thead>
<tbody><tr>
<td align="left">HDFS</td>
<td align="left">NameNode<br>DataNode</td>
<td>DataNode</td>
<td>SecondaryNameNode<br>DataNode</td>
</tr>
<tr>
<td align="left">YARN</td>
<td align="left">NodeManager<br>Jobhistory</td>
<td>ResourceManager<br>NodeManager</td>
<td>NodeManager</td>
</tr>
</tbody></table>
<hr>
<h2 id="2、配置集群"><a href="#2、配置集群" class="headerlink" title="2、配置集群"></a>2、配置集群</h2><h3 id="核心配置文件"><a href="#核心配置文件" class="headerlink" title="核心配置文件"></a>核心配置文件</h3><p><strong>core-site.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定HDFS中NameNode的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hadoop102:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 指定Hadoop运行时产生文件的存储目录 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-2.7.2/data/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="HDFS配置文件"><a href="#HDFS配置文件" class="headerlink" title="HDFS配置文件"></a>HDFS配置文件</h3><p><strong>hdfs-site.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 副本数量（默认配置就是3.所以可以无需在自定义的配置文件中重写）--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 指定Hadoop辅助节点（2nn）的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop104:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="YARN配置文件"><a href="#YARN配置文件" class="headerlink" title="YARN配置文件"></a>YARN配置文件</h3><p><strong>yarn-site.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- reducer获取数据的方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 指定YARN的ResourceManager的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop103<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>





<h3 id="MapReduce配置文件"><a href="#MapReduce配置文件" class="headerlink" title="MapReduce配置文件"></a>MapReduce配置文件</h3><p><strong>mapred-site.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定mr运行在yarn上 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="在集群上分发配置好的Hadoop配置文件"><a href="#在集群上分发配置好的Hadoop配置文件" class="headerlink" title="在集群上分发配置好的Hadoop配置文件"></a>在集群上分发配置好的Hadoop配置文件</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xsync /opt/module/hadoop-2.7.2/</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="在集群中的每一台机器上都配置JAVA-HOME和HADOOP-HOME-环境变量"><a href="#在集群中的每一台机器上都配置JAVA-HOME和HADOOP-HOME-环境变量" class="headerlink" title="在集群中的每一台机器上都配置JAVA_HOME和HADOOP_HOME 环境变量"></a>在集群中的每一台机器上都配置JAVA_HOME和HADOOP_HOME 环境变量</h3><hr>
<h2 id="3、集群单点启动"><a href="#3、集群单点启动" class="headerlink" title="3、集群单点启动"></a>3、集群单点启动</h2><h2 id="4、集群群起"><a href="#4、集群群起" class="headerlink" title="4、集群群起"></a>4、集群群起</h2><h3 id="配置群起脚本"><a href="#配置群起脚本" class="headerlink" title="配置群起脚本"></a>配置群起脚本</h3><p><strong>作用：</strong>在集群中的所有机器上批量执行同一条命令</p>
<ol>
<li><p>在当前用户的家目录<code>~</code>下的 <code>bin</code> 目录下创建一个 <code>xcall</code> 脚本文件，文件内容如下：</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 在集群中的所有机器上批量执行同一条命令</span></span><br><span class="line"><span class="keyword">if</span>((<span class="variable">$#</span>==0))</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> 请输入您要操作的命令！</span><br><span class="line">	<span class="built_in">exit</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> 要执行的命令是$*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环执行此命令</span></span><br><span class="line"><span class="keyword">for</span>((i=102;i&lt;=104;i++))</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> ---------------------hadoop<span class="variable">$i</span>-----------------</span><br><span class="line">	ssh hadoop<span class="variable">$i</span> $*</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改脚本文件 <code>xsync</code> 具有执行权限</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 ~]$ <span class="built_in">chmod</span> 777 xsync</span><br></pre></td></tr></table></figure></li>
<li><p>测试脚本执行效果</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 bin]$ xcall jps</span><br><span class="line">要执行的命令是jps</span><br><span class="line">---------------------hadoop102-----------------</span><br><span class="line">34660 Jps</span><br><span class="line">---------------------hadoop103-----------------</span><br><span class="line">7595 Jps</span><br><span class="line">---------------------hadoop104-----------------</span><br><span class="line">26590 Jps</span><br></pre></td></tr></table></figure>

</li>
<li><p>将该脚本文件分发到集群的所有节点上</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 bin]$ xsync ./xcall </span><br><span class="line">==================== hadoop102 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line"></span><br><span class="line">sent 68 bytes  received 12 bytes  53.33 bytes/sec</span><br><span class="line">total size is 295  speedup is 3.69</span><br><span class="line">==================== hadoop103 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">xcall</span><br><span class="line"></span><br><span class="line">sent 410 bytes  received 35 bytes  890.00 bytes/sec</span><br><span class="line">total size is 295  speedup is 0.66</span><br><span class="line">==================== hadoop104 ====================</span><br><span class="line">sending incremental file list</span><br><span class="line">xcall</span><br><span class="line"></span><br><span class="line">sent 410 bytes  received 35 bytes  890.00 bytes/sec</span><br><span class="line">total size is 295  speedup is 0.66</span><br></pre></td></tr></table></figure>

</li>
</ol>
<hr>
<h1 id="启动-Hadoop"><a href="#启动-Hadoop" class="headerlink" title="启动 Hadoop"></a>启动 Hadoop</h1><h2 id="启动-HDFS"><a href="#启动-HDFS" class="headerlink" title="启动 HDFS"></a>启动 HDFS</h2><ol>
<li><p>启动 NameNode</p>
<ul>
<li><p>如果 NameNode 是第一次启动，需要在 NameNode 所在的节点上先执行格式化。</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 bin]$ hadoop namenode -format</span><br></pre></td></tr></table></figure></li>
</ul>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动 namenode</span></span><br><span class="line">[lvnengdong@hadoop102 bin]$ hadoop-daemon.sh start namenode</span><br></pre></td></tr></table></figure></li>
<li><p>启动 DataNode</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop-daemon.sh start namenode</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p><strong>测试</strong></p>
<ol>
<li><p> 在 hadoop102 上启动 NameNode</p>
</li>
<li><p> 在 hadoop102 上启动 DataNode</p>
</li>
<li><p> 在 hadoop103 上启动 DataNode</p>
</li>
<li><p>在 hadoop104 上启动 DataNode</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 hadoop102 上启动 NameNode</span></span><br><span class="line">[lvnengdong@hadoop102 bin]$ hadoop-daemon.sh start namenode</span><br><span class="line"></span><br><span class="line"><span class="comment"># 群起 DataNode</span></span><br><span class="line">[lvnengdong@hadoop102 bin]$ xcall hadoop-daemon.sh start datanode</span><br></pre></td></tr></table></figure></li>
<li><p>查看结果</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 bin]$ xcall jps</span><br><span class="line">要执行的命令是jps</span><br><span class="line">---------------------hadoop102-----------------</span><br><span class="line">52104 NameNode</span><br><span class="line">59609 Jps</span><br><span class="line">57549 DataNode</span><br><span class="line">---------------------hadoop103-----------------</span><br><span class="line">33104 Jps</span><br><span class="line">31189 DataNode</span><br><span class="line">---------------------hadoop104-----------------</span><br><span class="line">27345 Jps</span><br><span class="line">27148 DataNode</span><br><span class="line">[lvnengdong@hadoop102 bin]$ </span><br></pre></td></tr></table></figure></li>
<li><p>在 hadoop104 上启动 2nn</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop104 ~]$ hadoop-daemon.sh start secondarynamenode</span><br></pre></td></tr></table></figure></li>
<li><p>通过浏览器<code>http://hadoop102:50070</code>查看，三个 DataNode 都已经成功启动了</p>
<p> <img src="/2021/11/22/Hadoop%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211123121936190.png" alt="image-20211123121936190"></p>
</li>
</ol>
<hr>
<h2 id="启动-Yarn"><a href="#启动-Yarn" class="headerlink" title="启动 Yarn"></a>启动 Yarn</h2><p>Yarn 由 ResourceManager 和 DataManager 组成。我们规划在 Hadoop103 上启动 ResourceManager，在每个节点上都启动一个 DataManager。 </p>
<ol>
<li><p>在 Hadoop103 启动一个 ResourceManager</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 ~]$ yarn-daemon.sh start resourcemanager</span><br></pre></td></tr></table></figure>

</li>
<li><p>在每台服务器都启动一个DataManager </p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 ~]$ xcall yarn-daemon.sh start nodemanager</span><br></pre></td></tr></table></figure></li>
<li><p>查看</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 ~]$ xcall jps</span><br><span class="line">要执行的命令是jps</span><br><span class="line">---------------------hadoop102-----------------</span><br><span class="line">88133 NodeManager</span><br><span class="line">52104 NameNode</span><br><span class="line">89115 Jps</span><br><span class="line">57549 DataNode</span><br><span class="line">---------------------hadoop103-----------------</span><br><span class="line">62512 NodeManager</span><br><span class="line">31189 DataNode</span><br><span class="line">60693 ResourceManager</span><br><span class="line">63484 Jps</span><br><span class="line">---------------------hadoop104-----------------</span><br><span class="line">28049 Jps</span><br><span class="line">27148 DataNode</span><br><span class="line">27484 SecondaryNameNode</span><br><span class="line">27871 NodeManager</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>通过浏览器 <code>http://hadoop103:8088/</code> 查看</p>
<p> <img src="/2021/11/22/Hadoop%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211123122829328.png" alt="image-20211123122829328"></p>
</li>
</ol>
<h2 id="测试集群能否正常运行"><a href="#测试集群能否正常运行" class="headerlink" title="测试集群能否正常运行"></a>测试集群能否正常运行</h2><ol>
<li><p>在 HDFS 文件系统下创建一个目录 <code>/wcinput</code></p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 bin]$ hadoop fs -<span class="built_in">mkdir</span> /wcinput</span><br></pre></td></tr></table></figure></li>
<li><p>然后随便上传一个测试文件到 <code>/wcinput</code> 目录下</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 bin]$ hadoop fs -put xcall /wcinput</span><br></pre></td></tr></table></figure></li>
<li><p> 可以证明分布式 HDFS 是 OK 的。</p>
</li>
<li><p>再运行一个 MapReduce 程序来测试 Yarn 能否正常运行。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 bin]$ <span class="built_in">cd</span> /opt/module/hadoop-2.7.2/share/hadoop/mapreduce/</span><br><span class="line">[lvnengdong@hadoop102 mapreduce]$ hadoop jar hadoop-mapreduce-examples-2.7.2.jar wordcount /wcinput /wcoutput</span><br></pre></td></tr></table></figure></li>
<li><p> 通过网页查看 Yarn 也是可以正常执行的。</p>
</li>
</ol>
<hr>
<h1 id="集群群起"><a href="#集群群起" class="headerlink" title="集群群起"></a>集群群起</h1><p>上一章节启动 Hadoop 的方式是逐个启动进程来实现的，但是 Hadoop 也为我们提供了群起集群的脚本，保存在 <code>$HADOOP_HOME/sbin</code> 目录下。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 sbin]$ ll <span class="variable">$HADOOP_HOME</span>/sbin</span><br><span class="line">总用量 120</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 2752 5月  22 2017 distribute-exclude.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 6452 5月  22 2017 hadoop-daemon.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1360 5月  22 2017 hadoop-daemons.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1427 5月  22 2017 hdfs-config.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 2291 5月  22 2017 httpfs.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 3128 5月  22 2017 kms.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 4080 5月  22 2017 mr-jobhistory-daemon.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1648 5月  22 2017 refresh-namenodes.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 2145 5月  22 2017 slaves.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1471 5月  22 2017 start-all.sh	<span class="comment"># 群起脚本</span></span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1128 5月  22 2017 start-balancer.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 3734 5月  22 2017 start-dfs.sh	<span class="comment"># 只启动dfs集群</span></span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1357 5月  22 2017 start-secure-dns.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1347 5月  22 2017 start-yarn.sh	<span class="comment"># 只启动yarn集群</span></span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1462 5月  22 2017 stop-all.sh	<span class="comment"># 群关脚本</span></span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1179 5月  22 2017 stop-balancer.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 3206 5月  22 2017 stop-dfs.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1340 5月  22 2017 stop-secure-dns.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1340 5月  22 2017 stop-yarn.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 4295 5月  22 2017 yarn-daemon.sh</span><br><span class="line">-rwxr-xr-x. 1 lvnengdong lvnengdong 1353 5月  22 2017 yarn-daemons.sh</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="群起脚本的执行原理"><a href="#群起脚本的执行原理" class="headerlink" title="群起脚本的执行原理"></a>群起脚本的执行原理</h2><p>Hadoop 为我们提供的群起脚本的执行原理是：</p>
<ol>
<li> 读取当前机器下的 <code>$HADOOP_HOME/etc/hadoop/slaves</code> 文件，获取集群中所有节点的 IP 地址</li>
<li> 循环执行 <code>ssh IP地址 xxx-daemon.sh start xxx</code> 来启动各种 NameNode、DataNode、ResourceManager、NodeManager 等各种进程。</li>
</ol>
<h2 id="执行群起脚本的前提条件"><a href="#执行群起脚本的前提条件" class="headerlink" title="执行群起脚本的前提条件"></a>执行群起脚本的前提条件</h2><p>所以如果想要执行群起脚本的话，</p>
<ol>
<li> 首先需要将集群中所有节点的主机名（已经做过IP地址映射了）配置到 <code>$HADOOP_HOME/etc/hadoop/slaves</code> 文件中；</li>
<li> 因为群起脚本中执行的 SSH 操作，所以还需要保证当前机器到集群中的其它机器已经配置了 SSH 免密登录。</li>
<li> 因为群里脚本执行的属于 SSH 的 <strong>NonLogin</strong> 登录，所以还需要保证集群中所有用户的家目录 <code>~</code> 下的 <code>./bashrc</code> 文件中，已经配置了 <code>source /etc/profile</code> 属性。</li>
</ol>
<h2 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h2><p>在 Hadoop103 配置 <code>$HADOOP_HOME/etc/hadoop/slaves</code> 文件 </p>
<ol>
<li><p>修改<code>$HADOOP_HOME/etc/hadoop/slaves</code> 文件 </p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 sbin]$ vim <span class="variable">$HADOOP_HOME</span>/etc/hadoop/slaves</span><br></pre></td></tr></table></figure></li>
<li><p> 删除文件中原先的内容 localhost</p>
</li>
<li><p>将集群中的主机名配置到该文件中</p>
 <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hadoop102</span><br><span class="line">hadoop103</span><br><span class="line">hadoop104</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>注意事项：</strong></p>
<ul>
<li>  <code>start-all.sh</code> 命令，其实在底层分别调用了 <code>start-dfs.sh</code> 和 <code>start-yarn.sh</code> 命令</li>
<li>  在集群中的任意一台机器上调用 <code>start-dfs.sh</code> 命令，都可以启动 HDFS 中的所有进程。</li>
<li>  但是对于 <code>start-yarn.sh</code> ，如果在非 ResourceManager 所在的机器上调用，可以启动所有的 NodeManager，但是不会启动 ResourceManager。同理，群停命令 <code>stop-yarn.sh</code> 命令也一样。</li>
<li>  <strong>建议：</strong>1️⃣只需要配置 ResourceManager 所在机器到其它机器的 SSH 免密登录即可。2️⃣只在 ResourceManager 所在的机器上执行群起和群停脚本。3️⃣自定义的 <code>xsync</code> 和 <code>xcall</code> 脚本只放在 ResourceManager 所在的机器即可。</li>
</ul>
<hr>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ol>
<li><p>当前 Hadoop 集群（HDFS 和 Yarn）都处于启动状态，先测试一下群停</p>
<ul>
<li>  停止所有 yarn 相关的进程</li>
</ul>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 sbin]$ stop-yarn.sh</span><br></pre></td></tr></table></figure>

<ul>
<li><p>停止所有 dfs 进程</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 sbin]$ stop-dfs.sh</span><br><span class="line">Stopping namenodes on [hadoop102]</span><br><span class="line">hadoop102: stopping namenode</span><br><span class="line">hadoop103: stopping datanode</span><br><span class="line">hadoop102: stopping datanode</span><br><span class="line">hadoop104: stopping datanode</span><br><span class="line">Stopping secondary namenodes [hadoop104]</span><br><span class="line">hadoop104: stopping secondarynamenode</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
<li><p>测试群起</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 ~]$ start-all.sh</span><br><span class="line">This script is Deprecated. Instead use start-dfs.sh and start-yarn.sh</span><br><span class="line">Starting namenodes on [hadoop102]</span><br><span class="line">hadoop102: starting namenode, logging to /opt/module/hadoop-2.7.2/logs/hadoop-lvnengdong-namenode-hadoop102.out</span><br><span class="line">hadoop102: starting datanode, logging to /opt/module/hadoop-2.7.2/logs/hadoop-lvnengdong-datanode-hadoop102.out</span><br><span class="line">hadoop103: starting datanode, logging to /opt/module/hadoop-2.7.2/logs/hadoop-lvnengdong-datanode-hadoop103.out</span><br><span class="line">hadoop104: starting datanode, logging to /opt/module/hadoop-2.7.2/logs/hadoop-lvnengdong-datanode-hadoop104.out</span><br><span class="line">Starting secondary namenodes [hadoop104]</span><br><span class="line">hadoop104: starting secondarynamenode, logging to /opt/module/hadoop-2.7.2/logs/hadoop-lvnengdong-secondarynamenode-hadoop104.out</span><br><span class="line">starting yarn daemons</span><br><span class="line">starting resourcemanager, logging to /opt/module/hadoop-2.7.2/logs/yarn-lvnengdong-resourcemanager-hadoop102.out</span><br><span class="line">hadoop103: starting nodemanager, logging to /opt/module/hadoop-2.7.2/logs/yarn-lvnengdong-nodemanager-hadoop103.out</span><br><span class="line">hadoop104: starting nodemanager, logging to /opt/module/hadoop-2.7.2/logs/yarn-lvnengdong-nodemanager-hadoop104.out</span><br><span class="line">hadoop102: starting nodemanager, logging to /opt/module/hadoop-2.7.2/logs/yarn-lvnengdong-nodemanager-hadoop102.out</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</li>
</ol>
<hr>
<h1 id="配置历史日志服务器"><a href="#配置历史日志服务器" class="headerlink" title="配置历史日志服务器"></a>配置历史日志服务器</h1><p>Yarn 在启动后，主要作用是分配资源进行计算。相关程序在计算的过程中，不管是成功还是失败，都会产生一些日志数据。这些日志数据保存在专门的历史日志服务器中，配置历史服务器的步骤如下：</p>
<ol>
<li><p>配置 <code>mapred-site.xml</code>，在该文件里面增加如下配置：</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 表示将MapReduce在运行时产生的日志数据交给 hadoop102:10020 进程来处理 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 表示可以通过浏览器上访问 hadoop102:19888 来查看历史日志服务器上的数据 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--第三方框架使用yarn计算的日志聚集功能 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log.server.url<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>http://hadoop102:19888/jobhistory/logs<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>将更新后的配置文件分发到整个集群</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ xsync ./hadoop-2.7.2/</span><br></pre></td></tr></table></figure></li>
<li><p>启动历史服务器</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ mr-jobhistory-daemon.sh start historyserver</span><br></pre></td></tr></table></figure></li>
<li><p>查看历史服务器是否启动</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ jps</span><br></pre></td></tr></table></figure>

</li>
<li><p>查看 JobHistory</p>
<p> <code>http://hadoop102:19888/jobhistory</code></p>
<p> <img src="/2021/11/22/Hadoop%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211123173615772.png" alt="image-20211123173615772"></p>
</li>
</ol>
<hr>
<h1 id="配置日志的聚集"><a href="#配置日志的聚集" class="headerlink" title="配置日志的聚集"></a>配置日志的聚集</h1><p>在上一章我们已经配置好了历史日志服务器，并且可以通过历史日志服务器的IP地址来查看历史日志信息，但是每次都通过 IP 地址查看历史日志信息是非常不方便的。</p>
<p>在 Yarn 的 ResourceManager 界面上有一个超链接可以直接跳转到历史日志服务器，这个链接默认是不生效的，只有配置了 <code>yarn-site.xml</code> 后，才可以通过这个超链接直接跳转到历史日志服务界面。</p>
<p><img src="/2021/11/22/Hadoop%E5%AE%8C%E5%85%A8%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211123172955343.png" alt="image-20211123172955343"></p>
<ol>
<li><p>配置 <code>yarn-site.xml</code></p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 开启日志聚集功能（通过RM跳转到历史日志服务器） --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 设置日志保留时间为7天 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>将配置信息分发到集群中的各个节点上</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 module]$ xsync ./hadoop-2.7.2/</span><br></pre></td></tr></table></figure>

</li>
<li><p> 注意：修改配置文件后，需要重启 NodeManager 、ResourceManager 和 HistoryManager 等，重新加载配置文件。</p>
</li>
</ol>
<h2 id="测试："><a href="#测试：" class="headerlink" title="测试："></a>测试：</h2><ol>
<li><p> 停止 NodeManager、ResourceManager、NameNode、DataNode、HistoryManager</p>
</li>
<li><p>启动 NodeManager、ResourceManager、NameNode、DataNode、</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 module]$ start-all.sh</span><br></pre></td></tr></table></figure></li>
<li><p>启动 HistoryManager</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 module]$ mr-jobhistory-daemon.sh start historyserver</span><br></pre></td></tr></table></figure></li>
<li><p>测试：执行 wordcount 程序</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop103 mapreduce]$ <span class="built_in">cd</span> /opt/module/hadoop-2.7.2/share/hadoop/mapreduce/</span><br><span class="line">[lvnengdong@hadoop103 mapreduce]$ hadoop jar hadoop-mapreduce-examples-2.7.2.jar wordcount /wcinput /wcoutput2</span><br></pre></td></tr></table></figure></li>
<li><p> 测试通过网页跳转，OK。</p>
</li>
</ol>
<hr>
<h1 id="集群时间同步"><a href="#集群时间同步" class="headerlink" title="集群时间同步"></a>集群时间同步</h1>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">Hadoop集群搭建</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-21 11:57:51" itemprop="dateCreated datePublished" datetime="2021-11-21T11:57:51+08:00">2021-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-02-16 10:32:21" itemprop="dateModified" datetime="2022-02-16T10:32:21+08:00">2022-02-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Hadoop/" itemprop="url" rel="index"><span itemprop="name">Hadoop</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Hadoop-运行环境搭建"><a href="#Hadoop-运行环境搭建" class="headerlink" title="Hadoop 运行环境搭建"></a>Hadoop 运行环境搭建</h1><h2 id="安装前的注意事项"><a href="#安装前的注意事项" class="headerlink" title="安装前的注意事项"></a>安装前的注意事项</h2><ol>
<li><p>Hadoop项目是用Java语言实现的，Hadoop运行时依赖JDK相关的类库，所以安装Hadoop前必须保证当前机器已经安装了JDK，并且配置了 <code>JAVA_HOME</code> 全局变量。</p>
</li>
<li><p>Hadoop 集群本质上通过多个不同类型的进程配合工作，如 NameNode，DataNode，ResourceManager，NodeManager 等，这些进程往往部署在不同的机器上，并且进程之间需要互相通信。既然要通信时就需要知道彼此的 IP 地址和端口号，为了方便记忆和书写，我们往往会选择使用主机名进行通信，这时候就需要修改 <code>hosts</code> 文件配置主机名到 IP 的映射了。当然直接使用 IP 进行通信的话就无需配置主机名到 IP 的映射了。</p>
<ul>
<li>  host 文件在不同系统下的位置：</li>
</ul>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; Linux：/etc/hosts</span></span><br><span class="line"><span class="quote">&gt; Windows：C:\Windows\System32\drivers\etc\hosts</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>文件权限</strong>：Hadoop 在运行时会产生很多数据（包括 HDFS 存储的数据和每个节点的日志文件等），对于保存这些数据的目录，我们必须设置让当前启动 Hadoop 进程的用户拥有写权限。</p>
</li>
<li><p>关闭防火墙，并且关闭防火墙开机自启。</p>
</li>
</ol>
<hr>
<h2 id="使用普通用户操作-Hadoop"><a href="#使用普通用户操作-Hadoop" class="headerlink" title="使用普通用户操作 Hadoop"></a>使用普通用户操作 Hadoop</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 创建普通用户 Xxx</span><br><span class="line">    useradd Xxx</span><br><span class="line">2. 为 Xxx 设置密码</span><br><span class="line">    passwd 123456</span><br><span class="line">3. 赋予 Xxx 用户 root 权限</span><br><span class="line">    vim /etc/sudoers</span><br><span class="line">4. 将 /opt 目录下创建的 software 目录和 module 目录的属主改为 Xxx</span><br><span class="line">    <span class="built_in">chown</span> -R Xxx:Xxx /opt/software /opt/module</span><br></pre></td></tr></table></figure>



<hr>
<h2 id="安装-Hadoop"><a href="#安装-Hadoop" class="headerlink" title="安装 Hadoop"></a>安装 Hadoop</h2><ol>
<li><p> 将 <code>hadoop-2.7.2.tar.gz</code> 导入到 <code>opt/software</code> 目录下；</p>
</li>
<li><p>解压安装文件到 <code>/opt/module</code> 下面；</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf hadoop-2.7.2.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure></li>
<li><p><strong>将 HADOOP_HOME 添加到环境变量</strong></p>
<ul>
<li>  （1）获取 Hadoop 安装路径</li>
</ul>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ <span class="built_in">pwd</span></span><br><span class="line">/opt/module/hadoop-2.7.2</span><br></pre></td></tr></table></figure>

<ul>
<li><p>（2）编辑 <code>/etc/profile.d/my_env.sh</code> 文件</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/profile.d/my_env.sh</span><br></pre></td></tr></table></figure></li>
<li><p>（3）在文件末尾添加 <code>HADOOP_HOME</code></p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># HADOOP_HOME</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/opt/module/hadoop-2.7.2</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$HADOOP_HOME</span>/sbin</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>测试配置是否生效</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop version</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Hadoop-的目录介绍"><a href="#Hadoop-的目录介绍" class="headerlink" title="Hadoop 的目录介绍"></a>Hadoop 的目录介绍</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 module]$ ll hadoop-2.7.2/</span><br><span class="line">总用量 28</span><br><span class="line">drwxr-xr-x. 2 lvnengdong lvnengdong   194 5月  22 2017 bin</span><br><span class="line">drwxr-xr-x. 3 lvnengdong lvnengdong    20 5月  22 2017 etc</span><br><span class="line">drwxr-xr-x. 2 lvnengdong lvnengdong   106 5月  22 2017 include</span><br><span class="line">drwxr-xr-x. 3 lvnengdong lvnengdong    20 5月  22 2017 lib</span><br><span class="line">drwxr-xr-x. 2 lvnengdong lvnengdong   239 5月  22 2017 libexec</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong 15429 5月  22 2017 LICENSE.txt</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong   101 5月  22 2017 NOTICE.txt</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong  1366 5月  22 2017 README.txt</span><br><span class="line">drwxr-xr-x. 2 lvnengdong lvnengdong  4096 5月  22 2017 sbin</span><br><span class="line">drwxr-xr-x. 4 lvnengdong lvnengdong    31 5月  22 2017 share</span><br></pre></td></tr></table></figure>

<ul>
<li>  <strong>bin</strong>：存放对 Hadoop 相关服务（HDFS、MR 和 YARN ）进行操作的脚本。</li>
<li>  <strong>sbin</strong> ：存放管理员启动和停止集群时使用的命令脚本。</li>
<li>  <strong>etc</strong>：存放 Hadoop 的配置文件。</li>
<li>  <strong>lib</strong>：存放 Hadoop 的本地库</li>
<li>  <strong>share</strong>：存放 Hadoop 的依赖 jar 包、文件和官方案例。</li>
</ul>
<hr>
<h1 id="Hadoop-运行模式"><a href="#Hadoop-运行模式" class="headerlink" title="Hadoop 运行模式"></a>Hadoop 运行模式</h1><p>Hadoop 提供了两类三种运行模式，分别是：</p>
<ul>
<li>  <strong>本地模式</strong></li>
<li><strong>分布式模式</strong><ul>
<li>  伪分布式模式：如果 NN 和 DN 都在一台机器，且只有一个 DN 节点，称为伪分布式！</li>
<li>  完全分布式模式</li>
</ul>
</li>
</ul>
<p>这两种运行模式本质上其实就是 HDFS 的运行模式，分别对应了：</p>
<ul>
<li>  1️⃣在本地机器上使用 HDFS，即使用本地机器的文件系统。 </li>
<li>  2️⃣在多台机器上使用 HDFS，即使用了一个分布式的文件系统。</li>
</ul>
<p>Hadoop 安装后默认使用的本地模式，如果想要使用分布式模式，需要修改对应的配置文件中的配置参数。</p>
<h2 id="HDFS-运行模式配置"><a href="#HDFS-运行模式配置" class="headerlink" title="HDFS 运行模式配置"></a>HDFS 运行模式配置</h2><p>HDFS 采用哪种运行模式，取决于配置参数 <strong>fs.defaultFS</strong>，该参数要在 <code>core-default.xml</code> 配置文件中进行配置。默认使用的是本地模式。</p>
<p><strong>本地模式</strong></p>
<ul>
<li><p>  概念：使用当前计算机的文件系统作为 HDFS 的文件系统。</p>
</li>
<li><p>参数：</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">&lt;!-- core-default.xml --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- fs.defaultFS=file:///    （默认）【file:/// 是一种本地文件系统协议】 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>file:///<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>分布式模式</strong></p>
<ul>
<li><p>  概念：要使用的文件系统是一个分布式的文件系统！一个分布式的文件系统，必须由 NameNode，DataNode 等若干进程共同运行完成文件系统的读写操作！</p>
</li>
<li><p>参数：</p>
  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">&lt;!-- core-default.xml --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- fs.defaultFS=hdfs://     【hdfs:// 代表一种分布式文件系统协议】 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h2 id="MapReduce-的运行模式"><a href="#MapReduce-的运行模式" class="headerlink" title="MapReduce 的运行模式"></a>MapReduce 的运行模式</h2><ol>
<li><p>按照 MR 的规范编写一个程序；</p>
</li>
<li><p>将程序打成一个 jar 包</p>
</li>
<li><p>运行 jar 包。</p>
<p>运行 jar 包可以选择两种模式，分别是：1️⃣本地模式；2️⃣在 Yarn 上运行（将 jar 包提交给 Yarn，由 Yarn 调度资源完成运算）。具体使用哪一种模式由参数由参数 <code>mapreduce.framework.name</code> 决定，该参数也需要在 <code>core-default.xml</code> 配置文件中进行配置。默认值是：<code>mapreduce.framework.name=local</code>，表示在本地模式下运行。</p>
</li>
</ol>
<p><strong>MapReduce 的两种运行方式</strong></p>
<ol>
<li><p><strong>本地模式</strong>：在本地运行 MR，即在本机使用多线程的方式模拟多个 Task 的运行。对应的在  <code>mapred-default.xml</code> 配置文件中的配置信息为：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mapred-default.xml --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- mapreduce.framework.name=local --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>local<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>在 YARN 上运行</strong>：需要启动 YARN，YARN 由 RM 和 NM 进程组成，所以还需要启动 RM 和 NM。将 MR 生成的 Job 提交给 YARN ，由 YARN 负责将 Job 中拆分成多个 Task 并分配到多台机器中运算。对应的在  <code>mapred-default.xml</code> 配置文件中的配置信息为：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- mapred-default.xml --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- mapreduce.framework.name=yarn --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>local<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="Hadoop-的配置文件"><a href="#Hadoop-的配置文件" class="headerlink" title="Hadoop 的配置文件"></a>Hadoop 的配置文件</h1><p>同大多数的项目一样，Hadoop 安装后，为我们提供了 4 个默认的配置文件，通过加载默认配置文件已经可以正常启动一个 Hadoop 项目。但是，如果想要使用自定义配置信息的话，有两种方法：</p>
<ul>
<li>  <strong>方式一</strong>：Hadoop 同时也提供了 4 个自定义配置文件支持用户使用自定义的配置文件覆盖默认配置信息。Hadoop 在启动时，会先加载 4 个默认的配置文件，再加载用户自定义的配置文件，如果自定义的配置文件中出现了和默认配置文件中同名的参数，就会覆盖默认配置文件中的值。</li>
<li>  <strong>方式二</strong>：通过显式指定配置参数的方法启动Hadoop，这种方法的弊端是仅在当前次有效，当集群重启后还是会以配置文件中的配置信息为准。</li>
</ul>
<h2 id="四个默认配置文件"><a href="#四个默认配置文件" class="headerlink" title="四个默认配置文件"></a>四个默认配置文件</h2><p> <strong>默认配置文件所在目录：</strong>默认配置文件直接内嵌在Hadoop依赖的类库中，具体目录为：</p>
<ul>
<li>  <code>$HADOOP_HOME/share</code>：该目录下保存 着 Hadoop 启动时需要加载的所有 jar 包。</li>
<li>  <code>$HADOOP_HOME/share/hadoop/.../xxx.jar/xxx-default.xml</code> ：默认配置文件的保存路径，4个配置文件分别保存在4个不同的 jar 包的类路径下</li>
</ul>
<p><strong>默认配置文件：</strong></p>
<ul>
<li><strong>core-default.xml</strong>    保存 Hadoop 最核心的配置参数</li>
<li><strong>hdfs-default.xml</strong>    保存 HDFS 相关的参数</li>
<li><strong>mapred-default.xm</strong>l   保存 MapReduce 相关的参数</li>
<li><strong>yarn-default.xml</strong>    保存 YARN 相关的参数</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop-common-2.7.7.jar  ==&gt; core-default.xml <span class="comment"># core-default.xml 配置文件保存在  hadoop-common-2.7.2.jar 这个jar包中</span></span><br><span class="line">hadoop-hdfs-2.7.2.jar ==&gt; hdfs-default.xml</span><br><span class="line">hadoop-mapreduce-client-core-2.7.2.jar ==&gt; mapred-default.xml</span><br><span class="line">hadoop-yarn-common-2.7.2.jar ==&gt; yarn-default.xml</span><br></pre></td></tr></table></figure>





<hr>
<h2 id="四个用户自定义配置文件"><a href="#四个用户自定义配置文件" class="headerlink" title="四个用户自定义配置文件"></a>四个用户自定义配置文件</h2><p><strong>注意事项：</strong></p>
<ul>
<li>  4个用户自定义配置文件必须命名为 <code>xxx-site.xml</code>，只有这样<strong>用户自定义的配置文件才会覆盖默认配置文件中的同名参数。</strong></li>
<li>  Hadoop 在启动时，首先会加载 4 个默认的配置文件，再加载用户自定义的配置文件，如果用户自定义的配置文件中有和默认配置文件中同名的参数，可以覆盖之前已经加载的值！</li>
</ul>
<p><strong>自定义配置文件所在目录：</strong><code>$HADOOP_HOME/etc/hadoop/</code> </p>
<p><strong>自定义配置文件：</strong></p>
<ul>
<li>  <strong>core-site.xml</strong>    保存用户自定义的 Hadoop 最核心的配置参数</li>
<li>  <strong>hdfs-site.xml</strong>    保存用户自定义的 HDFS 相关的参数</li>
<li>  <strong>mapred-site.xml</strong>    保存用户自定义的 MapReduce 相关的参数</li>
<li>  <strong>yarn-site.xml</strong>    保存用户自定义的 YARN 相关的参数</li>
</ul>
<hr>
<h2 id="配置文件使用小技巧"><a href="#配置文件使用小技巧" class="headerlink" title="配置文件使用小技巧"></a>配置文件使用小技巧</h2><p><strong>小技巧1：</strong></p>
<p>在 <code>$HADOOP_HOME/etc/hadoop/</code> 目录下保存了四个自定义配置信息的模板，我们在需要使用自定义配置的时候可以直接拷贝这几个配置文件并加以修改使用。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ ll <span class="variable">$HADOOP_HOME</span>/etc/hadoop/ | grep site.xml</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong   774 5月  22 2017 core-site.xml</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong   775 5月  22 2017 hdfs-site.xml</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong   620 5月  22 2017 httpfs-site.xml</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong  5511 5月  22 2017 kms-site.xml</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong   758 5月  22 2017 mapred-site.xml.template</span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong   690 5月  22 2017 yarn-site.xml</span><br></pre></td></tr></table></figure>





<p><strong>小技巧2</strong></p>
<ol>
<li><p><strong>在使用 Hadoop 命令时可以手动指定加载哪个目录下的配置文件</strong></p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在Linux终端中键入 `hadoop`，会提示如下信息 </span></span><br><span class="line">[lvnengdong@hadoop102 hadoop]$ hadoop</span><br><span class="line">Usage: hadoop [--config confdir] [COMMAND | CLASSNAME]</span><br><span class="line"></span><br><span class="line"><span class="comment"># [--config confdir] 表示在使用 hadoop 命令时可以手动指定要加载哪个目录中的自定义配置文件</span></span><br></pre></td></tr></table></figure>

<ul>
<li>  <strong>如果未显式指定配置文件的目录，默认读取 <code>$HADOOP_HOME/etc/hadoop</code> 目录下对应的自定义配置文件！</strong></li>
</ul>
</li>
</ol>
<hr>
<h1 id="本地-HDFS-使用测试"><a href="#本地-HDFS-使用测试" class="headerlink" title="本地 HDFS 使用测试"></a>本地 HDFS 使用测试</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用：hadoop fs 命令 文件路径</span><br><span class="line"><span class="comment"># 表示使用 hadoop 的 file system 执行操作</span></span><br></pre></td></tr></table></figure>

<ul>
<li>  <code>hadoop fs</code> 常见命令</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ hadoop fs</span><br><span class="line">Usage: hadoop fs [generic options]</span><br><span class="line">	[-appendToFile &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-<span class="built_in">cat</span> [-ignoreCrc] &lt;src&gt; ...]</span><br><span class="line">	[-checksum &lt;src&gt; ...]</span><br><span class="line">	[-<span class="built_in">chgrp</span> [-R] GROUP PATH...]</span><br><span class="line">	[-<span class="built_in">chmod</span> [-R] &lt;MODE[,MODE]... | OCTALMODE&gt; PATH...]</span><br><span class="line">	[-<span class="built_in">chown</span> [-R] [OWNER][:[GROUP]] PATH...]</span><br><span class="line">	[-copyFromLocal [-f] [-p] [-l] &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-copyToLocal [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;]</span><br><span class="line">	[-count [-q] [-h] &lt;path&gt; ...]</span><br><span class="line">	[-<span class="built_in">cp</span> [-f] [-p | -p[topax]] &lt;src&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-createSnapshot &lt;snapshotDir&gt; [&lt;snapshotName&gt;]]</span><br><span class="line">	[-deleteSnapshot &lt;snapshotDir&gt; &lt;snapshotName&gt;]</span><br><span class="line">	[-<span class="built_in">df</span> [-h] [&lt;path&gt; ...]]</span><br><span class="line">	[-<span class="built_in">du</span> [-s] [-h] &lt;path&gt; ...]</span><br><span class="line">	[-expunge]</span><br><span class="line">	[-find &lt;path&gt; ... &lt;expression&gt; ...]</span><br><span class="line">	[-get [-p] [-ignoreCrc] [-crc] &lt;src&gt; ... &lt;localdst&gt;]</span><br><span class="line">	[-getfacl [-R] &lt;path&gt;]</span><br><span class="line">	[-getfattr [-R] &#123;-n name | -d&#125; [-e en] &lt;path&gt;]</span><br><span class="line">	[-getmerge [-<span class="built_in">nl</span>] &lt;src&gt; &lt;localdst&gt;]</span><br><span class="line">	[-<span class="built_in">help</span> [cmd ...]]</span><br><span class="line">	[-<span class="built_in">ls</span> [-d] [-h] [-R] [&lt;path&gt; ...]]</span><br><span class="line">	[-<span class="built_in">mkdir</span> [-p] &lt;path&gt; ...]</span><br><span class="line">	[-moveFromLocal &lt;localsrc&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-moveToLocal &lt;src&gt; &lt;localdst&gt;]</span><br><span class="line">	[-<span class="built_in">mv</span> &lt;src&gt; ... &lt;dst&gt;]</span><br><span class="line">	[-put [-f] [-p] [-l] &lt;localsrc&gt; ... &lt;dst&gt;]	<span class="comment"># 上传文件，&lt;localsrc&gt;表示文件源地址；&lt;dst&gt;表示目的地址</span></span><br><span class="line">	[-renameSnapshot &lt;snapshotDir&gt; &lt;oldName&gt; &lt;newName&gt;]</span><br><span class="line">	[-<span class="built_in">rm</span> [-f] [-r|-R] [-skipTrash] &lt;src&gt; ...]</span><br><span class="line">	[-<span class="built_in">rmdir</span> [--ignore-fail-on-non-empty] &lt;<span class="built_in">dir</span>&gt; ...]</span><br><span class="line">	[-setfacl [-R] [&#123;-b|-k&#125; &#123;-m|-x &lt;acl_spec&gt;&#125; &lt;path&gt;]|[--<span class="built_in">set</span> &lt;acl_spec&gt; &lt;path&gt;]]</span><br><span class="line">	[-setfattr &#123;-n name [-v value] | -x name&#125; &lt;path&gt;]</span><br><span class="line">	[-setrep [-R] [-w] &lt;rep&gt; &lt;path&gt; ...]</span><br><span class="line">	[-<span class="built_in">stat</span> [format] &lt;path&gt; ...]</span><br><span class="line">	[-<span class="built_in">tail</span> [-f] &lt;file&gt;]</span><br><span class="line">	[-<span class="built_in">test</span> -[defsz] &lt;path&gt;]</span><br><span class="line">	[-text [-ignoreCrc] &lt;src&gt; ...]</span><br><span class="line">	[-touchz &lt;path&gt; ...]</span><br><span class="line">	[-<span class="built_in">truncate</span> [-w] &lt;length&gt; &lt;path&gt; ...]</span><br><span class="line">	[-usage [cmd ...]]</span><br><span class="line"></span><br></pre></td></tr></table></figure>







<ol>
<li><p>创建一个 testUpload 文件用于测试文件上传</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ vim /opt/module/hadoop-2.7.2/etc/hadoop/testUpload</span><br><span class="line"></span><br><span class="line"><span class="comment"># testUpload 文件内容为：</span></span><br><span class="line">测试文件上传</span><br></pre></td></tr></table></figure></li>
<li><p>在当前目录创建一个保存自定义配置文件的目录 <code>myconfig</code></p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> myconfig</span><br></pre></td></tr></table></figure></li>
<li><p>运行 <code>hadoop fs</code> 命令上传文件</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ hadoop --config myconfig fs -put testUpload /</span><br><span class="line"><span class="comment"># 表示加载 myconfig 目录下的配置文件，完成将当前目录下的 testUpload 文件上传到 HDFS 的根目录（/）下</span></span><br><span class="line"><span class="comment"># 因为在本地模式下HDFS使用的就是当前Linux系统的文件系统，所以 / 就表示当前Linux系统的根目录</span></span><br></pre></td></tr></table></figure></li>
<li><p>报错信息分析</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># core-site.xml not found，因为我们创建的 myconfig 目录是一个空目录，没有任何的自定义配置文件，</span></span><br><span class="line"><span class="comment"># 而如果配置了 --config，则至少需要有一个自定义的 core-site.xml 文件。</span></span><br><span class="line"><span class="comment"># 解决办法是在 myconfig 目录下创建一个 core-site.xml 自定义配置文件</span></span><br><span class="line">Exception <span class="keyword">in</span> thread <span class="string">&quot;main&quot;</span> java.lang.RuntimeException: core-site.xml not found</span><br><span class="line">	at org.apache.hadoop.conf.Configuration.loadResource(Configuration.java:2566)</span><br><span class="line">	at org.apache.hadoop.conf.Configuration.loadResources(Configuration.java:2492)</span><br><span class="line">	at org.apache.hadoop.conf.Configuration.getProps(Configuration.java:2405)</span><br><span class="line">	at org.apache.hadoop.conf.Configuration.<span class="built_in">set</span>(Configuration.java:1143)</span><br><span class="line">	at org.apache.hadoop.conf.Configuration.<span class="built_in">set</span>(Configuration.java:1115)</span><br><span class="line">	at org.apache.hadoop.conf.Configuration.setBoolean(Configuration.java:1451)</span><br><span class="line">	at org.apache.hadoop.util.GenericOptionsParser.processGeneralOptions(GenericOptionsParser.java:321)</span><br><span class="line">	at org.apache.hadoop.util.GenericOptionsParser.parseGeneralOptions(GenericOptionsParser.java:487)</span><br><span class="line">	at org.apache.hadoop.util.GenericOptionsParser.&lt;init&gt;(GenericOptionsParser.java:170)</span><br><span class="line">	at org.apache.hadoop.util.GenericOptionsParser.&lt;init&gt;(GenericOptionsParser.java:153)</span><br><span class="line">	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:64)</span><br><span class="line">	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:84)</span><br><span class="line">	at org.apache.hadoop.fs.FsShell.main(FsShell.java:340)</span><br></pre></td></tr></table></figure></li>
<li><p>将 <code>$HADOOP_HOME/etc/hadoop/</code> 目录下的 <code>core-site.xml</code> 配置文件复制到 <code>myconfig</code> 目录下</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ <span class="built_in">cp</span> <span class="variable">$HADOOP_HOME</span>/etc/hadoop/core-site.xml myconfig/</span><br></pre></td></tr></table></figure></li>
<li><p>重新执行文件上传命令</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ hadoop --config myconfig fs -put testUpload /</span><br><span class="line">put: /testUpload._COPYING_ (权限不够)</span><br></pre></td></tr></table></figure></li>
<li><p> 报错信息分析：因为当前使用的是本地模式，也就是说 HDFS 使用 Linux 的本地文件系统，而我们当前登录的用户对 HDFS 的根目录 <code>/</code> 是没有操作权限的，我们可以将该文件上传到一个当前登录用户拥有权限的目录下，该命令就可以正常执行了。</p>
</li>
<li><p>重新执行上传命令</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ hadoop --config myconfig fs -put testUpload /opt/module/</span><br><span class="line">[lvnengdong@hadoop102 hadoop]$ <span class="built_in">echo</span> $?</span><br><span class="line">0	<span class="comment"># 表示上一条命令执行成功</span></span><br></pre></td></tr></table></figure></li>
<li><p>执行结果验证</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ ll /opt/module/</span><br><span class="line">总用量 4</span><br><span class="line"><span class="comment"># ..</span></span><br><span class="line">-rw-r--r--. 1 lvnengdong lvnengdong  19 11月 21 20:47 testUpload</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 /opt/module/ 目录下多出了一个 testUpload，表示文件上传执行成功了</span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="分布式-HDFS-使用测试"><a href="#分布式-HDFS-使用测试" class="headerlink" title="分布式 HDFS 使用测试"></a>分布式 HDFS 使用测试</h1><h2 id="分布式-HDFS-常用命令"><a href="#分布式-HDFS-常用命令" class="headerlink" title="分布式 HDFS 常用命令"></a>分布式 HDFS 常用命令</h2><p>在分布式 HDFS 中，需要额外管理 NameNode、DataNode 等，所以针对 NameNode、DataNode 等有额外的操作命令。</p>
<h3 id="启动与停止"><a href="#启动与停止" class="headerlink" title="启动与停止"></a>启动与停止</h3><p><strong>NameNode</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动Namenode	</span></span><br><span class="line">hadoop-daemon.sh start namenode</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止Namenode	</span></span><br><span class="line">hadoop-daemon.sh stop namenode</span><br></pre></td></tr></table></figure>



<p><strong>DataNode</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动datanode	</span></span><br><span class="line">hadoop-daemon.sh start datanode</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止datanode</span></span><br><span class="line">hadoop-daemon.sh stop datanode</span><br></pre></td></tr></table></figure>

<ul>
<li>  上述四条命令都是 sbin 目录中的脚本【sbin 已经被添加到环境变量中了】</li>
</ul>
<hr>
<h3 id="查看-NameNode-DataNode-进程状态"><a href="#查看-NameNode-DataNode-进程状态" class="headerlink" title="查看 NameNode/DataNode 进程状态"></a>查看 NameNode/DataNode 进程状态</h3><ol>
<li><p><strong>jps命令</strong>    </p>
<ul>
<li>  因为 Hadoop 是用 Java 实现的，所以可以直接用 <code>jps</code> 命令查看 NameNode 和 DataNode 进程的运行状态。</li>
</ul>
</li>
<li><p>通过<strong>浏览器访问</strong></p>
<ul>
<li>  Hadoop 给我们提供了可视化的管理界面，可以访问该页面查看 HDFS 中相关进程（包括 NameNode 和 DataNode）的运行状态。</li>
</ul>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 访问地址</span></span><br><span class="line">http://&#123;NameNode所在主机的IP地址&#125;:50070</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过浏览器访问是通过 http 协议访问的，而 NameNode 的 http 协议访问端口号是 50070</span></span><br><span class="line"><span class="comment"># 当前还可以通过 RPC 协议来访问 NameNode，RPC 访问端口号是我们在配置文件中自定义的，一般都设置为 9000</span></span><br><span class="line"><span class="comment"># DataNode 被 NameNode 管理，所以在 NameNode 的可视化管理界面可以查看 DataNode 线程的信息</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<hr>
<h3 id="格式化-Namenode"><a href="#格式化-Namenode" class="headerlink" title="格式化 Namenode"></a>格式化 Namenode</h3><p><strong>命令：</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop namenode -format</span><br></pre></td></tr></table></figure>

<p><strong>注意：格式化 Namenode 只需要执行一次</strong></p>
<p><strong>作用：</strong>格式化时，首先会根据配置文件 <code>core-default.xml</code> 或 <code>core-site.xml</code> 中的配置信息生成用于保存 NameNode 和 DataNode 数据的目录；并在这个目录中生成一些版本验证文件。</p>
<p><strong>Demo：</strong></p>
<ol>
<li><p> 使用 <code>hadoop namenode -format</code> 命令自动创建的保存 NameNode 和 DataNode 数据的目录；</p>
</li>
<li><p> 并使用 <code>tree</code> 命令查看这个命令的目录结构。</p>
</li>
<li><p>我们发现在这个目录下会多出一个 <strong>dfs</strong> 目录，<strong>name</strong> 目录用于保存 NameNode 节点的数据，并且继续深入还会有一些目录和文件，这些目录和文件用于进行版本验证，表明当前目录就是一个 NameNode 保存运行时数据的目录。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ tree /opt/module/hadoop-2.7.2/data/</span><br><span class="line">/opt/module/hadoop-2.7.2/data/</span><br><span class="line">└── dfs</span><br><span class="line">    └── name	<span class="comment"># name 目录用于保存 NameNode 节点的数据文件</span></span><br><span class="line">        ├── current</span><br><span class="line">        │   ├── edits_inprogress_0000000000000000001</span><br><span class="line">        │   ├── fsimage_0000000000000000000</span><br><span class="line">        │   ├── fsimage_0000000000000000000.md5</span><br><span class="line">        │   ├── seen_txid</span><br><span class="line">        │   └── VERSION</span><br><span class="line">        └── in_use.lock</span><br></pre></td></tr></table></figure></li>
<li><p>由于当前我们还没有启动 DataNode 节点，当启动 DataNode 节点并向该节点上传数据后，该目录下会新出现一个 <code>./dfs/data/...</code> 目录用于存储 DataNode 运行时产生的数据。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ tree /opt/module/hadoop-2.7.2/data/</span><br><span class="line">/opt/module/hadoop-2.7.2/data/</span><br><span class="line">└── dfs</span><br><span class="line">    ├── data	<span class="comment"># data 目录用于保存 DataNode 节点的数据文件</span></span><br><span class="line">    │   ├── current</span><br><span class="line">    │   │   ├── BP-401557870-192.168.1.102-1637506411781</span><br><span class="line">    │   │   │   ├── current</span><br><span class="line">    │   │   │   │   ├── finalized</span><br><span class="line">    │   │   │   │   │   └── subdir0</span><br><span class="line">    │   │   │   │   │       └── subdir0</span><br><span class="line">    │   │   │   │   │           ├── blk_1073741825	<span class="comment"># block块的id，与浏览器中展示的块的id一致</span></span><br><span class="line">    │   │   │   │   │           └── blk_1073741825_1001.meta</span><br><span class="line">    │   │   │   │   ├── rbw</span><br><span class="line">    │   │   │   │   └── VERSION</span><br><span class="line">    │   │   │   ├── scanner.cursor</span><br><span class="line">    │   │   │   └── tmp</span><br><span class="line">    │   │   └── VERSION</span><br><span class="line">    │   └── in_use.lock</span><br><span class="line">    └── name	<span class="comment"># name 目录用于保存 NameNode 节点的数据文件</span></span><br><span class="line">        ├── current</span><br><span class="line">        │   ├── edits_inprogress_0000000000000000001</span><br><span class="line">        │   ├── fsimage_0000000000000000000</span><br><span class="line">        │   ├── fsimage_0000000000000000000.md5</span><br><span class="line">        │   ├── seen_txid</span><br><span class="line">        │   └── VERSION</span><br><span class="line">        └── in_use.lock</span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h2 id="NameNode-通信地址原理分析"><a href="#NameNode-通信地址原理分析" class="headerlink" title="NameNode 通信地址原理分析"></a>NameNode 通信地址原理分析</h2><p>HDFS（Hadoop分布式文件系统）就是一个服务器集群，HDFS 集群是由一个 NameNode 和多个 DataNode 组成的，其中 NameNode 负责保存元数据信息、<strong>与 DataNode 通信</strong>以及<strong>与客户端通信</strong>。既然要通信，那么就必须明确两点：</p>
<ol>
<li> <strong>通信协议：</strong>在 Hadoop 中，客户端与 NameNode（服务器端）， NameNode 和 DataNode 之间通信采用的都是 RPC 协议，并且如果使用 HDFS 文件传输的话，还需要满足 <code>hdfs://</code> 文件传输协议。</li>
<li> <strong>通信地址：</strong>NameNode 在这三者中处于通信的核心地位，既要和 DataNode 通信，又要和客户端通信，所以 NameNode 必须对外暴露自己的通信地址，让客户端和 NameNode 可以找到自己。又因为 NameNode 是一个线程，唯一定位一个线程需要 IP 地址和端口号两个因素。</li>
</ol>
<p>在 <code>core-site.xml</code> 配置文件中，<code>fs.defaultFS</code> 属性配置的其实就是 NameNode 的通信地址，用于让客户端和 DataNode 能够找到自己，NameNode 进程的通信地址由 IP 地址和端口号组成。如果不配置端口号的话每次启动线程时 NameNode 所在的服务器都会随机分配一个端口号给 NameNode 进程，不方便客户端和 DataNode 查找到 NameNode，所以我们一般会将 NameNode 的端口号写死，这样每次启动 NameNode 时使用的就都是同一端口号了。</p>
<hr>
<h2 id="NameNode-生成保存数据的目录原理分析"><a href="#NameNode-生成保存数据的目录原理分析" class="headerlink" title="NameNode 生成保存数据的目录原理分析"></a>NameNode 生成保存数据的目录原理分析</h2><p><strong>手动指定保存数据的目录</strong></p>
<p>Hadoop 在运行期间，HDFS 中的 NameNode 节点中需要一定的磁盘空间来保存元数据，DataNode 节点需要一定的磁盘空间来保存真正的数据，在默认配置文件 <code>core-default.xml</code> 中，设置了将每个节点会数据都保存在当前服务器的 <code>/tmp/hadoop-用户名/dfs</code> 目录下，而我们当前的服务器上可能并没有这个目录，所以一定要事先将这个目录创建好。</p>
<p>由于 <code>/tmp</code> 目录是 Linux 系统中的一个临时目录，每 15 天会自动清空一次，所以为了防止数据丢失，我们一般会重新指定这个目录。这时就需要在自定义的配置文件 <code>hdfs-core.xml</code> 中重写配置信息覆盖 <strong>hadoop.tmp.dir</strong> 属性。</p>
<ul>
<li>  默认配置文件 <code>core-default.xml</code> 中的配置信息</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- core-default.xml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>/tmp/hadoop-$&#123;user.name&#125;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>A base for other temporary directories.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>  自定义配置文件 <code>core-site.xml</code> 中的配置信息</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">     配置 HDFS 框架在运行时产生的数据的存储目录。</span></span><br><span class="line"><span class="comment">	（1）NameNode 上保存的元数据等信息,</span></span><br><span class="line"><span class="comment">	（2）DataNode 上保存的真实数据信息</span></span><br><span class="line"><span class="comment">  都保存在该目录下。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-2.7.2/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>使用格式化指令创建保存数据的目录</strong></p>
<p>在上面的配置文件中，我们设置了 HDFS 中数据的保存目录。所以我们必须事先在 NameNode 节点的服务器上创建这个目录后才能成功启动 NameNode。<strong>但是</strong>这个文件并不是一个空目录，也就是说如果我们通过 <code>mkdir</code> 命令创建的空目录是无法识别为能够保存 HDFS 数据的目录，能够保存 HDFS 数据的目录中必须有一个版本验证文件，如果想要创建一个包含版本验证文件的目录，我们需要通过 Hadoop 提供的格式化工具<strong>（hadoop namenode -format）</strong>生成一个目录，并且会自动在这个目录下生成一个版本号。</p>
<hr>
<h2 id="实操"><a href="#实操" class="headerlink" title="实操"></a>实操</h2><ol>
<li> 如果想要使用分布式的 HDFS，首先需要在自定义配置文件 <code>core-site.xml</code> 中重写默认配置文件中的  <code>fs.defaultFS</code> 属性为 <code>hdfs://</code>。它的含义是设置文件传输协议为 hdfs，表示 FileSystem 为 hdfs 分布式文件系统。</li>
<li> 同时要设置 NameNode 的唯一通信地址为：<code>hadoop102:9000</code>（IP地址 + 端口号）</li>
<li> 二者结合一下就变成了 <code>hdfs://hadoop102:9000</code></li>
<li> 在 <code>core-site.xml</code> 中重写 NameNode 和 DataNode 保存数据的目录</li>
<li> 使用 Hadoop 提供的格式化命令 <code>hadoop namenode -format</code> 创建这个保存数据的目录。</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">    1、使用分布式文件存储系统</span></span><br><span class="line"><span class="comment">    2、通知DataNode和客户端NameNode的唯一地址</span></span><br><span class="line"><span class="comment">    [Hadoop 集群中的各个进程之间需要互相通信，通过 RPC 方式通信：</span></span><br><span class="line"><span class="comment">        （1）客户端与 NN 直接通信；</span></span><br><span class="line"><span class="comment">        （2）DN 与 NN 也要进行通信。</span></span><br><span class="line"><span class="comment">    所以我们必须在集群中每台机器的配置文件 core-site.xml 中配置 NN 的通信地址]</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hadoop102:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line">    <span class="comment">&lt;!-- hadoop102:主机名到IP地址的映射</span></span><br><span class="line"><span class="comment">	 9000：NameNode进程在RPC协议下的端口号（随便取，只要不被占用即可）</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">     配置 HDFS 框架在运行时产生的数据的存储目录。</span></span><br><span class="line"><span class="comment">	（1）NameNode 上保存的元数据等信息,</span></span><br><span class="line"><span class="comment">	（2）DataNode 上保存的真实数据信息</span></span><br><span class="line"><span class="comment">  都保存在该目录下。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-2.7.2/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>







<hr>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><ol>
<li><p>首先，修改上一章节使用过的自定义配置文件 <code>./myconfig/core-site.xml</code> 。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ vim myconfig/core-site.xml</span><br></pre></td></tr></table></figure></li>
<li><p>添加自定义的 NameNode 配置信息。</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hadoop102:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>使用自定义的配置文件启动 NameNode</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ hadoop-daemon.sh --config /opt/module/hadoop-2.7.2/etc/hadoop/myconfig/ start namenode</span><br><span class="line"><span class="comment"># 启动后的输出的信息</span></span><br><span class="line">starting namenode, logging to /opt/module/hadoop-2.7.2/logs/hadoop-lvnengdong-namenode-hadoop102.out</span><br><span class="line"><span class="comment"># 这条信息表示，启动 namenode 后，所有的日志信息都会保存在这个目录下，目录的组成信息为：</span></span><br><span class="line"><span class="comment"># $HADOOP_HOME/logs/hadoop-用户名-进程名-主机名.out</span></span><br><span class="line"><span class="comment"># out 表示日志输出时的配置文件，真正的日志其实保存在 logs 目录下的 `xxx.log` 文件中</span></span><br><span class="line">2021-11-21 21:56:35,921 INFO  [main] namenode.NameNode (LogAdapter.java:info(47)) - STARTUP_MSG: </span><br><span class="line">/************************************************************</span><br><span class="line">STARTUP_MSG: Starting NameNode</span><br><span class="line">STARTUP_MSG:   host = hadoop102/192.168.1.102</span><br><span class="line">STARTUP_MSG:   args = []</span><br><span class="line">STARTUP_MSG:   version = 2.7.2</span><br><span class="line">......</span><br></pre></td></tr></table></figure></li>
<li><p>查看进程是否启动成功。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ jps</span><br><span class="line"><span class="comment"># 发现未启动成功</span></span><br></pre></td></tr></table></figure></li>
<li><p>查看日志信息</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打印日志文件的后100行信息</span></span><br><span class="line">[lvnengdong@hadoop102 logs]$ <span class="built_in">tail</span> -n 100 hadoop-lvnengdong-namenode-hadoop102.out</span><br></pre></td></tr></table></figure></li>
<li><p>storage directory does not exist or is not accessible ==&gt;存储目录不存在或不可访问。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /tmp/hadoop-lvnengdong/dfs/name is in an inconsistent state: storage directory does not exist or is not accessible.</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverStorageDirs(FSImage.java:<span class="number">327</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:<span class="number">215</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.loadFSImage(FSNamesystem.java:<span class="number">975</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.loadFromDisk(FSNamesystem.java:<span class="number">681</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.loadNamesystem(NameNode.java:<span class="number">584</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:<span class="number">644</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.&lt;init&gt;(NameNode.java:<span class="number">811</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.&lt;init&gt;(NameNode.java:<span class="number">795</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:<span class="number">1488</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.main(NameNode.java:<span class="number">1554</span>)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">异常分析：</span></span><br><span class="line"><span class="comment">	因为我们在自定义的配置文件中未重写 NameNode 和 DataNode 保存数据的目录，所以在项目启动时</span></span><br><span class="line"><span class="comment">	使用的仍然是默认配置文件中的配置，也就是说会把数据保存在 /tmp/hadoop-用户名/dfs/ 目录下，</span></span><br><span class="line"><span class="comment">	但是该目录在当前服务器上并不存在，所以才会报错“storage directory does not exist or is not accessible”</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
<li><p>在自定义的配置文件 <code>hdfs-core.xml</code> 中添加配置信息覆盖 <strong>hadoop.tmp.dir</strong> 属性。</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/module/hadoop-2.7.2/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>并创建 <code>/opt/module/hadoop-2.7.2/data</code> 目录</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 myconfig]$ <span class="built_in">mkdir</span> /opt/module/hadoop-2.7.2/data</span><br></pre></td></tr></table></figure></li>
<li><p>重新启动 NameNode</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 myconfig]$ hadoop-daemon.sh --config /opt/module/hadoop-2.7.2/etc/hadoop/myconfig/ start namenode</span><br></pre></td></tr></table></figure></li>
<li><p> 使用 jps 命令查看发现仍然没有 NameNode 进程；</p>
</li>
<li><p>查看日志：发现错误信息仍然显示保存数据的目录没有创建，但是我们确实创建了。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /opt/<span class="keyword">module</span>/hadoop-<span class="number">2.7</span><span class="number">.2</span>/data/dfs/name is in an inconsistent state: storage directory does not exist or is not accessible.</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverStorageDirs(FSImage.java:<span class="number">327</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:<span class="number">215</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.loadFSImage(FSNamesystem.java:<span class="number">975</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.loadFromDisk(FSNamesystem.java:<span class="number">681</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.loadNamesystem(NameNode.java:<span class="number">584</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:<span class="number">644</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.&lt;init&gt;(NameNode.java:<span class="number">811</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.&lt;init&gt;(NameNode.java:<span class="number">795</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:<span class="number">1488</span>)</span><br><span class="line">	at org.apache.hadoop.hdfs.server.namenode.NameNode.main(NameNode.java:<span class="number">1554</span>)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">异常分析：</span></span><br><span class="line"><span class="comment">	这个错误是因为目前我们虽然创建了和配置文件中一致的目录来保存NameNode和DataNode运行时产生的数据，</span></span><br><span class="line"><span class="comment">	但是由于这个目录是我们通过 mkdir 手动创建的，是一个空目录，该目录中并没有版本验证文件，所以无法</span></span><br><span class="line"><span class="comment">	证明这个目录就是用来保存 NameNode 和 DataNode 数据的目录。为了解决这个问题，我们还需要通过</span></span><br><span class="line"><span class="comment">	Hadoop提供的格式化工具来自动根据配置文件生成带版本号的可以保存NameNode生产数据的目录。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></li>
<li><p>先删除我们自己创建的 <code>/opt/module/hadoop-2.7.2/data</code> 目录</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ <span class="built_in">rm</span> -rf data</span><br></pre></td></tr></table></figure></li>
<li><p>使用 <strong>hadoop namenode -format</strong> 格式化工具自动生成带版本号文件的目录</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop --config /opt/module/hadoop-2.7.2/etc/hadoop/myconfig/ namenode -format</span><br></pre></td></tr></table></figure></li>
<li><p>我们发现在执行完这条命令后会根据配置文件自动帮我们创建一个 <strong>data</strong> 目录，并在 <code>data</code> 目录下自动帮我们创建了一个 <strong>dfs</strong> 文件，这个 <code>dfs</code> 文件就是存储 NameNode 和 DataNode 运行时数据的目录。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ ll data/</span><br><span class="line">总用量 0</span><br><span class="line">drwxrwxr-x. 3 lvnengdong lvnengdong 18 11月 21 22:53 dfs</span><br></pre></td></tr></table></figure></li>
<li><p>重新启动 NameNode</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 myconfig]$ hadoop-daemon.sh --config /opt/module/hadoop-2.7.2/etc/hadoop/myconfig/ start namenode</span><br></pre></td></tr></table></figure></li>
<li><p>使用 jps 命令查看，发现此时 NameNode 进程已经成功启动了。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ jps</span><br><span class="line">94994 Jps</span><br><span class="line">94543 NameNode</span><br></pre></td></tr></table></figure></li>
<li><p>还可以通过浏览器界面来访问 NameNode</p>
<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122102444283.png" alt="image-20211122102444283"></p>
</li>
<li><p>使用当前配置文件启动一个 NameNode</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 myconfig] $ hadoop-daemon.sh --config /opt/module/hadoop-2.7.2/etc/hadoop/myconfig/ start datanode</span><br></pre></td></tr></table></figure></li>
<li><p>查看 DataNode 是否成功启动</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ jps</span><br><span class="line">50678 DataNode</span><br><span class="line">51053 Jps</span><br><span class="line">94543 NameNode</span><br></pre></td></tr></table></figure></li>
<li><p>或者在浏览器中查看 DataNode 的启动情况</p>
<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122104518498.png" alt="image-20211122104518498"></p>
</li>
<li><p>当 NameNode 和 DataNode 都启动成功后，执行上传文件命令</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ hadoop --config /opt/module/hadoop-2.7.2/etc/hadoop/myconfig/ fs -put /opt/module/hadoop-2.7.2/etc/hadoop/testUpload /</span><br><span class="line"><span class="comment"># 表示加载 myconfig 目录下的配置文件，完成将 testUpload 文件上传到 HDFS 的根目录（/）下</span></span><br></pre></td></tr></table></figure></li>
<li><p>上传完成后，通过浏览器查看是否上传成功</p>
<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122105055584.png" alt="image-20211122105055584"></p>
<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122105640671.png" alt="image-20211122105640671"></p>
</li>
<li><p>也可以在 HDFS 指定的保存数据的目录下查看上传的文件信息</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ tree /opt/module/hadoop-2.7.2/data/</span><br><span class="line">/opt/module/hadoop-2.7.2/data/</span><br><span class="line">└── dfs</span><br><span class="line">    ├── data	<span class="comment"># data 目录用于保存 DataNode 节点的数据文件</span></span><br><span class="line">    │   ├── current</span><br><span class="line">    │   │   ├── BP-401557870-192.168.1.102-1637506411781</span><br><span class="line">    │   │   │   ├── current</span><br><span class="line">    │   │   │   │   ├── finalized</span><br><span class="line">    │   │   │   │   │   └── subdir0</span><br><span class="line">    │   │   │   │   │       └── subdir0</span><br><span class="line">    │   │   │   │   │           ├── blk_1073741825	<span class="comment"># block块的id，与浏览器中展示的块的id一致</span></span><br><span class="line">    │   │   │   │   │           └── blk_1073741825_1001.meta</span><br><span class="line">    │   │   │   │   ├── rbw</span><br><span class="line">    │   │   │   │   └── VERSION</span><br><span class="line">    │   │   │   ├── scanner.cursor</span><br><span class="line">    │   │   │   └── tmp</span><br><span class="line">    │   │   └── VERSION</span><br><span class="line">    │   └── in_use.lock</span><br><span class="line">    └── name	<span class="comment"># name 目录用于保存 NameNode 节点的数据文件</span></span><br><span class="line">        ├── current</span><br><span class="line">        │   ├── edits_inprogress_0000000000000000001</span><br><span class="line">        │   ├── fsimage_0000000000000000000</span><br><span class="line">        │   ├── fsimage_0000000000000000000.md5</span><br><span class="line">        │   ├── seen_txid</span><br><span class="line">        │   └── VERSION</span><br><span class="line">        └── in_use.lock</span><br></pre></td></tr></table></figure>

</li>
<li><p>继续查看 <code>blk_1073741825</code> 块文件的信息，发现内容与我们之前写的 testUpLoad 文件一致</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ <span class="built_in">cat</span> /opt/module/hadoop-2.7.2/data/dfs/data/current/BP-401557870-192.168.1.102-1637506411781/current/finalized/subdir0/subdir0/blk_1073741825</span><br><span class="line">测试上传文件</span><br></pre></td></tr></table></figure>

</li>
</ol>
<hr>
<h1 id="本地-MapReduce-测试"><a href="#本地-MapReduce-测试" class="headerlink" title="本地 MapReduce 测试"></a>本地 MapReduce 测试</h1><p>在 <code>$HADOOP_HOME/share/hadoop/mapreduce/</code> 目录下有一个自带的 MapReduce 测试案例 <code>hadoop-mapreduce-examples-2.7.2.jar</code>，我们可以直接调用这个 jar 包进行测试。</p>
<ol>
<li><p>进入到实例程序 jar 包所在的目录</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop-2.7.2]$ <span class="built_in">cd</span> share/hadoop/mapreduce/</span><br></pre></td></tr></table></figure></li>
<li><p>尝试执行这个 jar 包</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 mapreduce]$ hadoop jar hadoop-mapreduce-examples-2.7.2.jar </span><br><span class="line">An example program must be given as the first argument. <span class="comment"># 实例程序必须给一个参数，这个参数就是要执行该jar包下的哪个方法</span></span><br><span class="line">Valid program names are:</span><br><span class="line">  aggregatewordcount: An Aggregate based map/reduce program that counts the words <span class="keyword">in</span> the input files.</span><br><span class="line">  aggregatewordhist: An Aggregate based map/reduce program that computes the histogram of the words <span class="keyword">in</span> the input files.</span><br><span class="line">  bbp: A map/reduce program that uses Bailey-Borwein-Plouffe to compute exact digits of Pi.</span><br><span class="line">  dbcount: An example job that count the pageview counts from a database.</span><br><span class="line">  distbbp: A map/reduce program that uses a BBP-<span class="built_in">type</span> formula to compute exact bits of Pi.</span><br><span class="line">  grep: A map/reduce program that counts the matches of a regex <span class="keyword">in</span> the input.</span><br><span class="line">  <span class="built_in">join</span>: A job that effects a <span class="built_in">join</span> over sorted, equally partitioned datasets</span><br><span class="line">  multifilewc: A job that counts words from several files.</span><br><span class="line">  pentomino: A map/reduce tile laying program to find solutions to pentomino problems.</span><br><span class="line">  pi: A map/reduce program that estimates Pi using a quasi-Monte Carlo method.</span><br><span class="line">  randomtextwriter: A map/reduce program that writes 10GB of random textual data per node.</span><br><span class="line">  randomwriter: A map/reduce program that writes 10GB of random data per node.</span><br><span class="line">  secondarysort: An example defining a secondary <span class="built_in">sort</span> to the reduce.</span><br><span class="line">  <span class="built_in">sort</span>: A map/reduce program that sorts the data written by the random writer.</span><br><span class="line">  sudoku: A sudoku solver.</span><br><span class="line">  teragen: Generate data <span class="keyword">for</span> the terasort</span><br><span class="line">  terasort: Run the terasort</span><br><span class="line">  teravalidate: Checking results of terasort</span><br><span class="line">  wordcount: A map/reduce program that counts the words <span class="keyword">in</span> the input files.	<span class="comment"># 单词统计方法</span></span><br><span class="line">  wordmean: A map/reduce program that counts the average length of the words <span class="keyword">in</span> the input files.</span><br><span class="line">  wordmedian: A map/reduce program that counts the median length of the words <span class="keyword">in</span> the input files.</span><br><span class="line">  wordstandarddeviation: A map/reduce program that counts the standard deviation of the length of the words <span class="keyword">in</span> the input files.</span><br></pre></td></tr></table></figure></li>
<li><p>尝试执行该 jar 包下的 wordcount 方法</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 mapreduce]$ hadoop jar hadoop-mapreduce-examples-2.7.2.jar wordcount</span><br><span class="line">Usage: wordcount &lt;<span class="keyword">in</span>&gt; [&lt;<span class="keyword">in</span>&gt;...] &lt;out&gt;</span><br><span class="line"><span class="comment"># 调用 wordcount 方法必须传递一个或多个源文件路径和一个统计结果保存的路径</span></span><br><span class="line"><span class="comment"># 源文件路径和统计结果保存的路径都是HDFS上的路径</span></span><br></pre></td></tr></table></figure></li>
<li><p>当前 HDFS 的 NameNode 的根目录下有一个 <code>testUpLoad</code> 文件，我们可以统计该文件中单词的个数</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 mapreduce]$ hadoop jar hadoop-mapreduce-examples-2.7.2.jar wordcount / /result</span><br><span class="line"><span class="comment"># 调用 wordcount 方法统计根目录 `/` 下的所有文件中的单词个数，并把结果输出到 `/result` 目录下 </span></span><br></pre></td></tr></table></figure></li>
<li><p>查看浏览器发现根目录下多了一个 <code>/result</code> 目录</p>
<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122173553541.png" alt="image-20211122173553541"></p>
</li>
<li><p><code>/result</code> 目录</p>
<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122173729381.png" alt="image-20211122173729381"></p>
</li>
<li><p><code>part-r-00000</code>，</p>
<p> 我们可以将这个文件下载到本地查看，发现该文件就是统计了 <code>/</code> 目录下每个单词出现的次数。</p>
<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122174007581.png" alt="image-20211122174007581"></p>
</li>
</ol>
<hr>
<h1 id="在-YARN-上运行-MapReduce"><a href="#在-YARN-上运行-MapReduce" class="headerlink" title="在 YARN 上运行 MapReduce"></a>在 YARN 上运行 MapReduce</h1><h2 id="1、修改-MapReduce-的运行模式"><a href="#1、修改-MapReduce-的运行模式" class="headerlink" title="1、修改 MapReduce 的运行模式"></a>1、修改 MapReduce 的运行模式</h2><ol>
<li><p>默认的 MapReduce 的运行模式是本地模式。我们可以通过 MapReduce 的默认配置文件 <code>mapred-default.xml</code> 来查看。</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>local<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">description</span>&gt;</span>The runtime framework for executing MapReduce jobs.</span><br><span class="line">  Can be one of local, classic or yarn. </span><br><span class="line">  <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	运行模式可以是 local、classic、yarn 中的任意一个，默认选择的 local</span></span><br><span class="line"><span class="comment">		（1）local 是本地模式</span></span><br><span class="line"><span class="comment">		（2）classic 是Hadoop1.x 版本提供的一种运行模式</span></span><br><span class="line"><span class="comment">		（3）yarn 是将MR程序交给YARN去执行</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>如果我们想要通过 Yarn 来执行 MapReduce 程序，就需要在自定义的配置文件中重写这个配置信息。在 <code>$HADOOP_HOME/etc/hadoop/</code> 目录下创建并修改 <code>mapred-site.xml</code> 文件的信息，添加如下配置：</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">     将 MapReduce 从本地模式改为在 YARN 上运行</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="2、启动-Yarn"><a href="#2、启动-Yarn" class="headerlink" title="2、启动 Yarn"></a>2、启动 Yarn</h2><p><strong>配置 ResourceManager 的通信地址</strong></p>
<p>Yarn 由 ResourceManager 和 NodeManager 线程组成。同理，Yarn 作为一个服务器集群，其中的 ResourceManager 既要负责和客户端通信，又要负责和 NodeManager 通信，所以 ResourceManager 必须对外暴露自己的服务地址。这一信息要在 <code>yarn-default.xml</code> 配置文件中进行修改。修改 <code>$HADOOP_HOME/etc/hadoop/yarn-site.xml</code> 文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">     配置 Yarn 的 ResourceManager 的服务地址</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop102<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>配置 Reducer 获取数据的方式</strong></p>
<ul>
<li>  MapReduce 思想处理数据的方式是将任务拆分执行，最后将结果合并，这时候就可能出现多个 Map 间需要进行数据共享的问题，那么这多个 Map 之间数据传递的方式就叫做 shuffle，所以我们必须配置这一属性，否则在 Yarn 上运行 MR 程序时就会报错。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">     配置 Reducer 获取数据的方式</span></span><br><span class="line"><span class="comment">     Map 阶段处理好的数据最后要传递到 Reducer 上使用。</span></span><br><span class="line"><span class="comment">     而传递数据的方式称为 shuffle ，所以 YARN 中必须配置shuffle 才能正常运行</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>





<p><strong>启动</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、启动 RM</span></span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、启动 NM</span></span><br><span class="line">yarn-daemon.sh start nodemanager</span><br></pre></td></tr></table></figure>



<p><strong>查看</strong></p>
<ol>
<li><p>通过 jps 命令查看</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 hadoop]$ jps</span><br><span class="line">63025 NodeManager</span><br><span class="line">35193 NameNode</span><br><span class="line">36077 DataNode</span><br><span class="line">62367 ResourceManager</span><br><span class="line">64799 Jps</span><br></pre></td></tr></table></figure></li>
<li><p>通过浏览器查看</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">访问：http://&#123;ResourceManager线程所在机器的IP&#125;:8088</span><br><span class="line"><span class="comment"># ResourceManager 对外暴露的 http 端口号是 8088</span></span><br></pre></td></tr></table></figure>

<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122183127209.png" alt="image-20211122183127209"></p>
</li>
</ol>
<hr>
<h2 id="3、提交任务"><a href="#3、提交任务" class="headerlink" title="3、提交任务"></a>3、提交任务</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar  jar包  主类名 参数&#123;多个输入目录，一个输出目录&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><p>在<code>/opt/module/hadoop-2.7.2/share/hadoop/mapreduce</code> 目录下创建一个文件<code>testMR</code></p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 mapreduce]$ vim testMR</span><br></pre></td></tr></table></figure></li>
<li><p>编辑该文件的内容为：</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">test</span></span><br><span class="line">MR</span><br><span class="line">demo</span><br></pre></td></tr></table></figure></li>
<li><p>将该文件上传到 HDFS 的<code>/mr</code> 目录下</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 mapreduce]$ hadoop fs -put ./testMR /mr</span><br></pre></td></tr></table></figure></li>
<li><p>调用 wordcount 方法统计目录 <code>/mr</code> 下的所有文件中的单词个数，并把结果输出到 <code>/count</code> 目录下</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 mapreduce]$ hadoop jar hadoop-mapreduce-examples-2.7.2.jar wordcount /mr /count</span><br></pre></td></tr></table></figure></li>
<li><p>通过浏览器查看执行结果。</p>
<p> <img src="/2021/11/21/Hadoop%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/image-20211122194846938.png" alt="image-20211122194846938"></p>
</li>
</ol>
<p><strong>注意事项：</strong></p>
<ol>
<li> 更改配置信息后需要重启 ResourceManager 和 NodeManager！</li>
<li> 输入目录中必须全部是文件，不能有目录。如果有目录的话会报错！</li>
<li> 输出目录必须不存在！</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/20/Linux%E2%80%94%E2%80%94%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/20/Linux%E2%80%94%E2%80%94%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%AE%A1%E7%90%86/" class="post-title-link" itemprop="url">Linux——软件包管理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-20 22:28:08" itemprop="dateCreated datePublished" datetime="2021-11-20T22:28:08+08:00">2021-11-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-04-25 17:09:47" itemprop="dateModified" datetime="2022-04-25T17:09:47+08:00">2022-04-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="1-RPM"><a href="#1-RPM" class="headerlink" title="1 RPM"></a>1 RPM</h1><h3 id="1-1-RPM-概述"><a href="#1-1-RPM-概述" class="headerlink" title="1.1 RPM 概述"></a>1.1 RPM 概述</h3><p>RPM（RedHat Package Manager），RedHat 软件包管理工具，类似 Windows 里面的 setup.exe 。是 Linux 这系列操作系统里面的打包安装工具，它虽然是 RedHat 的标志，但理念是通用的。</p>
<p>RPM包的名称格式：</p>
<blockquote>
<p>Apache-1.3.23-11.i386.rpm</p>
<ul>
<li>“Apache” 软件名称</li>
<li>“1.3.23-11” 软件的版本号，主版本和此版本</li>
<li>“i386” 是软件所运行的硬件平台，Intel 32位微处理器的统称</li>
<li>“rpm” 文件扩展名，代表RPM包</li>
</ul>
</blockquote>
<h3 id="1-2-RPM查询命令（rpm-qa）"><a href="#1-2-RPM查询命令（rpm-qa）" class="headerlink" title="1.2 RPM查询命令（rpm -qa）"></a>1.2 RPM查询命令（rpm -qa）</h3><ol>
<li><p>基本语法</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&gt; rpm -qa</span><br><span class="line"><span class="comment"># qa  -- query all</span></span><br></pre></td></tr></table></figure></li>
<li><p> 功能描述：查询当前系统已安装的所有 rpm 软件包</p>
</li>
<li><p>经验技巧：由于已安装的软件包比较多，一般都会采取过滤查询。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&gt; rpm -qa | grep rpm软件包名称 命令</span><br></pre></td></tr></table></figure></li>
<li><p>Demo：查询 <code>firefox</code> 软件安装情况</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$&gt; rpm -qa | grep firefox</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示结果：firefox-45.0.1-1.el6.centos.x86_64</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<hr>
<h3 id="1-3-RPM卸载命令（rpm-e）"><a href="#1-3-RPM卸载命令（rpm-e）" class="headerlink" title="1.3 RPM卸载命令（rpm -e）"></a>1.3 RPM卸载命令（rpm -e）</h3><ol>
<li> <strong>基本语法</strong></li>
</ol>
<ul>
<li><code>rpm -e RPM软件包名</code>  </li>
<li><code>rpm -e --nodeps 软件包名</code></li>
</ul>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-e</code></td>
<td align="left">卸载软件包。卸载前会自动检查是否有其它软件依赖此软件包，如果有则卸载失败。</td>
</tr>
<tr>
<td align="left"><code>--nodeps</code></td>
<td align="left">不检查依赖直接卸载。也就是说如果有其它软件依赖此软件包，那么所有依赖该软件包的软件将全部不能正常运行。</td>
</tr>
</tbody></table>
<ol start="3">
<li> Demo：卸载 firefox 软件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e firefox</span><br></pre></td></tr></table></figure>





<h3 id="1-4-RPM安装命令（rpm-ivh）"><a href="#1-4-RPM安装命令（rpm-ivh）" class="headerlink" title="1.4 RPM安装命令（rpm -ivh）"></a>1.4 RPM安装命令（rpm -ivh）</h3><ol>
<li><p><strong>基本语法</strong></p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&gt; rpm -ivh RPM包全名</span><br></pre></td></tr></table></figure>

</li>
<li><p> <strong>选项说明</strong></p>
</li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-i</code></td>
<td align="left">-i=install，安装</td>
</tr>
<tr>
<td align="left"><code>-v</code></td>
<td align="left">-v=verbose，显示详细信息</td>
</tr>
<tr>
<td align="left"><code>-h</code></td>
<td align="left">-h=hash，进度条</td>
</tr>
<tr>
<td align="left"><code>--nodeps</code></td>
<td align="left">–nodeps，不检测依赖进度</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<ul>
<li>安装firefox软件</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh firefox-45.0.1-1.el6.centos.x86_64.rpm </span><br></pre></td></tr></table></figure>







<hr>
<h1 id="2-YUM-仓库配置"><a href="#2-YUM-仓库配置" class="headerlink" title="2 YUM 仓库配置"></a>2 YUM 仓库配置</h1><h2 id="1、YUM-概述"><a href="#1、YUM-概述" class="headerlink" title="1、YUM 概述"></a>1、YUM 概述</h2><p>YUM（Yellow dog Updater, Modified）是一个在 Fedora 和 RedHat 以及 CentOS 中的 Shell 前端软件包管理器。</p>
<p>基于RPM包管理，能够从指定的服务器自动下载 RPM 包并且安装，<strong>可以自动处理依赖性关系</strong>，并且一次安装所有依赖的软件包，无须繁琐地一次次下载、安装。</p>
<h2 id="2、YUM-的常用命令"><a href="#2、YUM-的常用命令" class="headerlink" title="2、YUM 的常用命令"></a>2、YUM 的常用命令</h2><ol>
<li><p>基本语法</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&gt; yum [选项] [参数] 软件包名</span><br></pre></td></tr></table></figure>

<ul>
<li><p>选项说明：</p>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-y</td>
<td>对所有提问都回答“yes”</td>
</tr>
</tbody></table>
</li>
<li><p>参数说明</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td><code>install</code></td>
<td>安装rpm软件包</td>
</tr>
<tr>
<td><code>update</code></td>
<td>更新rpm软件包</td>
</tr>
<tr>
<td><code>check-update</code></td>
<td>检查是否有可用的更新rpm软件包</td>
</tr>
<tr>
<td><code>remove</code></td>
<td>删除指定的rpm软件包</td>
</tr>
<tr>
<td><code>list</code></td>
<td>显示软件包信息</td>
</tr>
<tr>
<td><code>clean</code></td>
<td>清理yum过期的缓存</td>
</tr>
<tr>
<td><code>deplist</code></td>
<td>显示yum软件包的所有依赖关系</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
</ol>
<ol start="2">
<li><p>Demo：采用 yum 方式安装 firefox</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&gt; yum -y install firefox.x86_64</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="3、配置-YUM-源镜像"><a href="#3、配置-YUM-源镜像" class="headerlink" title="3、配置 YUM 源镜像"></a>3、配置 YUM 源镜像</h2><p>系统默认使用的 YUM 源，需要连接国外的 apache 网站，网速比较慢。可以通过修改 YUM 源为国内镜像的网站（如网易163），来提高访问速度。</p>
<p>访问网易 Yum 源的镜像地址：<a target="_blank" rel="noopener" href="http://mirrors.163.com/.help/centos.html">http://mirrors.163.com/.help/centos.html</a> 。参照网页上的使用说明进行操作。</p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%AE%A1%E7%90%86/image-20220423112120504.png" alt="image-20220423112120504"></p>
<ol>
<li><p> 首先下载对应的版本的 repo 文件，上传到 Linux 系统的 <code>/etc/yum.repos.d/</code> 目录下。我这里选择 CentOS7 版本，下载的文件名称为 CentOS7-Base-163.repo。</p>
</li>
<li><p>备份系统默认的 repo 文件</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&gt; <span class="built_in">mv</span> /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</span><br></pre></td></tr></table></figure></li>
<li><p>将 CentOS7-Base-163.repo 重命名为 CentOS7-Base.repo</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&gt; <span class="built_in">mv</span> /etc/yum.repos.d/CentOS7-Base-163.repo /etc/yum.repos.d/CentOS-Base.repo</span><br></pre></td></tr></table></figure></li>
<li><p>运行以下命令生成缓存</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、首先清空从原来服务器上拉取的包信息的缓存信息</span></span><br><span class="line">$&gt; yum clean all	</span><br><span class="line"><span class="comment"># 2、拉取网易服务器上的包信息，并缓存到本地</span></span><br><span class="line">$&gt; yum makecache</span><br></pre></td></tr></table></figure></li>
<li><p>测试</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum list | grep firefox		<span class="comment"># 这时候执行该命令就会发现拉取到了当前服务器上最新的Firefox浏览器的软件包信息 </span></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="安装-JDK"><a href="#安装-JDK" class="headerlink" title="安装 JDK"></a>安装 JDK</h1><h2 id="1、卸载现有-JDK"><a href="#1、卸载现有-JDK" class="headerlink" title="1、卸载现有 JDK"></a>1、卸载现有 JDK</h2><ol>
<li><p>查询当前机器是否安装了 Java</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rpm -qa | grep -i java</span><br><span class="line"><span class="comment"># 【-i 是忽略大小写差别】</span></span><br></pre></td></tr></table></figure></li>
<li><p>如果安装了且版本与预期的不符，则卸载该 JDK</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -e --nodeps 软件包名</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="2、安装-JDK"><a href="#2、安装-JDK" class="headerlink" title="2、安装 JDK"></a>2、安装 JDK</h2><ol>
<li><p> 在 <code>/opt</code> 目录下下创建 <code>module</code>、<code>software </code>文件夹；</p>
</li>
<li><p> 将 JDK 的安装包上传到 <code>/opt/software</code> 文件夹中；</p>
</li>
<li><p>将 JDK 的安装包解压到 <code>/opt/module</code> 文件夹中</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[lvnengdong@hadoop102 profile.d]$ tar -xzvf jdk-8u121-linux-x64.tar.gz -C /opt/module/</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="3、配置环境变量"><a href="#3、配置环境变量" class="headerlink" title="3、配置环境变量"></a>3、配置环境变量</h2><ol>
<li><p>先获取 JDK 的环境变量；</p>
<p> 在 <code>/opt/module/jdk1.8.0_121/</code> 目录下使用 pwd 获取当前路径，这个路径就是 JDK 的路径，因为在该路径下有一个 <code>./bin</code> 目录保存了常见的 JDK 命令执行脚本。</p>
</li>
<li><p>配置环境变量有两种方法：</p>
<ul>
<li><p>一种是直接修改 <code>/etc/profile</code> 文件，在文件末尾追加 JAVA_HOME 内容。（这种不推荐，因为在 <code>/etc/profile</code> 文件中有很多Linux 系统默认配置的系统变量，一个是不方便我们管理自己配置的环境变量，另一个就是如果将该文件修改坏了会导致其它环境变量出错）。追加的内容如下：</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/module/jdk1.8.0_121</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure></li>
<li><p>另一种是在 <code>/etc/profile.d/</code> 目录下<strong>新建</strong> <code>my_env.sh</code> 文件专门用于保存用户自己配置的环境变量，推荐使用这种方式。同样在 <code>my_env.sh</code> 文件中追加以下内容：</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># JAVA_HOME</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/opt/module/jdk1.8.0_121</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p> 保存退出，如有需要重启机器，让配置生效。</p>
</li>
<li><p>检测环境变量是否生效。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -version</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/20/Linux%E2%80%94%E2%80%94%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%92%8C%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/20/Linux%E2%80%94%E2%80%94%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%92%8C%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/" class="post-title-link" itemprop="url">Linux——网络配置和系统管理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-20 16:58:08" itemprop="dateCreated datePublished" datetime="2021-11-20T16:58:08+08:00">2021-11-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-02-10 16:42:22" itemprop="dateModified" datetime="2022-02-10T16:42:22+08:00">2022-02-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="虚拟机网络设置"><a href="#虚拟机网络设置" class="headerlink" title="虚拟机网络设置"></a>虚拟机网络设置</h1><h2 id="两种网络连接模式"><a href="#两种网络连接模式" class="headerlink" title="两种网络连接模式"></a>两种网络连接模式</h2><p>一般我们在 Windows 系统中创建 Linux 虚拟机时，如果需要连接网络，一般我们可以选择两种网络连接模式。分别是<strong>桥接模式</strong>和<strong>NAT模式</strong>。</p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%92%8C%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/image-20211120173443175.png" alt="image-20211120173443175"></p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%92%8C%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/image-20211119223034173.png" alt="image-20211119223034173"></p>
<h3 id="桥接模式"><a href="#桥接模式" class="headerlink" title="桥接模式"></a>桥接模式</h3><p>处于桥接模式下的虚拟机，拥有自己独立的 IP 地址，并且以这个 IP 地址去请求外网。也就是说当前模式下真实主机的 IP 地址和虚拟主机的 IP 地址是相互独立的。</p>
<h3 id="NAT-模式"><a href="#NAT-模式" class="headerlink" title="NAT 模式"></a>NAT 模式</h3><p>在 NAT 模式下，虚拟主机没有独立 IP，它是通过真实主机的 IP 去请求外网的。</p>
<h3 id="VMWare-相关"><a href="#VMWare-相关" class="headerlink" title="VMWare 相关"></a>VMWare 相关</h3><p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%92%8C%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/image-20211120175123039.png" alt="image-20211120175123039"></p>
<p>使用 VMWare 安装 Linux 虚拟机后，Linux 需要上网必须通过真实主机，所以在真实主机上就会多出来两个网卡分别用于给虚拟机提供上网的功能，其中：</p>
<ul>
<li>  host-only 模式与 VMnet1 虚拟网卡进行通信；</li>
<li>  NAT 模式与 VMnet8 虚拟网卡进行通信；</li>
<li>  桥接模式使用的是真实机器的网卡进行上网。</li>
</ul>
<hr>
<hr>
<h1 id="2-配置网络ip地址"><a href="#2-配置网络ip地址" class="headerlink" title="2    配置网络ip地址"></a>2    配置网络ip地址</h1><p>首先，服务器 IP 必然不能是一个动态 IP，因为每天都会有很多的客户机去连接这个服务器，如果服务器的 IP 经常发生变换，那么显然客户机就会经常找不到服务器。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 查看ip地址</span></span><br><span class="line">ifconfig </span><br><span class="line"></span><br><span class="line"><span class="section"># 临时修改ip地址(重启后无效)</span></span><br><span class="line">ifconfig eth0 192.168.12.22 </span><br><span class="line"></span><br><span class="line">如果想要永久生效，需要修改配置文件</span><br></pre></td></tr></table></figure>



<h2 id="2-1-ifconfig-配置网络接口"><a href="#2-1-ifconfig-配置网络接口" class="headerlink" title="2.1    ifconfig 配置网络接口"></a>2.1    ifconfig 配置网络接口</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">       ifconfig - 配置网络接口</span><br><span class="line"></span><br><span class="line">总览</span><br><span class="line">       ifconfig [接口]</span><br><span class="line">       ifconfig 接口 [aftype] options | address ...</span><br><span class="line"></span><br><span class="line">描述</span><br><span class="line">       ifconfig 用于配置常驻内核的网络接口。它用于在引导成功时设定网络接口。 此后，只在需要调试及系统调整时才使用。</span><br><span class="line"></span><br><span class="line">       如没有给出参数，ifconfig 会显示当前所有有效接口的状态。</span><br><span class="line">       如果给定单个接口作为参数，它只显示给定个接口的状态；</span><br><span class="line">       如果给出一个 -a 参数，它会显示所有接口的状态，包括那些停用的接口。 </span><br></pre></td></tr></table></figure>

<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>ifconfig</code>       （功能描述：显示所有网络接口的配置信息）</p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">（1）查看当前网络ip</span><br><span class="line">[root@hadoop100 ~]<span class="comment"># ifconfig</span></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="2-2-ping"><a href="#2-2-ping" class="headerlink" title="2.2 ping"></a>2.2 ping</h2><p>测试主机之间网络连通性</p>
<ol>
<li> 基本语法：</li>
</ol>
<p>​     ping 目的主机    （功能描述：测试当前服务器是否可以连接目的主机）</p>
<ol start="2">
<li><p>Demo</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）测试当前服务器是否可以连接百度</span></span><br><span class="line">[root@hadoop100 ~]<span class="comment"># ping www.baidu.com</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<hr>
<h2 id="2-3-修改IP地址"><a href="#2-3-修改IP地址" class="headerlink" title="2.3 修改IP地址"></a>2.3 修改IP地址</h2><ol>
<li><p><strong>修改 IP 地址</strong></p>
<p> 修改 IP 地址实际上就是修改对应的配置文件</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]<span class="comment"># vim /etc/sysconfig/network-scripts/ifcfg-Xxx</span></span><br></pre></td></tr></table></figure>

<ul>
<li>  <code>Xxx</code> 是一个接口名，在一个系统中，可能拥有不止一个网卡，我们只要按需修改即可。比如我的 Linux 系统上的配置文件叫做 <code>ifcfg-ens33</code> 和 <code>ifcfg-lo</code></li>
</ul>
</li>
<li><p>修改配置文件，有值的按照下面的值修改，没有该项的要增加。</p>
<p> <strong>Before</strong></p>
<p> <img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%92%8C%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/image-20211120220131465.png" alt="image-20211120220131465"></p>
<p> <strong>修改配置文件</strong></p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=eth0                <span class="comment"># 接口名（设备,网卡）【使用默认值】</span></span><br><span class="line">HWADDR=00:0C:2x:6x:0x:xx   <span class="comment"># MAC地址【使用默认值】</span></span><br><span class="line">TYPE=Ethernet               <span class="comment"># 网络类型（通常是Ethemet）【使用默认值】</span></span><br><span class="line">UUID=926a57ba-92c6-4231-bacb-f27e5e6a9f44  <span class="comment"># 随机id【使用默认值】</span></span><br><span class="line"><span class="comment"># 系统启动的时候网络接口是否有效（yes/no）</span></span><br><span class="line">ONBOOT=<span class="built_in">yes</span>                </span><br><span class="line"><span class="comment"># IP的配置方法[none|static|bootp|dhcp]（引导时不使用协议|静态分配IP|BOOTP协议|DHCP协议）</span></span><br><span class="line">BOOTPROTO=static     <span class="comment"># 强烈建议使用静态IP </span></span><br><span class="line"><span class="comment"># IP地址（如果开启了静态IP，就必须手动指定：①静态IP地址；②网关；③域名解析器）</span></span><br><span class="line">IPADDR=192.168.1.101   </span><br><span class="line"><span class="comment"># 网关  </span></span><br><span class="line">GATEWAY=192.168.1.2      </span><br><span class="line"><span class="comment"># 域名解析器</span></span><br><span class="line">DNS1=192.168.1.2          </span><br></pre></td></tr></table></figure>

<p> <strong>After</strong></p>
<p> <img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E5%92%8C%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86/image-20211120220206525.png" alt="image-20211120220206525"></p>
</li>
<li><p>重启网络服务</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]<span class="comment"># service network restart</span></span><br></pre></td></tr></table></figure></li>
<li><p> 如果报错，使用 <code>reboot</code>重启虚拟机</p>
</li>
</ol>
<hr>
<h1 id="3-配置主机名"><a href="#3-配置主机名" class="headerlink" title="3    配置主机名"></a>3    配置主机名</h1><h2 id="3-1-查看当前主机名称"><a href="#3-1-查看当前主机名称" class="headerlink" title="3.1    查看当前主机名称"></a>3.1    查看当前主机名称</h2><ol>
<li> <strong>基本语法</strong></li>
</ol>
<p>hostname         （功能描述：查看当前服务器的主机名称）</p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）查看当前服务器主机名称</span></span><br><span class="line">[root@hadoop100 ~]<span class="comment"># hostname</span></span><br></pre></td></tr></table></figure>





<hr>
<h2 id="3-2-修改主机名称"><a href="#3-2-修改主机名称" class="headerlink" title="3.2    修改主机名称"></a>3.2    修改主机名称</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 	查看主机名</span></span><br><span class="line">hostname </span><br><span class="line"></span><br><span class="line"><span class="section"># 修改主机名。临时修改，重启后无效</span></span><br><span class="line">hostname xxx </span><br><span class="line"><span class="code">	</span></span><br><span class="line"><span class="code"># 如果想要永久生效，可以修改 /etc/hostname 文件中的主机名</span></span><br></pre></td></tr></table></figure>



<ol>
<li><p> 修改主机名本质上就是修改主机名的映射文件（hosts文件）</p>
</li>
<li><p>编辑 <code>/etc/hostname</code> 文件</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]<span class="comment"># vim /etc/hostname</span></span><br></pre></td></tr></table></figure></li>
<li><p>文件中内容</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">localhost.localdomain</span><br></pre></td></tr></table></figure></li>
<li><p> 打开此文件后，可以看到主机名。修改此主机名为我们想要修改的主机名 hadoop100。</p>
</li>
<li><p> 保存退出并重启。</p>
</li>
</ol>
<h2 id="3-3-设置主机名到-IP-地址的映射"><a href="#3-3-设置主机名到-IP-地址的映射" class="headerlink" title="3.3    设置主机名到 IP 地址的映射"></a>3.3    设置主机名到 IP 地址的映射</h2><ol>
<li><p> 修改主机名的映射文件（hosts文件）</p>
</li>
<li><p>编辑 <code>/etc/hosts</code> 文件</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop100 ~]<span class="comment"># vim /etc/hosts</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>添加</strong>如下内容</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.100 hadoop100</span><br><span class="line">192.168.1.101 hadoop101</span><br><span class="line">192.168.1.102 hadoop102</span><br><span class="line">192.168.1.103 hadoop103</span><br><span class="line">192.168.1.104 hadoop104</span><br><span class="line">192.168.1.105 hadoop105</span><br><span class="line">192.168.1.106 hadoop106</span><br><span class="line">192.168.1.107 hadoop107</span><br><span class="line">192.168.1.108 hadoop108</span><br></pre></td></tr></table></figure></li>
<li><p> 保存退出并重启。</p>
</li>
<li><p> 这样我们在访问配置文件中对应的 IP 地址时，就可以直接通过主机名来代替。</p>
</li>
</ol>
<h3 id="3-3-1-修改-window-系统上的主机映射文件（hosts文件）"><a href="#3-3-1-修改-window-系统上的主机映射文件（hosts文件）" class="headerlink" title="3.3.1    修改 window 系统上的主机映射文件（hosts文件）"></a>3.3.1    修改 window 系统上的主机映射文件（hosts文件）</h3><ol>
<li><p> 进入 <code>C:\Windows\System32\drivers\etc</code> 路径</p>
</li>
<li><p>打开 <code>hosts</code> 文件并<strong>添加</strong>如下内容</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">192.168.1.100 hadoop100</span><br><span class="line"></span><br><span class="line">192.168.1.101 hadoop101</span><br><span class="line"></span><br><span class="line">192.168.1.102 hadoop102</span><br><span class="line"></span><br><span class="line">192.168.1.103 hadoop103</span><br><span class="line"></span><br><span class="line">192.168.1.104 hadoop104</span><br><span class="line"></span><br><span class="line">192.168.1.105 hadoop105</span><br><span class="line"></span><br><span class="line">192.168.1.106 hadoop106</span><br><span class="line"></span><br><span class="line">192.168.1.107 hadoop107</span><br><span class="line"></span><br><span class="line">192.168.1.108 hadoop108</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<hr>
<h1 id="4-服务管理"><a href="#4-服务管理" class="headerlink" title="4    服务管理"></a>4    服务管理</h1><h2 id="4-1-临时后台服务管理"><a href="#4-1-临时后台服务管理" class="headerlink" title="4.1    临时后台服务管理"></a>4.1    临时后台服务管理</h2><p>之所以叫临时后台服务管理，是因为在这里进行的配置在服务器重启后又会恢复到默认设置。如果想要使配置在重启后仍然生效，则要去后台服务开机自启管理中配置。</p>
<h3 id="CentOS-6"><a href="#CentOS-6" class="headerlink" title="CentOS 6"></a>CentOS 6</h3><p><strong>基本语法</strong></p>
<table>
<thead>
<tr>
<th align="left">命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>service 服务名 start</code></td>
<td>开启服务</td>
</tr>
<tr>
<td align="left"><code>service 服务名 stop</code></td>
<td>关闭服务</td>
</tr>
<tr>
<td align="left"><code>service 服务名 restart</code></td>
<td>重新启动服务</td>
</tr>
<tr>
<td align="left"><code>service 服务名 status</code></td>
<td>查看服务状态</td>
</tr>
</tbody></table>
<h3 id="CentOS-7"><a href="#CentOS-7" class="headerlink" title="CentOS 7"></a>CentOS 7</h3><p><strong>基本语法</strong></p>
<blockquote>
<p>  <code>systemctl = system control</code></p>
</blockquote>
<table>
<thead>
<tr>
<th align="left">命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>systemctl start   服务名</code></td>
<td>开启服务</td>
</tr>
<tr>
<td align="left"><code>systemctl  stop  服务名</code></td>
<td>关闭服务</td>
</tr>
<tr>
<td align="left"><code>systemctl  restart  服务名</code></td>
<td>重新启动服务</td>
</tr>
<tr>
<td align="left"><code>systemctl  status  服务名</code></td>
<td>查看服务状态</td>
</tr>
<tr>
<td align="left"><code>systemctl  --type service</code></td>
<td>查看正在运行的服务</td>
</tr>
</tbody></table>
<ol start="2">
<li> <strong>demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）查看网络服务的状态</span></span><br><span class="line">systemctl status network</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）停止网络服务</span></span><br><span class="line">systemctl stop network</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（3）启动网络服务</span></span><br><span class="line">systemctl start network</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（4）重启网络服务</span></span><br><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure>



<h2 id="4-2-后台服务开机自启配置"><a href="#4-2-后台服务开机自启配置" class="headerlink" title="4.2    后台服务开机自启配置"></a>4.2    后台服务开机自启配置</h2><h3 id="CentOS-6-1"><a href="#CentOS-6-1" class="headerlink" title="CentOS 6"></a>CentOS 6</h3><p><strong>基本语法</strong></p>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>chkconfig</code></td>
<td>查看所有服务的自启配置</td>
</tr>
<tr>
<td><code>chkconfig 服务名 off</code></td>
<td>关掉指定服务的自动启动</td>
</tr>
<tr>
<td><code>chkconfig 服务名 on</code></td>
<td>开启指定服务的自动启动</td>
</tr>
<tr>
<td><code>chkconfig 服务名 --list</code></td>
<td>查看指定服务开机启动状态</td>
</tr>
</tbody></table>
<h3 id="CentOS-7-1"><a href="#CentOS-7-1" class="headerlink" title="CentOS 7"></a>CentOS 7</h3><p><strong>基本语法</strong></p>
<table>
<thead>
<tr>
<th align="left">命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>systemctl  list-unit-files</code></td>
<td>查看所有服务的自启配置</td>
</tr>
<tr>
<td align="left"><code>systemctl  disable 服务名</code></td>
<td>关掉指定服务的自动启动</td>
</tr>
<tr>
<td align="left"><code>systemctl  enable 服务名</code></td>
<td>开启指定服务的自动启动</td>
</tr>
<tr>
<td align="left"><code>systemctl  is-enabled 服务名</code></td>
<td>查看指定服务开机启动状态</td>
</tr>
</tbody></table>
<p><strong>Demo</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）关闭防火墙开机自启</span></span><br><span class="line">systemctl disable firewalld</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）开启防火墙开机自启</span></span><br><span class="line">systemctl enable firewalld.service</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（3）查看防火墙状态</span></span><br><span class="line">systemctl is-enabled firewalld</span><br></pre></td></tr></table></figure>



<p><strong>防火墙设置</strong></p>
<ol>
<li><p>查看防火墙状态</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --state</span><br></pre></td></tr></table></figure></li>
<li><p>关闭防火墙</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld.service</span><br></pre></td></tr></table></figure></li>
<li><p>开启防火墙</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start firewalld.service</span><br></pre></td></tr></table></figure></li>
<li><p>重启防火墙</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart firewalld.service</span><br></pre></td></tr></table></figure>

</li>
<li><p>开放指定端口，以80端口为例</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">开端口命令：firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class="line">重启防火墙：systemctl restart firewalld.service</span><br><span class="line"> </span><br><span class="line">命令含义：</span><br><span class="line"> </span><br><span class="line">--zone <span class="comment">#作用域</span></span><br><span class="line"> </span><br><span class="line">--add-port=80/tcp  <span class="comment">#添加端口，格式为：端口/通讯协议</span></span><br><span class="line"> </span><br><span class="line">--permanent   <span class="comment">#永久生效，没有此参数重启后失效</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=1935/tcp --permanent</span><br></pre></td></tr></table></figure>

</li>
<li><p>关闭指定端口</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --remove-port=5672/tcp --permanent</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/20/Linux%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/20/Linux%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/" class="post-title-link" itemprop="url">Linux——文件和目录结构</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-20 16:15:17" itemprop="dateCreated datePublished" datetime="2021-11-20T16:15:17+08:00">2021-11-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-06-06 17:53:30" itemprop="dateModified" datetime="2022-06-06T17:53:30+08:00">2022-06-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-文件"><a href="#1-文件" class="headerlink" title="1 文件"></a>1 文件</h2><p><strong>Linux 系统中一切皆文件</strong>。</p>
<p>在 Linux 系统中任何东西都是以文件形式来存储的。这其中不仅包括我们熟知的文本文件、可执行文件等等，还包括硬件设备、虚拟设备、网络连接等等，甚至连目录其实都是一种特殊的文件。</p>
<hr>
<h2 id="2-Linux-目录结构"><a href="#2-Linux-目录结构" class="headerlink" title="2 Linux 目录结构"></a>2 Linux 目录结构</h2><p>在 Windows 中，每个盘符下都是一个独立的文件系统，硬盘有多少个分区就有多少个文件系统。</p>
<p>而在 Linux 系统中不管创建了多少个硬盘分区都只有一个文件系统。整个文件系统的根目录是 <code>“/”</code>，从 <code>“/”</code> 根目录出发理论上可以找到Linux 系统中的所有目录和文件。</p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/image-20211120161911777.png" alt="image-20211120161911777"></p>
<ul>
<li>  **/**：根目录</li>
<li>  <strong>/root</strong>：root 用户的家目录。</li>
<li>  <strong>/home/username</strong>：普通用户的家目录。Linux 是一种典型的多用户管理系统，在 Linux 中每个用户者有一套自己的目录，关于用户的信息就保存在该目录下，每个用户的目录名都是以用户的账号命名的。</li>
<li>  <strong>/etc</strong>：配置文件目录。</li>
<li>  <strong>/bin</strong>：命令目录。</li>
<li>  <strong>/sbin</strong>：s 是 SuperUser的意思，这个目录中存放的是系统管理员管理系统的命令。</li>
<li>  <strong>/usr/bin; /usr/sbin</strong>：系统预装的其它命令。</li>
<li>  <strong>/lib</strong>：保存系统开机所需要最基本的依赖。</li>
<li>  <strong>//lost +found</strong>：这个目录一般情况下是空的，当系统非法关机后，这里就会存放一些日志文件。</li>
<li>  <strong>/usr</strong>：这是一个非常重要的目录，用户的很多应用程序和文件都放在这个目录下，类似于 Windows 下的 programfiles 目录。</li>
<li>  <strong>/boot</strong>：这里存放的是启动 Linux 时使用的一些核心文件，自己的安装别放这里。</li>
<li>  <strong>/proc</strong>：这个目录是一个虚拟的目录，它是系统内存的映射，我们可以通过直接访问这个目录来获取系统信息。</li>
<li>  <strong>/srv</strong>：service 的宿写，该目录存放一些服务启动之后需要提取的数据。</li>
<li>  <strong>/sys</strong>：这是 Linux2.6 内核的一个很大的变化，该目录下安装了 2.6 内核中新出现的一个文件系统 sysfs。</li>
<li>  <strong>/tmp</strong>：这个目录是用来存放一些临时文件的。</li>
<li>  <strong>/dev</strong>：（device）类似于 Windows 的设备管理器，把所有的硬件以文件的形式存储。</li>
<li>  <strong>/media</strong>：Linux 系统会自动识别一些设备，例如U盘、光驱等等，当识别后，Linux 会把识别的设备挂载到这个目录下。</li>
<li>  <strong>/mnt</strong>：系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将外部的存储挂载在 <code>/mnt</code> 上，然后进入该目录就可以查看里的内容了。</li>
<li>  <strong>/opt</strong>：这是<strong>给主机额外安装软件所摆放的目录</strong>。比如你安装一个 MySQL 数据库就可以放到这个目录下，默认是空的。</li>
<li>  <strong>/var</strong>：这个目录中存放着在不断扩充着的东西，我们习惯将那些经常被修改的目录放在这个目录下，包括各种日志文件。</li>
<li>  <strong>/selinux</strong>：SELinux 是一种安全子系统，它能控制程序只能访问特定文件。</li>
</ul>
<hr>
<h2 id="3-Linux-系统中的路径"><a href="#3-Linux-系统中的路径" class="headerlink" title="3 Linux 系统中的路径"></a>3 Linux 系统中的路径</h2><ul>
<li><p>绝对路径：从 <code>“/”</code> 根目录开始逐层查找文件和目录。</p>
  <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/etc/sysconfig/network-scripts</span><br></pre></td></tr></table></figure></li>
<li><p>相对路径：以当前目录或上一级目录为基准逐层查找文件和目录</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">当前目录	“./”</span><br><span class="line">当前目录的上一级目录	“../”</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="4-用户家目录"><a href="#4-用户家目录" class="headerlink" title="4 用户家目录"></a>4 用户家目录</h2><ul>
<li>  <strong>作用</strong>：Linux 系统为每一个用户提供了一个专属的目录用来存放它自己的文件内容，在 Linux 中使用 <strong>~</strong> 代表用户的家目录。</li>
<li>  root 用户：家目录是 <code>/root</code> 目录。</li>
<li>  普通用户：在创建后会在 <code>/home</code> 目录下创建与用户名同名的目录。例如：用户 tom 的家目录是 <code>/home/tom</code></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">Linux——常用命令</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-11-20 10:16:57 / Modified: 16:09:32" itemprop="dateCreated datePublished" datetime="2021-11-20T10:16:57+08:00">2021-11-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="1-帮助命令"><a href="#1-帮助命令" class="headerlink" title="1    帮助命令"></a>1    帮助命令</h2><h3 id="1-1-man"><a href="#1-1-man" class="headerlink" title="1.1    man"></a>1.1    man</h3><blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p>​    <code>man &#123;命令或配置文件&#125;</code>     （功能描述：获得帮助信息）</p>
<blockquote>
<ol start="2">
<li>显示说明</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">信息</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> NAME </code></td>
<td>命令的名称和单行描述</td>
</tr>
<tr>
<td align="center"><code> SYNOPSIS </code></td>
<td>怎样使用命令</td>
</tr>
<tr>
<td align="center"><code> DESCRIPTION </code></td>
<td>命令功能的深入讨论</td>
</tr>
<tr>
<td align="center"><code> EXAMPLES   </code></td>
<td>怎样使用命令的例子</td>
</tr>
<tr>
<td align="center"><code> SEE ALSO </code></td>
<td>相关主题（通常是手册页）</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo：查看ls命令的帮助信息</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man ls</span><br></pre></td></tr></table></figure>



<h3 id="1-2-help"><a href="#1-2-help" class="headerlink" title="1.2    help"></a>1.2    help</h3><blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p>​    <code>help &#123;命令&#125;</code>    （功能描述：获得shell内置命令的帮助信息）</p>
<blockquote>
<ol start="2">
<li>Demo ：查看cd命令的帮助信息</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">help cd</span><br></pre></td></tr></table></figure>



<h3 id="1-3-man-和-help-的区别"><a href="#1-3-man-和-help-的区别" class="headerlink" title="1.3    man 和 help 的区别"></a>1.3    man 和 help 的区别</h3><p>通过指令 <code>man</code> 获取到的是 Linux 系统内置的帮助信息，而通过 <code>help</code> 获得的是 Shell 内置的帮助信息。 </p>
<hr>
<h2 id="2-文件目录类"><a href="#2-文件目录类" class="headerlink" title="2    文件目录类"></a>2    文件目录类</h2><h3 id="1-pwd"><a href="#1-pwd" class="headerlink" title="1    pwd"></a>1    pwd</h3><p>pwd（print working directory）： 打印当前所在的工作目录路径</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>pwd</code>     （功能描述：打印当前所在的工作目录路径）</p>
<h3 id="2-ls"><a href="#2-ls" class="headerlink" title="2    ls"></a>2    ls</h3><p>ls（list）：列出目录的内容</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ls		显示当前目录下的非隐藏内容（文件和文件夹）</span><br><span class="line"></span><br><span class="line">ls-a 	显示当前目录下所有文件或目录（包含隐藏的文件）</span><br><span class="line"></span><br><span class="line">ls-l 	显示当前目录下的非隐藏内容（文件和文件夹）的详细信息</span><br><span class="line">ll	:	ls-l的缩写形式，只有 root 用户可以使用</span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="2">
<li>显示说明</li>
</ol>
</blockquote>
<p>每行列出的信息依次是： <code>文件类型与权限</code> / <code>链接数</code> <code>/文件属主</code> /<code>文件属组</code> /<code>文件大小(用byte来表示)</code> /<code>建立或最近修改的时间</code>/ <code>名字</code></p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-20211118174834694.png" alt="image-20211118174834694"></p>
<h3 id="3-cd"><a href="#3-cd" class="headerlink" title="3    cd"></a>3    cd</h3><p><code>cd</code>（Change Directory）：切换路径</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd app		切换到app目录</span><br><span class="line"></span><br><span class="line">cd ..		切换到上一层目录</span><br><span class="line"></span><br><span class="line">cd /		切换到系统根目录</span><br><span class="line"></span><br><span class="line">cd ~		切换到用户家目录</span><br><span class="line"></span><br><span class="line">cd -		回到上一次所在目录</span><br></pre></td></tr></table></figure>

<ul>
<li>使用tab键来补全文件路径。</li>
<li>可以使用多级目录。</li>
</ul>
<hr>
<h3 id="4-mkdir"><a href="#4-mkdir" class="headerlink" title="4    mkdir"></a>4    mkdir</h3><p><code>mkdir</code>：Make directory，创建<strong>目录</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir app					# 在当前目录下创建单级目录app</span><br><span class="line">mkdir –p app2/test			 # 在当前目录下创建多级目录app2/test</span><br></pre></td></tr></table></figure>



<h3 id="5-rmdir"><a href="#5-rmdir" class="headerlink" title="5    rmdir"></a>5    rmdir</h3><p><code>rmdir</code>：remove directory，删除一个空目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmdir app  			# 删除app目录，前提是app目录中没有任何内容（文件或文件夹）</span><br></pre></td></tr></table></figure>



<h3 id="6-touch"><a href="#6-touch" class="headerlink" title="6    touch"></a>6    touch</h3><blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>touch 文件名</code>        创建一个空<strong>文件</strong></p>
<blockquote>
<ol start="2">
<li>Demo</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch person/student/zhangsan.txt</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="7-cp"><a href="#7-cp" class="headerlink" title="7    cp"></a>7    cp</h3><p><code>cp</code>：copy，复制<strong>文件或目录</strong></p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>cp [选项] &#123;source&#125; &#123;dest&#125;</code>               （功能描述：复制source文件到dest）</p>
<blockquote>
<ol start="2">
<li>选项说明</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>-r</code></td>
<td>递归复制整个文件夹</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>参数说明</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">参数</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>source</code></td>
<td>源文件</td>
</tr>
<tr>
<td align="center"><code> dest</code></td>
<td>目标文件</td>
</tr>
</tbody></table>
<blockquote>
<ol start="4">
<li>Demo：</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">复制文件</span></span><br><span class="line">cp person/student/zhangsan.txt person/son/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">递归复制整个文件夹</span></span><br><span class="line">cp -r person/student/ ./</span><br></pre></td></tr></table></figure>



<h3 id="8-mv"><a href="#8-mv" class="headerlink" title="8    mv"></a>8    mv</h3><p><code>mv</code>：Move，移动或重命名<strong>文件或目录</strong></p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<ul>
<li><code>mv &#123;oldName&#125; &#123;newName&#125;</code>       （功能描述：重命名）</li>
<li><code>mv /temp/sourcefile /targetFolder</code>    （功能描述：移动）</li>
</ul>
<blockquote>
<ol start="2">
<li>Demo</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重命名</span> </span><br><span class="line">mv a.txt b.txt    	将a.txt文件重命名为b.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">移动文件/目录</span></span><br><span class="line">mv a.txt ../  	  	将a.txt文件移动到上一层目录中</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="9-rm"><a href="#9-rm" class="headerlink" title="9    rm"></a>9    rm</h3><blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>rm [选项] &#123;file&#125; </code>          （功能描述： 删除文件/文件夹）</p>
<blockquote>
<ol start="2">
<li>选项说明</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>-r</code></td>
<td>递归删除目录中所有内容</td>
</tr>
<tr>
<td align="center"><code>-f</code></td>
<td>强制执行删除操作，而不提示用于进行确认。</td>
</tr>
<tr>
<td align="center"><code>-v</code></td>
<td>显示指令的详细执行过程</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rm a.txt    	# 删除a.txt文件，删除文件时需要用户确认是否删除。y/n：表示yes/no</span><br><span class="line">rm -r abc		# 递归的删除abc文件夹，删除文件时需要用户确认是否删除。</span><br><span class="line">rm -f a.txt    	# 删除a.txt文件，不询问直接删除文件。</span><br><span class="line">rm -rf abc    	# 删除abc文件夹及其子文件内容，不询问递归删除文件夹</span><br><span class="line">rm -rf /*     	# 不询问递归删除根目录下所有文件夹及文件</span><br><span class="line">rm -rf *     	# 删除所有文件</span><br></pre></td></tr></table></figure>

<h3 id="10-cat"><a href="#10-cat" class="headerlink" title="10    cat"></a>10    cat</h3><p>查看文件内容，一次性显示文件中的全部内容。一般查看比较小的文件，<strong>一屏幕能显示全的</strong>。</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>cat [选项] 要查看的文件</code>    </p>
<blockquote>
<ol start="2">
<li>选项</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>-n</code></td>
<td>显示所有行的行号，包括空行。</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo：查看文件内容并显示行号</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat -n a.txt </span><br></pre></td></tr></table></figure>



<h3 id="11-more"><a href="#11-more" class="headerlink" title="11    more"></a>11    more</h3><p>分屏显示文件内容。more指令是一个基于VI编辑器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容。</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>more 要查看的文件</code></p>
<blockquote>
<ol start="2">
<li>操作说明</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">操作</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> 空格键 (space) </code></td>
<td>代表向下翻一页；</td>
</tr>
<tr>
<td align="center"><code> Enter </code></td>
<td>代表向下翻『一行』；</td>
</tr>
<tr>
<td align="center"><code> q </code></td>
<td>代表立刻离开 more ，不再显示该文件内容。</td>
</tr>
<tr>
<td align="center"><code> Ctrl+F </code></td>
<td>向下滚动一屏</td>
</tr>
<tr>
<td align="center"><code> Ctrl+B </code></td>
<td>返回上一屏</td>
</tr>
<tr>
<td align="center"><code> = </code></td>
<td>输出当前行的行号</td>
</tr>
<tr>
<td align="center"><code> :f </code></td>
<td>输出文件名和当前行的行号</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo：采用more查看文件</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more a.txt</span><br></pre></td></tr></table></figure>



<h3 id="12-less"><a href="#12-less" class="headerlink" title="12    less"></a>12    less</h3><p>less指令用来分屏查看文件内容，它的功能与more指令类似，但是比more指令更加强大，支持各种显示终端。less指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示<strong>大型文件具有较高的效率</strong>。</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>less 要查看的文件</code></p>
<blockquote>
<ol start="2">
<li>操作说明</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">操作</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> 空格键 (space) </code></td>
<td>代表向下翻一页；</td>
</tr>
<tr>
<td align="center"><code> [pagedown] </code></td>
<td>代表向下翻一页；</td>
</tr>
<tr>
<td align="center"><code> [pageup] </code></td>
<td>代表向上翻一页；</td>
</tr>
<tr>
<td align="center"><code> /字串 </code></td>
<td>向下搜寻『字串』的功能；n：向下查找；N：向上查找；</td>
</tr>
<tr>
<td align="center"><code> ?字串 </code></td>
<td>向上搜寻『字串』的功能；n：向上查找；N：向下查找；</td>
</tr>
<tr>
<td align="center"><code> q </code></td>
<td>离开 less 这个程序；</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo：采用 <code>less</code> 查看文件</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">less a.txt</span><br></pre></td></tr></table></figure>



<h3 id="13-head"><a href="#13-head" class="headerlink" title="13    head"></a>13    head</h3><p>head用于显示文件的开头部分内容，默认情况下head指令显示文件的前10行内容。</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>head 文件名</code>           （功能描述：查看文件头10行内容）</p>
<p><code>head -n 5 文件名</code>  （功能描述：查看文件头5行内容，5可以是任意行数）</p>
<blockquote>
<ol start="2">
<li>选项说明</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> -n &lt;行数&gt; </code></td>
<td>指定显示头部内容的行数</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo：查看文件的头2行</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head -n 2 smartd.conf</span><br></pre></td></tr></table></figure>



<h3 id="14-tail"><a href="#14-tail" class="headerlink" title="14    tail"></a>14    tail</h3><p>tail用于输出文件中尾部的内容，默认情况下tail指令显示文件的后10行内容。</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>tail 文件</code>               （功能描述：查看文件后10行内容）</p>
<p><code>tail -n 5 文件</code>       （功能描述：查看文件后5行内容，5可以是任意行数）</p>
<p><code>tail -f 文件</code>          （功能描述：实时追踪该文档的所有更新）</p>
<blockquote>
<ol start="2">
<li>选项说明</li>
</ol>
</blockquote>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> -n&lt;行数&gt; </code></td>
<td>输出文件尾部n行内容</td>
</tr>
<tr>
<td align="center"><code> -f </code></td>
<td>显示文件最新追加的内容，监视文件变化。(当文件内容法生改变时，命令行窗口会及时更新数据）</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）查看文件头1行内容</span></span><br><span class="line">tail -n 1 smartd.conf </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）实时追踪该档的所有更新</span></span><br><span class="line">tail -f houge.txt</span><br></pre></td></tr></table></figure>

<ul>
<li><code>Ctrl+C</code> 结束查看</li>
</ul>
<hr>
<h3 id="15-echo"><a href="#15-echo" class="headerlink" title="15    echo"></a>15    echo</h3><p>echo    输出内容到控制台</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>echo [选项] [输出内容]</code></p>
<blockquote>
<ol start="2">
<li>选项</li>
</ol>
</blockquote>
<p> -e： 支持反斜线控制的字符转换</p>
<table>
<thead>
<tr>
<th align="center">控制字符</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> \\  </code></td>
<td>输出\本身</td>
</tr>
<tr>
<td align="center"><code> \n  </code></td>
<td>换行符</td>
</tr>
<tr>
<td align="center"><code> \t  </code></td>
<td>制表符，也就是Tab键</td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;hello\tworld&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">结果：hello\tworld</span></span><br><span class="line"></span><br><span class="line">echo -e &quot;hello\tworld&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">结果：hello    world</span></span><br></pre></td></tr></table></figure>



<h3 id="16-重定向输出-gt-amp-gt-gt"><a href="#16-重定向输出-gt-amp-gt-gt" class="headerlink" title="16    重定向输出[&gt;  &amp;  &gt;&gt;]"></a>16    重定向输出[&gt;  &amp;  &gt;&gt;]</h3><p>重定向输出：把执行当前命令在控制台上输出的内容重定向输出到指定文件中。</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>内容 &gt; 文件名</code>        如果文件中有内容则覆盖文件中的内容。</p>
<p><code>内容 &gt;&gt; 文件名</code>        如果文件中有内容则追加到文件中。</p>
<blockquote>
<ol start="2">
<li>Demo</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）将<span class="built_in">ls</span>查看信息写入到文件中</span></span><br><span class="line">ls -l &gt; a.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）将<span class="built_in">ls</span>查看信息追加到文件中</span></span><br><span class="line">ls -l &gt;&gt; b.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（3）采用<span class="built_in">echo</span>将hello单词追加到文件中</span></span><br><span class="line">echo hello &gt;&gt; houge.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（4）查询a.txt并将查询到的内容覆盖输出到b.txt中</span></span><br><span class="line">cat a.txt &gt; b.txt  </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（5）查询a.txt并将查询到的内容追加输出到b.txt中</span></span><br><span class="line">cat a.txt &gt;&gt; b.txt </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（6）执行ifconfig命令，并将命令的执行结果输出到c.txt中</span></span><br><span class="line">ifconfig &gt; c.txt</span><br></pre></td></tr></table></figure>

<h3 id="17-ln"><a href="#17-ln" class="headerlink" title="17    ln"></a>17    ln</h3><p>软链接，软链接也称为符号链接，类似于windows里的快捷方式，有自己的数据块，主要存放了链接其他文件的路径。</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p><code>ln -s [原文件或目录] [软链接名]</code>    （功能描述：给原文件创建一个软链接）</p>
<blockquote>
<ol start="2">
<li>经验技巧</li>
</ol>
</blockquote>
<p>删除软链接： rm -rf 软链接名，而不是rm -rf 软链接名/</p>
<p>查询：通过<code>ll</code>就可以查看，列表属性第1位是<code>l</code>，尾部会有位置指向。</p>
<blockquote>
<ol start="3">
<li>Demo</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）创建软连接</span></span><br><span class="line">ln -s person/student/zhangsan.txt ./zs		</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）删除软连接</span></span><br><span class="line">rm -rf zs</span><br></pre></td></tr></table></figure>



<h3 id="7-18-history"><a href="#7-18-history" class="headerlink" title="7.18    history"></a>7.18    history</h3><p>查看已经执行过历史命令</p>
<blockquote>
<ol>
<li>基本语法</li>
</ol>
</blockquote>
<p>​    history     （功能描述：查看已经执行过历史命令）</p>
<blockquote>
<ol start="2">
<li>Demo：查看已经执行过的历史命令</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history</span><br></pre></td></tr></table></figure>





<hr>
<h2 id="3-用户管理"><a href="#3-用户管理" class="headerlink" title="3    用户管理"></a>3    用户管理</h2><h3 id="3-1-useradd（增）"><a href="#3-1-useradd（增）" class="headerlink" title="3.1    useradd（增）"></a>3.1    useradd（增）</h3><ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>useradd 用户名</code>    （功能描述：添加新用户）[未显式指定组名时在创建用户之前会以当前用户名为组名创建一个新的用户组并将用户添加到该组中]</p>
<p><code>useradd -g 组名 用户名</code>    （功能描述：添加新用户到某个组）[前提是这个组必须存在]</p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）添加一个用户</span></span><br><span class="line">useradd zhangsan</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加的用户信息会保存在 /home/ 目录下</span></span><br><span class="line">ll /home/</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="3-2-passwd"><a href="#3-2-passwd" class="headerlink" title="3.2    passwd"></a>3.2    passwd</h3><p>设置用户密码</p>
<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>passwd 用户名</code>   （功能描述：设置用户密码）</p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<p>设置用户的密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd zs123456</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="3-3-userdel（删）"><a href="#3-3-userdel（删）" class="headerlink" title="3.3    userdel（删）"></a>3.3    userdel（删）</h3><ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>userdel 用户名</code>          （功能描述：删除用户但保存用户主目录）</p>
<p><code>userdel -r 用户名</code>     （功能描述：用户和用户主目录，都删除）</p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -r </code></td>
<td>删除用户的同时，删除与用户相关的所有文件。</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）删除用户但保留用户主目录</span></span><br><span class="line">userdel zhangsan</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）删除用户和用户主目录，都删除</span></span><br><span class="line">userdel -r lisi</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="3-4-usermod（改）"><a href="#3-4-usermod（改）" class="headerlink" title="3.4    usermod（改）"></a>3.4    usermod（改）</h3><ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>usermod -g 用户组 用户名</code>    （功能描述：修改用户组和用户名）</p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> -g </code></td>
<td>修改用户的初始登录组，给定的组必须存在</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）将用户加入到用户组</span></span><br><span class="line">usermod -g root zhubajie</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="3-5-id（查）"><a href="#3-5-id（查）" class="headerlink" title="3.5    id（查）"></a>3.5    id（查）</h3><p>查看用户是否存在</p>
<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>id 用户名</code></p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<p>查看用户是否存在</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id zhangsan</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="3-6-cat-etc-passwd"><a href="#3-6-cat-etc-passwd" class="headerlink" title="3.6    cat /etc/passwd"></a>3.6    cat /etc/passwd</h3><p><strong>Demo</strong></p>
<p>查看创建了哪些用户。用户信息保存在 /etc/passwd 目录下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/passwd</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="3-7-who"><a href="#3-7-who" class="headerlink" title="3.7    who"></a>3.7    who</h3><p>查看登录用户信息</p>
<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>whoami</code>             （功能描述：显示当前用户名）</p>
<p><code>who am i</code>         （功能描述：显示<strong>登录用户</strong>的用户名）</p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）显示自身用户名称（我现在是谁）</span></span><br><span class="line">whoami</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）显示登录用户的用户名（我登录系统时是谁，使用 su 切换的不算数）</span></span><br><span class="line">who am i</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="3-8-su（切换）"><a href="#3-8-su（切换）" class="headerlink" title="3.8    su（切换）"></a>3.8    su（切换）</h3><blockquote>
<p>  <code>su: swith user</code> 切换用户</p>
</blockquote>
<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>su 用户名称</code>  （功能描述：切换用户，只能获得用户的执行权限，不能获得环境变量）</p>
<p><code>su - 用户名称</code>    （功能描述：切换到用户并获得该用户的环境变量及执行权限）</p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）切换用户</span></span><br><span class="line"></span><br><span class="line">[root@hadoop101 ~]#su tangseng</span><br><span class="line">[root@hadoop101 ~]#echo $PATH</span><br><span class="line">/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）切换用户2</span></span><br><span class="line">[root@hadoop101 ~]#exit</span><br><span class="line">[root@hadoop101 ~]#su - tangseng</span><br><span class="line">[root@hadoop101 ~]#echo $PATH</span><br><span class="line">/usr/lib64/qt-3.3/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/tangseng/bin</span><br></pre></td></tr></table></figure>



<hr>
<hr>
<h3 id="3-9-sudo"><a href="#3-9-sudo" class="headerlink" title="3.9    sudo"></a>3.9    sudo</h3><p><strong>功能</strong>：设置普通用户具有 root 权限</p>
<p><strong>Demo</strong></p>
<ol>
<li><p>添加wangwu用户，并对其设置密码。</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop101 ~]<span class="comment">#useradd wangwu</span></span><br><span class="line">[root@hadoop101 ~]<span class="comment">#passwd fuzademima</span></span><br></pre></td></tr></table></figure></li>
<li><p>修改 <code>/etc/sudoers</code> 配置文件，设置该用户具有 root 权限</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop101 ~]<span class="comment">#vi /etc/sudoers</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改 /etc/sudoers 文件，找到下面一行(91行)，在root下面添加一行，如下所示：</span></span><br><span class="line">===============================================================</span><br><span class="line"><span class="comment"># Allow root to run any commands anywhere</span></span><br><span class="line">root  ALL=(ALL)   ALL</span><br><span class="line">wangwu  ALL=(ALL)   ALL</span><br><span class="line">================================================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者配置成采用sudo命令时，不需要输入密码</span></span><br><span class="line">================================================================</span><br><span class="line"><span class="comment"># Allow root to run any commands anywhere</span></span><br><span class="line">root   ALL=(ALL)   ALL</span><br><span class="line">wangwu  ALL=(ALL)   NOPASSWD:ALL</span><br><span class="line">================================================================</span><br></pre></td></tr></table></figure></li>
<li><p> 修改完毕，现在可以用 wangwu 帐号登录，然后用命令 sudo ，即可获得root权限进行操作。</p>
</li>
</ol>
<hr>
<h2 id="4-用户组管理"><a href="#4-用户组管理" class="headerlink" title="4    用户组管理"></a>4    用户组管理</h2><p>每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。用户组的管理涉及用户组的添加、删除和修改。</p>
<p>对用户组的增加、删除和修改实际上就是对 <code>/etc/group</code> 文件的更新。</p>
<h3 id="4-1-groupadd（增）"><a href="#4-1-groupadd（增）" class="headerlink" title="4.1    groupadd（增）"></a>4.1    groupadd（增）</h3><ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>groupadd 组名</code></p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）添加一个 person 组</span></span><br><span class="line">groupadd person</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="4-2-groupdel（删）"><a href="#4-2-groupdel（删）" class="headerlink" title="4.2 groupdel（删）"></a>4.2 groupdel（删）</h3><ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>groupdel 组名</code></p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）删除xitianqujing组</span></span><br><span class="line">groupdel xitianqujing</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="4-3-groupmod（改）"><a href="#4-3-groupmod（改）" class="headerlink" title="4.3    groupmod（改）"></a>4.3    groupmod（改）</h3><ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>groupmod -n 新组名 老组名</code></p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th>功能描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -n&lt;新组名&gt; </code></td>
<td>指定工作组的新组名</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）修改 person 组名称为 study</span></span><br><span class="line">groupmod -n study person</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="4-4-cat-etc-group（查）"><a href="#4-4-cat-etc-group（查）" class="headerlink" title="4.4 cat /etc/group（查）"></a>4.4 cat /etc/group（查）</h3><ol>
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看创建了哪些组</span></span><br><span class="line">cat /etc/group</span><br></pre></td></tr></table></figure>





<hr>
<h2 id="5-压缩和解压类"><a href="#5-压缩和解压类" class="headerlink" title="5    压缩和解压类"></a>5    压缩和解压类</h2><h3 id="5-1-gzip-gunzip"><a href="#5-1-gzip-gunzip" class="headerlink" title="5.1    gzip/gunzip"></a>5.1    gzip/gunzip</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">       gzip, gunzip, zcat - compress or <span class="built_in">expand</span> files</span><br><span class="line">       <span class="comment"># 压缩/解压缩文件</span></span><br></pre></td></tr></table></figure>



<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>gzip 文件</code>            （功能描述：压缩文件，将文件压缩为*.gz文件）</p>
<p><code>gunzip 文件.gz</code>   （功能描述：解压缩文件命令）</p>
<ol start="2">
<li> <strong>Tip</strong></li>
</ol>
<ul>
<li><strong>只能压缩文件</strong>不能压缩目录</li>
<li><strong>压缩完成后会删除源文件</strong></li>
</ul>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）gzip压缩</span></span><br><span class="line">gzip a.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">压缩后的文件名：a.txt.gz</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）gunzip解压缩文件</span></span><br><span class="line">gunzip a.txt.gz </span><br></pre></td></tr></table></figure>



<hr>
<h3 id="5-2-zip-unzip"><a href="#5-2-zip-unzip" class="headerlink" title="5.2    zip/unzip"></a>5.2    zip/unzip</h3><ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>zip [选项] XXX.zip 将要压缩的内容</code>       （功能描述：压缩<strong>文件和目录</strong>的命令）</p>
<p><code>unzip [选项] XXX.zip</code>                           （功能描述：解压缩文件）</p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">zip选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -r </code></td>
<td>压缩目录</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="left">unzip选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -d&lt;目录&gt; </code></td>
<td>指定解压后文件的存放目录</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>经验技巧</strong></li>
</ol>
<p>zip 压缩命令在 Window/Linux 都通用，<strong>可以压缩目录且保留源文件</strong>。</p>
<ol start="4">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）压缩 a.txt 和 b.txt，压缩后的名称为 mypackage.zip</span></span><br><span class="line">zip mypackage.zip a.txt b.txt </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）解压 mypackage.zip</span></span><br><span class="line">unzip mypackage.zip </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（3）解压 mypackage.zip到指定目录-d</span></span><br><span class="line">unzip mypackage.zip -d /opt</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<hr>
<h3 id="5-3-tar"><a href="#5-3-tar" class="headerlink" title="5.3 tar"></a>5.3 tar</h3><p><strong>打包</strong>：打包是把多个文件合并到一个新的文件夹中去。<code>tar</code>命令能够<strong>将用户所指定的文件或目录打包成一个文件，但不做压缩</strong>。        </p>
<p>一般 Linux 上常用的压缩方式是选用 tar 将许多文件打包成一个文件，再以 <code>gzip</code> 压缩命令压缩成 <code>xxx.tar.gz</code>(或称为xxx.tgz)的文件。常用参数：</p>
<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>tar [选项] XXX.tar.gz 将要打包进去的内容</code>        （功能描述：打包目录，压缩后的文件格式.tar.gz）</p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> -z </code></td>
<td><strong>打包同时调用gzip压缩命令进行压缩</strong></td>
</tr>
<tr>
<td align="center"><code> -c </code></td>
<td><strong>产生 xxx.tar 打包文件</strong></td>
</tr>
<tr>
<td align="center"><code> -v </code></td>
<td>显示运行过程的信息</td>
</tr>
<tr>
<td align="center"><code> -f </code></td>
<td>指定压缩后的文件名</td>
</tr>
<tr>
<td align="center"><code> -x </code></td>
<td><strong>解包 xxx.tar 文件</strong></td>
</tr>
</tbody></table>
<blockquote>
<ol start="3">
<li>Demo</li>
</ol>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）打包多个文件并将其压缩</span></span><br><span class="line">tar -zcvf student.tar.gz zhangsan.txt lisi.txt </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）打包并压缩目录</span></span><br><span class="line">tar -zcvf person.tar.gz person/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（3）解压到当前目录</span></span><br><span class="line">tar -zxvf person.tar.gz</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（4）解压到指定目录</span></span><br><span class="line">tar -zxvf person.tar.gz -c /opt</span><br></pre></td></tr></table></figure>





<hr>
<h2 id="6-搜索查找类"><a href="#6-搜索查找类" class="headerlink" title="6    搜索查找类"></a>6    搜索查找类</h2><h3 id="6-1-find"><a href="#6-1-find" class="headerlink" title="6.1    find"></a>6.1    find</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">       find - search <span class="keyword">for</span> files <span class="keyword">in</span> a directory hierarchy</span><br><span class="line"><span class="comment"># find 指令将从指定目录开始递归地向下搜索所有子目录，并将满足条件的文件显示在终端。</span></span><br></pre></td></tr></table></figure>



<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>find [搜索范围] [选项]</code></p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -name&lt;查询方式&gt; </code></td>
<td>按照文件名查找文件</td>
</tr>
<tr>
<td align="left"><code> -user&lt;用户名&gt; </code></td>
<td>按照用户名查找文件</td>
</tr>
<tr>
<td align="left"><code> -size&lt;文件大小&gt; </code></td>
<td>按照文件大小查找文件</td>
</tr>
</tbody></table>
<ul>
<li><p>使用 <code>-size</code> 进行查找时的单位说明</p>
<table>
<thead>
<tr>
<th>单位</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>c</td>
<td>字节</td>
</tr>
<tr>
<td>b（默认）</td>
<td>块，一块为 512 字节</td>
</tr>
<tr>
<td>w</td>
<td>words 为单位，一个 words 是 2 个字节</td>
</tr>
<tr>
<td>k</td>
<td>1024 字节</td>
</tr>
<tr>
<td>M</td>
<td>MB</td>
</tr>
<tr>
<td>G</td>
<td>GB</td>
</tr>
</tbody></table>
</li>
</ul>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）按文件名：查找 person/ 目录下的 filename.txt 文件。</span></span><br><span class="line">find person/ -name “*.txt”</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）按拥有者：查找/opt目录下，用户名称为 -user 的文件</span></span><br><span class="line">find opt/ -user zhangsan</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（3）按文件大小：在 /home 目录下查找大于200m的文件（+n 大于 -n 小于  n 等于）</span></span><br><span class="line">find /home -size +204800</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="6-2-grep"><a href="#6-2-grep" class="headerlink" title="6.2    grep"></a>6.2    grep</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">       grep, egrep, fgrep - <span class="built_in">print</span> lines matching a pattern</span><br><span class="line"><span class="comment"># 过滤查找 查找文件内容中符合条件的字符串</span></span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">       grep [OPTIONS] PATTERN [FILE...]</span><br><span class="line">       grep [OPTIONS] [-e PATTERN | -f FILE] [FILE...]</span><br></pre></td></tr></table></figure>

<ol start="0">
<li> <strong>管道符</strong></li>
</ol>
<p><code>grep</code> 常和管道符 <code>|</code> 搭配使用，管道符用于将前一个命令的处理结果传输给后面的命令处理。</p>
<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>grep 选项 查找内容 源文件</code></p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -n </code></td>
<td>显示匹配行及行号。</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）在anaconda-ks.cfg文件中查找lang</span></span><br><span class="line">grep lang anaconda-ks.cfg  	</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）高亮显示</span></span><br><span class="line">grep lang anaconda-ks.cfg –-color	 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（3）显示查找到的内容及前一行（A：After）</span></span><br><span class="line">grep lang anaconda-ks.cfg –-color -A1	</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（4）显示查找到的内容及前一行和后一行（A：After，B：Before）</span></span><br><span class="line">grep lang anaconda-ks.cfg –-color -A1 -B1	</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（5）查找某文件在第几行</span></span><br><span class="line">ls | grep -n test</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="6-3"><a href="#6-3" class="headerlink" title="6.3     |"></a>6.3     |</h3><p>管道符<code>|</code>，表示将前一个命令的处理结果输出传递给后面的命令处理</p>
<p><strong>Demo</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）查询所有help信息并对这些信息进行分页查询</span></span><br><span class="line"><span class="built_in">ls</span> --<span class="built_in">help</span> | more  </span><br><span class="line"></span><br><span class="line"><span class="comment">#（2）查询名称中包含java的进程</span></span><br><span class="line">ps –ef | grep java  </span><br></pre></td></tr></table></figure>



<hr>
<h3 id="6-4-which"><a href="#6-4-which" class="headerlink" title="6.4    which"></a>6.4    which</h3><p>查找命令在哪个目录下</p>
<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>which 命令</code></p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">which ll</span><br></pre></td></tr></table></figure>





<hr>
<h2 id="7-进程线程类"><a href="#7-进程线程类" class="headerlink" title="7    进程线程类"></a>7    进程线程类</h2><blockquote>
<ul>
<li>  ps</li>
<li>  kill</li>
<li>  pstree</li>
<li>  netstat</li>
</ul>
</blockquote>
<h3 id="7-1-ps"><a href="#7-1-ps" class="headerlink" title="7.1    ps"></a>7.1    ps</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">	ps - report a snapshot of the current processes.</span><br><span class="line">	 	<span class="comment"># 报告当前进程的快照</span></span><br><span class="line">SYNOPSIS</span><br><span class="line">	ps [options]</span><br></pre></td></tr></table></figure>



<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>ps -aux | grep xxx</code>      （功能描述：查看系统中所有进程）</p>
<p><code>ps -ef | grep xxx</code>       （功能描述：可以查看子父进程之间的关系）</p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> -a </code></td>
<td>选择所有进程</td>
</tr>
<tr>
<td align="center"><code> -u </code></td>
<td>显示所有用户的所有进程</td>
</tr>
<tr>
<td align="center"><code> -x </code></td>
<td>显示没有终端的进程</td>
</tr>
</tbody></table>
<ul>
<li>  Linux 系统是一个多用户操作系统，选择 <code>-u</code> 后不仅可以显示当前用户下所有的线程，还能查看其它用户管理的所有进程。</li>
</ul>
<ol start="3">
<li> <strong>功能说明</strong></li>
</ol>
<p>（1）<code>ps -aux</code> 显示信息说明</p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-2021112010055323png" alt="image-20211120100553232"></p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>USER</code></td>
<td>该进程是由哪个用户产生的</td>
</tr>
<tr>
<td align="left"><code>PID（ProcessID）</code></td>
<td>进程的ID号</td>
</tr>
<tr>
<td align="left"><code>%CPU</code></td>
<td>该进程占用CPU资源的百分比，占用越高，进程越耗费资源；</td>
</tr>
<tr>
<td align="left"><code>%MEM</code></td>
<td>该进程占用物理内存的百分比，占用越高，进程越耗费资源；</td>
</tr>
<tr>
<td align="left"><code>VSZ</code></td>
<td>该进程占用虚拟内存的大小，单位KB；</td>
</tr>
<tr>
<td align="left"><code>RSS</code></td>
<td>该进程占用实际物理内存的大小，单位KB；</td>
</tr>
<tr>
<td align="left"><code>TTY</code></td>
<td>该进程是在哪个终端中运行的。其中<code>tty1-tty7</code>代表本地控制台终端，<br><code>tty1-tty6</code>是本地的字符界面终端，<code>tty7</code>是图形终端。<code>pts/0-255</code>代表虚拟终端。</td>
</tr>
<tr>
<td align="left"><code>STAT</code></td>
<td>进程状态。常见的状态有：R运行；S睡眠；T停止状态；s包含子进程；+位于后台</td>
</tr>
<tr>
<td align="left"><code>START</code></td>
<td>该进程的启动时间</td>
</tr>
<tr>
<td align="left"><code>TIME</code></td>
<td>该进程占用CPU的运算时间，注意不是系统时间</td>
</tr>
<tr>
<td align="left"><code>COMMAND</code></td>
<td>产生此进程的命令名</td>
</tr>
</tbody></table>
<p>（2）<code>ps -ef</code> 显示信息说明</p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-20211120101206399.png" alt="image-20211120101206399"></p>
<table>
<thead>
<tr>
<th align="left">字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>UID</code></td>
<td>用户ID，类似于上面的USER</td>
</tr>
<tr>
<td align="left"><code>PID</code></td>
<td>进程的ID号</td>
</tr>
<tr>
<td align="left"><code>PPID</code></td>
<td>父进程ID（ParentProcessID）</td>
</tr>
<tr>
<td align="left"><code>C</code></td>
<td>CPU用于计算执行优先级的因子。<br>数值越大，表明进程是 CPU 密集型运算，执行优先级会降低；<br>数值越小，表明进程是 I/O 密集型运算，执行优先级会提高</td>
</tr>
<tr>
<td align="left"><code>STIME</code></td>
<td>进程启动的时间</td>
</tr>
<tr>
<td align="left"><code>TTY</code></td>
<td>终端名称</td>
</tr>
<tr>
<td align="left"><code>TIME</code></td>
<td>该进程占用CPU的运算时间</td>
</tr>
<tr>
<td align="left"><code>CMD</code></td>
<td>启动进程所用的命令和参数，等价于上面的COMMAND</td>
</tr>
</tbody></table>
<hr>
<h3 id="7-2-kill"><a href="#7-2-kill" class="headerlink" title="7.2    kill"></a>7.2    kill</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">	<span class="built_in">kill</span> - terminate a process</span><br><span class="line">			<span class="comment"># 终止一个进程</span></span><br><span class="line">SYNOPSIS</span><br><span class="line">	<span class="built_in">kill</span> [-s signal|-p] [-q sigval] [-a] [--] pid...</span><br><span class="line">	<span class="built_in">kill</span> -l [signal]</span><br></pre></td></tr></table></figure>



<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>kill [选项] 进程号</code>        （功能描述：通过进程号杀死进程）</p>
<p><code>killall 进程名称</code>           （功能描述：通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用）  </p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -9 </code></td>
<td>表示强迫进程立即停止</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>案例实操</strong></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（1）通过进程号称杀死进程</span></span><br><span class="line">kill -9 5102</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">（2）通过进程名称杀死进程</span></span><br><span class="line">killall firefox</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="7-3-pstree"><a href="#7-3-pstree" class="headerlink" title="7.3    pstree"></a>7.3    pstree</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">       pstree - display a tree of processes</span><br><span class="line">       <span class="comment"># 将进程信息以树形结构展示</span></span><br><span class="line"></span><br><span class="line">SYNOPSIS</span><br><span class="line">       pstree </span><br><span class="line">       [-a, --arguments] </span><br><span class="line">       [-c, --compact] </span><br><span class="line">       [-h, --highlight-all, -Hpid, --highlight-pid pid] </span><br><span class="line">       [-g] --show-pgids] </span><br><span class="line">       [-l, --long]</span><br><span class="line">       [-n, --numeric-sort] </span><br><span class="line">       [-N, --ns-sortns [-p, --show-pids] </span><br><span class="line">       [-s, --show-parents] </span><br><span class="line">       [-S, --ns-changes] </span><br><span class="line">       [-u, --uid-changes] </span><br><span class="line">       [-Z, --security-con‐text] </span><br><span class="line">       [-A, --ascii, -G, --vt100, -U, --unicode] </span><br><span class="line">       [pid, user]</span><br><span class="line">       pstree -V, --version</span><br></pre></td></tr></table></figure>



<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>pstree [选项]</code></p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -p </code></td>
<td>显示进程的PID</td>
</tr>
<tr>
<td align="left"><code> -u </code></td>
<td>显示进程的所属用户</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-20211120102817380.png" alt="image-20211120102817380"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）显示进程pid</span></span><br><span class="line">pstree -p</span><br><span class="line"></span><br><span class="line"><span class="comment">#（2）显示进程所属用户</span></span><br><span class="line">pstree -u</span><br></pre></td></tr></table></figure>



<hr>
<h3 id="7-4-netstat"><a href="#7-4-netstat" class="headerlink" title="7.4    netstat"></a>7.4    netstat</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">	netstat - Print network connections, routing tables, interface statistics, masquerade connections, and multicast memberships</span><br><span class="line">	<span class="comment"># 打印网络连接、路由表、接口统计、伪装连接和多播成员</span></span><br></pre></td></tr></table></figure>



<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>netstat -anp | grep 进程号</code>    （功能描述：查看该进程网络信息）</p>
<p><code>netstat -nlp | grep 端口号</code> （功能描述：查看网络端口号占用情况）</p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="center">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code> -n </code></td>
<td>拒绝显示别名，将能以数字显示的信息全部转化成数字</td>
</tr>
<tr>
<td align="center"><code> -l </code></td>
<td>仅列出有在listen（监听）的服务状态</td>
</tr>
<tr>
<td align="center"><code> -p </code></td>
<td>表示显示哪个进程在调用</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）通过进程号查看该进程的网络信息</span></span><br><span class="line">netstat -anp | grep 8080</span><br><span class="line"></span><br><span class="line"><span class="comment">#（2）查看某端口号是否被占用</span></span><br><span class="line">netstat -nlp | grep 8080</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="7-5-top-查看系统健康状态"><a href="#7-5-top-查看系统健康状态" class="headerlink" title="7.5    top 查看系统健康状态"></a>7.5    top 查看系统健康状态</h3><ol>
<li> <strong>基本命令</strong></li>
</ol>
<p><code>top [选项]</code></p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>-d 秒数</code></td>
<td align="left">指定 top 命令每隔几秒更新。默认是每 3 秒拉取最新的数据。</td>
</tr>
<tr>
<td align="left"><code>-i</code></td>
<td align="left">使 top 不显示任何闲置或者僵死进程</td>
</tr>
<tr>
<td align="left"><code>-p</code></td>
<td align="left">通过指定监控进程 ID 来仅仅监控某个进程的状态</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>操作说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th>操作</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>P</td>
<td>以CPU使用率排序，默认就是此项</td>
</tr>
<tr>
<td>M</td>
<td>以内存的使用率排序</td>
</tr>
<tr>
<td>N</td>
<td>以PID排序</td>
</tr>
<tr>
<td>q</td>
<td>退出top</td>
</tr>
</tbody></table>
<ol start="4">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@VM-0-17-centos ~]<span class="comment"># top -d 1</span></span><br><span class="line"></span><br><span class="line">[root@VM-0-17-centos ~]<span class="comment"># top -i</span></span><br><span class="line"></span><br><span class="line">[root@VM-0-17-centos ~]<span class="comment"># top -p 2575</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行上述命令后，可以按P、M、N对查询出的进程结果进行排序。</span></span><br></pre></td></tr></table></figure>



<ol start="5">
<li> <strong>查询结果字段解释</strong></li>
</ol>
<p>查询的结果分为上下两部分，上半部分展示的是当前线程的状态信息，下半部分是一个线程的集合。</p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-2021112010512066png" alt="image-20211120105120662"></p>
<p>在上半部分中：</p>
<p>（1）第一行信息为任务队列信息</p>
<table>
<thead>
<tr>
<th>内容</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>12:26:46</td>
<td>系统当前时间</td>
</tr>
<tr>
<td>up 1 day, 13:32</td>
<td>系统统的运行时间，本机已经运行1天  13小时32分钟</td>
</tr>
<tr>
<td>2 users</td>
<td>当前登录了两个用户</td>
</tr>
<tr>
<td>load   average: 0.00, 0.00, 0.00</td>
<td>系统在之前1分钟，5分钟，15分钟的平均负载。一般认为小于1时，负载较小。如果大于1，系统已经超出负荷。</td>
</tr>
</tbody></table>
<p>（2）第二行为进程信息</p>
<table>
<thead>
<tr>
<th>Tasks:   95 total</th>
<th>系统中的进程总数</th>
</tr>
</thead>
<tbody><tr>
<td>1 running</td>
<td>正在运行的进程数</td>
</tr>
<tr>
<td>94 sleeping</td>
<td>睡眠的进程</td>
</tr>
<tr>
<td>0 stopped</td>
<td>正在停止的进程</td>
</tr>
<tr>
<td>0 zombie</td>
<td>僵尸进程。如果不是0，需要手工检查僵尸进程</td>
</tr>
</tbody></table>
<p>（3）第三行为CPU信息</p>
<table>
<thead>
<tr>
<th>Cpu(s):   0.1%us</th>
<th>用户模式占用的CPU百分比</th>
</tr>
</thead>
<tbody><tr>
<td>0.1%sy</td>
<td>系统模式占用的CPU百分比</td>
</tr>
<tr>
<td>0.0%ni</td>
<td>改变过优先级的用户进程占用的CPU百分比</td>
</tr>
<tr>
<td>99.7%id</td>
<td>空闲CPU的CPU百分比</td>
</tr>
<tr>
<td>0.1%wa</td>
<td>等待输入/输出的进程的占用CPU百分比</td>
</tr>
<tr>
<td>0.0%hi</td>
<td>硬中断请求服务占用的CPU百分比</td>
</tr>
<tr>
<td>0.1%si</td>
<td>软中断请求服务占用的CPU百分比</td>
</tr>
<tr>
<td>0.0%st</td>
<td>st（Steal time）虚拟时间百分比。就是当有虚拟机时，虚拟CPU等待实际CPU的时间百分比。</td>
</tr>
</tbody></table>
<p>（4）第四行为物理内存信息</p>
<table>
<thead>
<tr>
<th>Mem:    625344k total</th>
<th>物理内存的总量，单位KB</th>
</tr>
</thead>
<tbody><tr>
<td>571504k used</td>
<td>已经使用的物理内存数量</td>
</tr>
<tr>
<td>53840k free</td>
<td>空闲的物理内存数量，我们使用的是虚拟机，总共只分配了628MB内存，所以只有53MB的空闲内存了</td>
</tr>
<tr>
<td>65800k buffers</td>
<td>作为缓冲的内存数量</td>
</tr>
</tbody></table>
<p>（5）第五行为交换分区（swap）信息</p>
<table>
<thead>
<tr>
<th>Swap:   524280k total</th>
<th>交换分区（虚拟内存）的总大小</th>
</tr>
</thead>
<tbody><tr>
<td>0k used</td>
<td>已经使用的交互分区的大小</td>
</tr>
<tr>
<td>524280k free</td>
<td>空闲交换分区的大小</td>
</tr>
<tr>
<td>409280k cached</td>
<td>作为缓存的交互分区的大小</td>
</tr>
</tbody></table>
<hr>
<h2 id="8-文件权限类"><a href="#8-文件权限类" class="headerlink" title="8    文件权限类"></a>8    文件权限类</h2><h3 id="8-1-RBAC-权限模型"><a href="#8-1-RBAC-权限模型" class="headerlink" title="8.1    RBAC 权限模型"></a>8.1    RBAC 权限模型</h3><p>RBAC（Role based Authentication Control）模型：基于角色的权限控制。</p>
<ul>
<li>  <strong>资源</strong>：权限控制系统要保护的对象，在 Linux 中就是文件和目录；</li>
<li>  <strong>权限</strong>：对资源的操作，包括读和写；</li>
<li>  <strong>角色</strong>：对用户的分组。将同一类的用户划分到同一个用户组中，让他们具备相同的权限。</li>
<li>  <strong>用户</strong>：登录系统时使用的账号</li>
</ul>
<p>Linux 需要对登录用户读写执行文件、进入目录、查看增删目录内容等操作进行控制，不能任由用户随意执行所有操作。</p>
<p><strong>Linux 的权限控制基于 RBAC 模型。</strong>也就是说不同登录用户在 Linux 中能执行的权限是不同的。</p>
<p><strong>Linux 是一种典型的多用户系统</strong>，不同的用户处于不同的地位，拥有不同的权限。</p>
<p><strong>总结</strong>：简而言之，就是根据用户的角色判断用户是否具备操作某个资源的权限。</p>
<h3 id="8-2-文件属性"><a href="#8-2-文件属性" class="headerlink" title="8.2    文件属性"></a>8.2    文件属性</h3><p>Linux 是一种典型的多用户系统，不同的用户处于不同的地位，拥有不同的权限。为了保护系统的安全性，Linux 系统对不同的用户访问同一文件（包括目录文件）的权限做了不同的规定。在 Linux 中我们可以使用 <code>ll</code> 或者 <code>ls -l</code> 命令来显示一个文件的属性以及文件所属的用户和组。</p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-20211120111715134.png" alt="image-20211120111715134"></p>
<h4 id="8-2-1-权限信息"><a href="#8-2-1-权限信息" class="headerlink" title="8.2.1    权限信息"></a>8.2.1    权限信息</h4><p><strong>格式</strong>：从左到右的 10 个字符表示，分为 4 部分：<code>- --- --- ---</code></p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-20210205125556064.png" alt="image-20210205125556064"></p>
<ol>
<li><p><strong>Part1</strong>：首位表示文件类型</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-	表示文件 </span><br><span class="line">d	表示目录</span><br><span class="line">l	表示链接（快捷方式）</span><br></pre></td></tr></table></figure></li>
<li><p><strong>Part2</strong>：属主权限【User】</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">r	<span class="built_in">read</span>，读权限，[4]</span><br><span class="line">w	write，写权限，[2]</span><br><span class="line">e	excute，执行权限，[1]</span><br><span class="line">-	无操作权限</span><br></pre></td></tr></table></figure></li>
<li><p> <strong>Part3</strong>：属组权限【Group】</p>
</li>
<li><p><strong>Part4</strong>：其它用户权限【Other】</p>
</li>
</ol>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/wps1.jpg" alt="img"></p>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="left">文件</th>
<th align="left">目录</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>r</strong></td>
<td align="left">对文件是指可读取文件内容</td>
<td align="left">对目录是可以读取，ls查看目录内容</td>
</tr>
<tr>
<td align="center"><strong>w</strong></td>
<td align="left">对文件是指可修改文件内容。但是不代表可以删除<br>该文件，删除一个文件的前提条件是对该文件所在<br>的目录有写权限，才能删除该文件</td>
<td align="left">对目录是指可以在其中创建或删除子节点(目录或文件)</td>
</tr>
<tr>
<td align="center"><strong>x</strong></td>
<td align="left">对文件是指是否可以运行这个文件</td>
<td align="left">对目录是指可以cd进入这个目录</td>
</tr>
</tbody></table>
<p><strong>Demo</strong></p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-20210205130709766.png" alt="image-20210205130709766"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）对于文件：链接数指的是硬链接个数。</span></span><br><span class="line"><span class="comment">#（2）对于文件夹：链接数指的是子文件夹个数。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建硬链接方法</span></span><br><span class="line"><span class="built_in">ln</span> [原文件] [目标文件]  </span><br></pre></td></tr></table></figure>



<hr>
<h4 id="8-2-2-Linux-的三种文件类型"><a href="#8-2-2-Linux-的三种文件类型" class="headerlink" title="8.2.2    Linux 的三种文件类型"></a>8.2.2    Linux 的三种文件类型</h4><ul>
<li>普通文件： 包括文本文件、数据文件、可执行的二进制程序文件等。 </li>
<li>目录文件： Linux系统把目录看成是一种特殊的文件，利用它构成文件系统的树型结构。 </li>
<li>设备文件： Linux系统把每一个设备都看成是一个文件</li>
</ul>
<hr>
<h3 id="8-3-chmod-设置文件的权限"><a href="#8-3-chmod-设置文件的权限" class="headerlink" title="8.3    chmod 设置文件的权限"></a>8.3    chmod 设置文件的权限</h3><p><strong>基本语法</strong></p>
<p><img src="/2021/11/20/Linux%E2%80%94%E2%80%94%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/image-20210205132217517.png" alt="image-20210205132217517"></p>
<ul>
<li>  Case1：<code>chmod [&#123;u/g/o/a&#125;&#123;+/-/=&#125;&#123;r/w/x&#125;] 文件或目录</code></li>
<li>  Case2：<code>chmod [mode=421] [文件或目录]</code></li>
</ul>
<p><strong>说明：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">u：属主 	</span><br><span class="line">g：属组 	</span><br><span class="line">o：其它 	</span><br><span class="line">a：所有人(u、g、o的总和)</span><br><span class="line"></span><br><span class="line">r=4	</span><br><span class="line">w=2	</span><br><span class="line">x=1    </span><br><span class="line">rwx=4+2+1=7</span><br></pre></td></tr></table></figure>



<p><strong>Demo</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）修改文件使其所属主用户具有执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> u+x houge.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#（2）修改文件使其所属组用户具有执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> g+x houge.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#（3）取消文件所属主用户执行权限,并使其他用户具有执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> u-x,o+x houge.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#（4）设置对a.txt操作权限为：当前用户rwx，组内用户rx，其他组用户rx</span></span><br><span class="line"><span class="built_in">chmod</span> u=rwx,g=rx,o=rx a.txt		</span><br><span class="line"></span><br><span class="line"><span class="comment">#（5）采用数字的方式，设置文件所有者、所属组、其他用户都具有可读可写可执行权限。</span></span><br><span class="line"><span class="built_in">chmod</span> 777 houge.txt</span><br><span class="line"></span><br><span class="line"><span class="comment">#（6）修改整个文件夹里面的所有文件的所有者、所属组、其他用户都具有可读可写可执行权限。</span></span><br><span class="line"><span class="built_in">chmod</span> -R 777 xiyou/</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="8-4-chown-改变文件的属主和属组"><a href="#8-4-chown-改变文件的属主和属组" class="headerlink" title="8.4    chown    改变文件的属主和属组"></a>8.4    chown    改变文件的属主和属组</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">       <span class="built_in">chown</span> - change file owner and group</span><br><span class="line">       <span class="comment"># 改变文件的属主和属组</span></span><br></pre></td></tr></table></figure>



<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>chown [选项] [最终用户] [文件或目录]</code>      （功能描述：改变文件的属主和属组）</p>
<ol start="2">
<li> <strong>选项说明</strong></li>
</ol>
<table>
<thead>
<tr>
<th align="left">选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code> -R </code></td>
<td>递归操作</td>
</tr>
</tbody></table>
<ol start="3">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）修改文件所有者</span></span><br><span class="line"><span class="built_in">chown</span> zhangsan houge.txt </span><br><span class="line"></span><br><span class="line"><span class="comment">#（2）递归改变文件所有者和所有组</span></span><br><span class="line"><span class="built_in">chown</span> -R person:lisi tempfile/</span><br></pre></td></tr></table></figure>





<hr>
<h3 id="8-5-chgrp-改变文件属组"><a href="#8-5-chgrp-改变文件属组" class="headerlink" title="8.5    chgrp    改变文件属组"></a>8.5    chgrp    改变文件属组</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME</span><br><span class="line">       <span class="built_in">chgrp</span> - change group ownership</span><br><span class="line">       <span class="comment"># 改变文件属组</span></span><br></pre></td></tr></table></figure>



<ol>
<li> <strong>基本语法</strong></li>
</ol>
<p><code>chgrp [最终用户组] [文件或目录]</code>   （功能描述：改变文件或者目录的所属组）</p>
<ol start="2">
<li> <strong>Demo</strong></li>
</ol>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#（1）修改文件的所属组</span></span><br><span class="line"><span class="built_in">chgrp</span> root houge.txt</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/16/HBase/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/16/HBase/" class="post-title-link" itemprop="url">HBase</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-16 20:45:43" itemprop="dateCreated datePublished" datetime="2021-11-16T20:45:43+08:00">2021-11-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-12-13 15:56:11" itemprop="dateModified" datetime="2021-12-13T15:56:11+08:00">2021-12-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9D%97/" itemprop="url" rel="index"><span itemprop="name">大数据模块</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>HBase上所有的数据都存在HDFS上</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/11/16/SpringSecurity%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Hexo">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/16/SpringSecurity%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">SpringSecurity自定义异常处理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-11-16 13:41:28 / Modified: 16:41:39" itemprop="dateCreated datePublished" datetime="2021-11-16T13:41:28+08:00">2021-11-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/SpringSecurity/" itemprop="url" rel="index"><span itemprop="name">SpringSecurity</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="1-SpringSecurity-中的异常"><a href="#1-SpringSecurity-中的异常" class="headerlink" title="1.    SpringSecurity 中的异常"></a>1.    SpringSecurity 中的异常</h1><p>SpringSecurity 中的异常主要分为两大类：</p>
<ul>
<li>  一类是<strong>认证异常</strong>，</li>
<li>  另一类是<strong>授权相关的异常</strong>。</li>
</ul>
<h2 id="1-1-AuthenticationException"><a href="#1-1-AuthenticationException" class="headerlink" title="1.1    AuthenticationException"></a>1.1    AuthenticationException</h2><p><code>AuthenticationException</code> 是在用户认证的时候出现错误时抛出的异常。主要的子类如图：</p>
<p><img src="/2021/11/16/SpringSecurity%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/20191107000837154.png" alt="AuthenticationException.png"></p>
<p>如上图所示，系统用户不存在，被锁定，凭证失效，密码错误等认证过程中出现的异常都由 <code>AuthenticationException</code> 处理。</p>
<h2 id="1-2-AccessDeniedException"><a href="#1-2-AccessDeniedException" class="headerlink" title="1.2    AccessDeniedException"></a>1.2    AccessDeniedException</h2><p><code>AccessDeniedException</code> 主要是指用户在访问受保护资源时被拒绝而抛出的异常。与 <code>AuthenticationException</code> 一样它也提供了一些具体的子类。如下图：</p>
<p><img src="/2021/11/16/SpringSecurity%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/20191107000837430.png" alt="AccessDeniedException.png"></p>
<p><code>AccessDeniedException</code> 的子类比较少，主要是 <code>CSRF</code> 相关的异常和授权服务异常。</p>
<hr>
<h1 id="2-HTTP-状态对认证授权的规定"><a href="#2-HTTP-状态对认证授权的规定" class="headerlink" title="2. HTTP 状态对认证授权的规定"></a>2. HTTP 状态对认证授权的规定</h1><p>HTTP 协议对认证授权的响应结果也有规定。</p>
<h2 id="2-1-401-未授权状态"><a href="#2-1-401-未授权状态" class="headerlink" title="2.1    401 未授权状态"></a>2.1    401 未授权状态</h2><ul>
<li>  <strong>HTTP 401 错误 - 未授权(Unauthorized)</strong></li>
</ul>
<p>一般来说该错误消息表明您首先需要登录（输入有效的用户名和密码）。 如果你刚刚输入这些信息，立刻就看到一个 <code>401</code> 错误，就意味着，无论出于何种原因您的用户名和密码其中之一或两者都无效（输入有误，用户名暂时停用，账户被锁定，凭证失效等）。总之就是认证失败了。其实正好对应我们上面的 <code>AuthenticationException</code> 。</p>
<h2 id="2-2-403-被拒绝状态"><a href="#2-2-403-被拒绝状态" class="headerlink" title="2.2    403 被拒绝状态"></a>2.2    403 被拒绝状态</h2><ul>
<li>  <strong>HTTP 403 错误 - 被禁止(Forbidden)</strong></li>
</ul>
<p>出现该错误表明您在访问受限资源时没有得到许可。服务器理解了本次请求但是拒绝执行该任务，该请求不该重发给服务器。并且服务器想让客户端知道为什么没有权限访问特定的资源，服务器应该在返回的信息中描述拒绝的理由。一般实践中我们会比较模糊的表明原因。 该错误对应了我们上面的 <code>AccessDeniedException</code> 。</p>
<hr>
<h1 id="3-Spring-Security-中的异常处理"><a href="#3-Spring-Security-中的异常处理" class="headerlink" title="3.    Spring Security 中的异常处理"></a>3.    Spring Security 中的异常处理</h1><p>在 <strong>Spring Security</strong> 中，通过：</p>
<ul>
<li>  <strong>AuthenticationEntryPoint</strong> 该类用来统一处理 <code>AuthenticationException</code> 异常</li>
<li>  <strong>AccessDeniedHandler</strong> 该类用来统一处理 <code>AccessDeniedException</code> 异常</li>
</ul>
<p>我们只要<strong>①实现</strong>并<strong>②配置</strong>这两个异常处理类即可实现对 <strong>SpringSecurity</strong> 认证授权相关的异常进行统一的自定义处理。</p>
<p>SpringSecurity 的默认只兼容单机版本（即前后端不分离），默认情况下出现异常后会跳转到一个异常页面。但是在前后端分离的项目中，当出现异常后应该将异常信息以 <code>json</code> 数据的格式响应给前端，所以我们需要：①自定义异常处理类，②并将自定义的异常处理类设置到 SpringSecurity 中去覆盖 SpringSecurity 默认的异常处理类。</p>
<hr>
<h2 id="3-1-实现-AuthenticationEntryPoint"><a href="#3-1-实现-AuthenticationEntryPoint" class="headerlink" title="3.1    实现 AuthenticationEntryPoint"></a>3.1    实现 AuthenticationEntryPoint</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.core.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.AuthenticationEntryPoint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleAuthenticationEntryPoint</span> <span class="keyword">implements</span> <span class="title class_">AuthenticationEntryPoint</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">commence</span><span class="params">(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//todo your business</span></span><br><span class="line">        HashMap&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">2</span>);</span><br><span class="line">        map.put(<span class="string">&quot;uri&quot;</span>, request.getRequestURI());</span><br><span class="line">        map.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;认证失败&quot;</span>);</span><br><span class="line">        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        response.setContentType(MediaType.APPLICATION_JSON_VALUE);</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">resBody</span> <span class="operator">=</span> objectMapper.writeValueAsString(map);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">printWriter</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">        printWriter.print(resBody);</span><br><span class="line">        printWriter.flush();</span><br><span class="line">        printWriter.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-实现-AccessDeniedHandler"><a href="#3-2-实现-AccessDeniedHandler" class="headerlink" title="3.2    实现 AccessDeniedHandler"></a>3.2    实现 AccessDeniedHandler</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.access.AccessDeniedException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.access.AccessDeniedHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleAccessDeniedHandler</span> <span class="keyword">implements</span> <span class="title class_">AccessDeniedHandler</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, AccessDeniedException accessDeniedException)</span> <span class="keyword">throws</span> IOException, ServletException &#123;</span><br><span class="line">        <span class="comment">//todo your business</span></span><br><span class="line">        HashMap&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">2</span>);</span><br><span class="line">        map.put(<span class="string">&quot;uri&quot;</span>, request.getRequestURI());</span><br><span class="line">        map.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;认证失败&quot;</span>);</span><br><span class="line">        response.setStatus(HttpServletResponse.SC_FORBIDDEN);</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        response.setContentType(MediaType.APPLICATION_JSON_VALUE);</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">resBody</span> <span class="operator">=</span> objectMapper.writeValueAsString(map);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">printWriter</span> <span class="operator">=</span> response.getWriter();</span><br><span class="line">        printWriter.print(resBody);</span><br><span class="line">        printWriter.flush();</span><br><span class="line">        printWriter.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<hr>
<h2 id="3-3-配置"><a href="#3-3-配置" class="headerlink" title="3.3    配置"></a>3.3    配置</h2><p>实现了上述两个接口后，我们只需要在 <code>WebSecurityConfigurerAdapter</code> 的 <code>configure(HttpSecurity http)</code> 方法中配置这两个自定义异常类对象即可。相关的配置片段如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http.exceptionHandling()</span><br><span class="line">    .accessDeniedHandler(<span class="keyword">new</span> <span class="title class_">SimpleAccessDeniedHandler</span>())	<span class="comment">// 配置权限不足的异常处理器</span></span><br><span class="line">    .authenticationEntryPoint(<span class="keyword">new</span> <span class="title class_">SimpleAuthenticationEntryPoint</span>())	<span class="comment">// 配置认证失败的异常处理器</span></span><br></pre></td></tr></table></figure>





<hr>
<h1 id="4-实战"><a href="#4-实战" class="headerlink" title="4.    实战"></a>4.    实战</h1><h2 id="1、自定义的异常处理器与全局异常处理器的冲突"><a href="#1、自定义的异常处理器与全局异常处理器的冲突" class="headerlink" title="1、自定义的异常处理器与全局异常处理器的冲突"></a>1、自定义的异常处理器与全局异常处理器的冲突</h2><p>一般在我们的项目中，我们都会配置一个全局异常处理类，这个类可以拦截系统抛出的所有异常。我们来看一下我们当前项目中的全局异常处理类。</p>
<blockquote>
<p>  <strong>全局异常处理类</strong></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.xsyu.cq.common.cxception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.xsyu.cq.common.result.Result;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.ResponseEntity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span> lnd</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span> 2021/11/4 22:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Version</span> 1.0</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 全局异常处理器</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonExceptionHandler</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ExceptionHandler(&#123;Exception.class&#125;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Result.fail(e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(CQException.class)</span>    <span class="comment">// 该注解的作用是拦截指定类型的异常</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(CQException e)</span>&#123;</span><br><span class="line">        <span class="comment">// 拦截所有抛出的CQException异常，并在运行期对其进行增强</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">code</span> <span class="operator">=</span> e.getCode();</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> e.getMessage();</span><br><span class="line">        <span class="keyword">return</span> Result.build(code, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，在这个全局异常拦截器中，有一个方法 <code>error</code> 拦截的异常类型是 <strong>Exception.class</strong>，也就是说该过滤器会拦截项目中抛出的所有异常。所以如果我们在全局异常处理器中拦截了所有 Exception 类型的异常，那么我们在上一章节配置的自定义异常处理器就会失效，因为系统抛出的异常被全局异常处理器“截胡”了。针对这种情况，我们主要有两种解决方案：</p>
<ul>
<li>  <strong>方案一：</strong></li>
</ul>
<p>注释掉拦截 <strong>Exception</strong> 类型异常的的异常处理器。</p>
<ul>
<li>  <strong>方案二：</strong></li>
</ul>
<p>在该异常处理器中声明具体的针对 <code>AuthenticationException</code> 和 <code>AccessDeniedException</code> 异常的异常处理方法，这两个异常处理方法的优先级会更高。即把上一章节处理异常的方法转移到全局异常处理器中。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/9/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
